/*!
 * w-hc-2-png v1.0.22
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("fs"),require("path"),require("puppeteer")):"function"==typeof define&&define.amd?define(["fs","path","puppeteer"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-hc-2-png"]=e(t.fs,t.path,t.puppeteer)}(this,(function(t,e,r){"use strict";var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function i(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var o=Array.isArray,a="object"==typeof n&&n&&n.Object===Object&&n,u=a,c="object"==typeof self&&self&&self.Object===Object&&self,s=u||c||Function("return this")(),f=s.Symbol,l=f,h=Object.prototype,p=h.hasOwnProperty,v=h.toString,d=l?l.toStringTag:void 0;var y=function(t){var e=p.call(t,d),r=t[d];try{t[d]=void 0;var n=!0}catch(t){}var i=v.call(t);return n&&(e?t[d]=r:delete t[d]),i},b=Object.prototype.toString;var g=y,_=function(t){return b.call(t)},j=f?f.toStringTag:void 0;var m=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":j&&j in Object(t)?g(t):_(t)};var w=function(t){return null!=t&&"object"==typeof t},$=m,O=w;var S=function(t){return"symbol"==typeof t||O(t)&&"[object Symbol]"==$(t)},M=o,D=S,x=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,A=/^\w*$/;var k=function(t,e){if(M(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!D(t))||(A.test(t)||!x.test(t)||null!=e&&t in Object(e))};var z=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},F=m,P=z;var T,N=function(t){if(!P(t))return!1;var e=F(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},Y=s["__core-js_shared__"],C=(T=/[^.]+$/.exec(Y&&Y.keys&&Y.keys.IE_PROTO||""))?"Symbol(src)_1."+T:"";var E=function(t){return!!C&&C in t},H=Function.prototype.toString;var I=function(t){if(null!=t){try{return H.call(t)}catch(t){}try{return t+""}catch(t){}}return""},L=N,U=E,W=z,B=I,V=/^\[object .+?Constructor\]$/,q=Function.prototype,J=Object.prototype,R=q.toString,Z=J.hasOwnProperty,G=RegExp("^"+R.call(Z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var Q=function(t){return!(!W(t)||U(t))&&(L(t)?G:V).test(B(t))},K=function(t,e){return null==t?void 0:t[e]};var X=function(t,e){var r=K(t,e);return Q(r)?r:void 0},tt=X(Object,"create"),et=tt;var rt=function(){this.__data__=et?et(null):{},this.size=0};var nt=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},it=tt,ot=Object.prototype.hasOwnProperty;var at=function(t){var e=this.__data__;if(it){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return ot.call(e,t)?e[t]:void 0},ut=tt,ct=Object.prototype.hasOwnProperty;var st=tt;var ft=rt,lt=nt,ht=at,pt=function(t){var e=this.__data__;return ut?void 0!==e[t]:ct.call(e,t)},vt=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=st&&void 0===e?"__lodash_hash_undefined__":e,this};function dt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}dt.prototype.clear=ft,dt.prototype.delete=lt,dt.prototype.get=ht,dt.prototype.has=pt,dt.prototype.set=vt;var yt=dt;var bt=function(){this.__data__=[],this.size=0};var gt=function(t,e){return t===e||t!=t&&e!=e},_t=gt;var jt=function(t,e){for(var r=t.length;r--;)if(_t(t[r][0],e))return r;return-1},mt=jt,wt=Array.prototype.splice;var $t=jt;var Ot=jt;var St=jt;var Mt=bt,Dt=function(t){var e=this.__data__,r=mt(e,t);return!(r<0)&&(r==e.length-1?e.pop():wt.call(e,r,1),--this.size,!0)},xt=function(t){var e=this.__data__,r=$t(e,t);return r<0?void 0:e[r][1]},At=function(t){return Ot(this.__data__,t)>-1},kt=function(t,e){var r=this.__data__,n=St(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};function zt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}zt.prototype.clear=Mt,zt.prototype.delete=Dt,zt.prototype.get=xt,zt.prototype.has=At,zt.prototype.set=kt;var Ft=zt,Pt=X(s,"Map"),Tt=yt,Nt=Ft,Yt=Pt;var Ct=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var Et=function(t,e){var r=t.__data__;return Ct(e)?r["string"==typeof e?"string":"hash"]:r.map},Ht=Et;var It=Et;var Lt=Et;var Ut=Et;var Wt=function(){this.size=0,this.__data__={hash:new Tt,map:new(Yt||Nt),string:new Tt}},Bt=function(t){var e=Ht(this,t).delete(t);return this.size-=e?1:0,e},Vt=function(t){return It(this,t).get(t)},qt=function(t){return Lt(this,t).has(t)},Jt=function(t,e){var r=Ut(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};function Rt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Rt.prototype.clear=Wt,Rt.prototype.delete=Bt,Rt.prototype.get=Vt,Rt.prototype.has=qt,Rt.prototype.set=Jt;var Zt=Rt,Gt=Zt;function Qt(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var a=t.apply(this,n);return r.cache=o.set(i,a)||o,a};return r.cache=new(Qt.Cache||Gt),r}Qt.Cache=Gt;var Kt=Qt;var Xt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,te=/\\(\\)?/g,ee=function(t){var e=Kt(t,(function(t){return 500===r.size&&r.clear(),t})),r=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Xt,(function(t,r,n,i){e.push(n?i.replace(te,"$1"):r||t)})),e}));var re=function(t,e){for(var r=-1,n=null==t?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i},ne=o,ie=S,oe=f?f.prototype:void 0,ae=oe?oe.toString:void 0;var ue=function t(e){if("string"==typeof e)return e;if(ne(e))return re(e,t)+"";if(ie(e))return ae?ae.call(e):"";var r=e+"";return"0"==r&&1/e==-Infinity?"-0":r},ce=ue;var se=function(t){return null==t?"":ce(t)},fe=o,le=k,he=ee,pe=se;var ve=function(t,e){return fe(t)?t:le(t,e)?[t]:he(pe(t))},de=S;var ye=function(t){if("string"==typeof t||de(t))return t;var e=t+"";return"0"==e&&1/t==-Infinity?"-0":e},be=ve,ge=ye;var _e=function(t,e){for(var r=0,n=(e=be(e,t)).length;null!=t&&r<n;)t=t[ge(e[r++])];return r&&r==n?t:void 0},je=_e;var me=function(t,e,r){var n=null==t?void 0:je(t,e);return void 0===n?r:n},we={},$e={get exports(){return we},set exports(t){we=t}};var Oe=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t};var Se=function(t){return function(e,r,n){for(var i=-1,o=Object(e),a=n(e),u=a.length;u--;){var c=a[t?u:++i];if(!1===r(o[c],c,o))break}return e}}();var Me=function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n},De=m,xe=w;var Ae=function(t){return xe(t)&&"[object Arguments]"==De(t)},ke=w,ze=Object.prototype,Fe=ze.hasOwnProperty,Pe=ze.propertyIsEnumerable,Te=Ae(function(){return arguments}())?Ae:function(t){return ke(t)&&Fe.call(t,"callee")&&!Pe.call(t,"callee")},Ne=Te,Ye={};var Ce=function(){return!1};!function(t,e){var r=s,n=Ce,i=e&&!e.nodeType&&e,o=i&&t&&!t.nodeType&&t,a=o&&o.exports===i?r.Buffer:void 0,u=(a?a.isBuffer:void 0)||n;t.exports=u}({get exports(){return Ye},set exports(t){Ye=t}},Ye);var Ee=/^(?:0|[1-9]\d*)$/;var He=function(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&Ee.test(t))&&t>-1&&t%1==0&&t<e};var Ie=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},Le=m,Ue=Ie,We=w,Be={};Be["[object Float32Array]"]=Be["[object Float64Array]"]=Be["[object Int8Array]"]=Be["[object Int16Array]"]=Be["[object Int32Array]"]=Be["[object Uint8Array]"]=Be["[object Uint8ClampedArray]"]=Be["[object Uint16Array]"]=Be["[object Uint32Array]"]=!0,Be["[object Arguments]"]=Be["[object Array]"]=Be["[object ArrayBuffer]"]=Be["[object Boolean]"]=Be["[object DataView]"]=Be["[object Date]"]=Be["[object Error]"]=Be["[object Function]"]=Be["[object Map]"]=Be["[object Number]"]=Be["[object Object]"]=Be["[object RegExp]"]=Be["[object Set]"]=Be["[object String]"]=Be["[object WeakMap]"]=!1;var Ve=function(t){return We(t)&&Ue(t.length)&&!!Be[Le(t)]};var qe=function(t){return function(e){return t(e)}},Je={};!function(t,e){var r=a,n=e&&!e.nodeType&&e,i=n&&t&&!t.nodeType&&t,o=i&&i.exports===n&&r.process,u=function(){try{var t=i&&i.require&&i.require("util").types;return t||o&&o.binding&&o.binding("util")}catch(t){}}();t.exports=u}({get exports(){return Je},set exports(t){Je=t}},Je);var Re=Ve,Ze=qe,Ge=Je&&Je.isTypedArray,Qe=Ge?Ze(Ge):Re,Ke=Me,Xe=Ne,tr=o,er=Ye,rr=He,nr=Qe,ir=Object.prototype.hasOwnProperty;var or=function(t,e){var r=tr(t),n=!r&&Xe(t),i=!r&&!n&&er(t),o=!r&&!n&&!i&&nr(t),a=r||n||i||o,u=a?Ke(t.length,String):[],c=u.length;for(var s in t)!e&&!ir.call(t,s)||a&&("length"==s||i&&("offset"==s||"parent"==s)||o&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||rr(s,c))||u.push(s);return u},ar=Object.prototype;var ur=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||ar)};var cr=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object),sr=ur,fr=cr,lr=Object.prototype.hasOwnProperty;var hr=N,pr=Ie;var vr=function(t){return null!=t&&pr(t.length)&&!hr(t)},dr=or,yr=function(t){if(!sr(t))return fr(t);var e=[];for(var r in Object(t))lr.call(t,r)&&"constructor"!=r&&e.push(r);return e},br=vr;var gr=function(t){return br(t)?dr(t):yr(t)},_r=Se,jr=gr;var mr=vr;var wr=function(t,e){return function(r,n){if(null==r)return r;if(!mr(r))return t(r,n);for(var i=r.length,o=e?i:-1,a=Object(r);(e?o--:++o<i)&&!1!==n(a[o],o,a););return r}}((function(t,e){return t&&_r(t,e,jr)}));var $r=function(t){return t},Or=$r;var Sr=Oe,Mr=wr,Dr=function(t){return"function"==typeof t?t:Or},xr=o;var Ar=function(t,e){return(xr(t)?Sr:Mr)(t,Dr(e))};!function(t){t.exports=Ar}($e);var kr=i(we),zr=Ft;var Fr=Ft,Pr=Pt,Tr=Zt;var Nr=Ft,Yr=function(){this.__data__=new zr,this.size=0},Cr=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},Er=function(t){return this.__data__.get(t)},Hr=function(t){return this.__data__.has(t)},Ir=function(t,e){var r=this.__data__;if(r instanceof Fr){var n=r.__data__;if(!Pr||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Tr(n)}return r.set(t,e),this.size=r.size,this};function Lr(t){var e=this.__data__=new Nr(t);this.size=e.size}Lr.prototype.clear=Yr,Lr.prototype.delete=Cr,Lr.prototype.get=Er,Lr.prototype.has=Hr,Lr.prototype.set=Ir;var Ur=Lr;var Wr=Zt,Br=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Vr=function(t){return this.__data__.has(t)};function qr(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new Wr;++e<r;)this.add(t[e])}qr.prototype.add=qr.prototype.push=Br,qr.prototype.has=Vr;var Jr=qr,Rr=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1},Zr=function(t,e){return t.has(e)};var Gr=function(t,e,r,n,i,o){var a=1&r,u=t.length,c=e.length;if(u!=c&&!(a&&c>u))return!1;var s=o.get(t),f=o.get(e);if(s&&f)return s==e&&f==t;var l=-1,h=!0,p=2&r?new Jr:void 0;for(o.set(t,e),o.set(e,t);++l<u;){var v=t[l],d=e[l];if(n)var y=a?n(d,v,l,e,t,o):n(v,d,l,t,e,o);if(void 0!==y){if(y)continue;h=!1;break}if(p){if(!Rr(e,(function(t,e){if(!Zr(p,e)&&(v===t||i(v,t,r,n,o)))return p.push(e)}))){h=!1;break}}else if(v!==d&&!i(v,d,r,n,o)){h=!1;break}}return o.delete(t),o.delete(e),h};var Qr=s.Uint8Array,Kr=gt,Xr=Gr,tn=function(t){var e=-1,r=Array(t.size);return t.forEach((function(t,n){r[++e]=[n,t]})),r},en=function(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r},rn=f?f.prototype:void 0,nn=rn?rn.valueOf:void 0;var on=function(t,e,r,n,i,o,a){switch(r){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!o(new Qr(t),new Qr(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Kr(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var u=tn;case"[object Set]":var c=1&n;if(u||(u=en),t.size!=e.size&&!c)return!1;var s=a.get(t);if(s)return s==e;n|=2,a.set(t,e);var f=Xr(u(t),u(e),n,i,o,a);return a.delete(t),f;case"[object Symbol]":if(nn)return nn.call(t)==nn.call(e)}return!1};var an=function(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t},un=o;var cn=function(t,e,r){var n=e(t);return un(t)?n:an(n,r(t))};var sn=function(t,e){for(var r=-1,n=null==t?0:t.length,i=0,o=[];++r<n;){var a=t[r];e(a,r,t)&&(o[i++]=a)}return o},fn=function(){return[]},ln=Object.prototype.propertyIsEnumerable,hn=Object.getOwnPropertySymbols,pn=cn,vn=hn?function(t){return null==t?[]:(t=Object(t),sn(hn(t),(function(e){return ln.call(t,e)})))}:fn,dn=gr;var yn=function(t){return pn(t,dn,vn)},bn=Object.prototype.hasOwnProperty;var gn=function(t,e,r,n,i,o){var a=1&r,u=yn(t),c=u.length;if(c!=yn(e).length&&!a)return!1;for(var s=c;s--;){var f=u[s];if(!(a?f in e:bn.call(e,f)))return!1}var l=o.get(t),h=o.get(e);if(l&&h)return l==e&&h==t;var p=!0;o.set(t,e),o.set(e,t);for(var v=a;++s<c;){var d=t[f=u[s]],y=e[f];if(n)var b=a?n(y,d,f,e,t,o):n(d,y,f,t,e,o);if(!(void 0===b?d===y||i(d,y,r,n,o):b)){p=!1;break}v||(v="constructor"==f)}if(p&&!v){var g=t.constructor,_=e.constructor;g==_||!("constructor"in t)||!("constructor"in e)||"function"==typeof g&&g instanceof g&&"function"==typeof _&&_ instanceof _||(p=!1)}return o.delete(t),o.delete(e),p},_n=X(s,"DataView"),jn=Pt,mn=X(s,"Promise"),wn=X(s,"Set"),$n=X(s,"WeakMap"),On=m,Sn=I,Mn="[object Map]",Dn="[object Promise]",xn="[object Set]",An="[object WeakMap]",kn="[object DataView]",zn=Sn(_n),Fn=Sn(jn),Pn=Sn(mn),Tn=Sn(wn),Nn=Sn($n),Yn=On;(_n&&Yn(new _n(new ArrayBuffer(1)))!=kn||jn&&Yn(new jn)!=Mn||mn&&Yn(mn.resolve())!=Dn||wn&&Yn(new wn)!=xn||$n&&Yn(new $n)!=An)&&(Yn=function(t){var e=On(t),r="[object Object]"==e?t.constructor:void 0,n=r?Sn(r):"";if(n)switch(n){case zn:return kn;case Fn:return Mn;case Pn:return Dn;case Tn:return xn;case Nn:return An}return e});var Cn=Ur,En=Gr,Hn=on,In=gn,Ln=Yn,Un=o,Wn=Ye,Bn=Qe,Vn="[object Arguments]",qn="[object Array]",Jn="[object Object]",Rn=Object.prototype.hasOwnProperty;var Zn=function(t,e,r,n,i,o){var a=Un(t),u=Un(e),c=a?qn:Ln(t),s=u?qn:Ln(e),f=(c=c==Vn?Jn:c)==Jn,l=(s=s==Vn?Jn:s)==Jn,h=c==s;if(h&&Wn(t)){if(!Wn(e))return!1;a=!0,f=!1}if(h&&!f)return o||(o=new Cn),a||Bn(t)?En(t,e,r,n,i,o):Hn(t,e,c,r,n,i,o);if(!(1&r)){var p=f&&Rn.call(t,"__wrapped__"),v=l&&Rn.call(e,"__wrapped__");if(p||v){var d=p?t.value():t,y=v?e.value():e;return o||(o=new Cn),i(d,y,r,n,o)}}return!!h&&(o||(o=new Cn),In(t,e,r,n,i,o))},Gn=w;var Qn=function t(e,r,n,i,o){return e===r||(null==e||null==r||!Gn(e)&&!Gn(r)?e!=e&&r!=r:Zn(e,r,n,i,t,o))},Kn=Ur,Xn=Qn;var ti=z;var ei=function(t){return t==t&&!ti(t)},ri=ei,ni=gr;var ii=function(t,e){return function(r){return null!=r&&(r[t]===e&&(void 0!==e||t in Object(r)))}},oi=function(t,e,r,n){var i=r.length,o=i,a=!n;if(null==t)return!o;for(t=Object(t);i--;){var u=r[i];if(a&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++i<o;){var c=(u=r[i])[0],s=t[c],f=u[1];if(a&&u[2]){if(void 0===s&&!(c in t))return!1}else{var l=new Kn;if(n)var h=n(s,f,c,t,e,l);if(!(void 0===h?Xn(f,s,3,n,l):h))return!1}}return!0},ai=function(t){for(var e=ni(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,ri(i)]}return e},ui=ii;var ci=ve,si=Ne,fi=o,li=He,hi=Ie,pi=ye;var vi=function(t,e,r){for(var n=-1,i=(e=ci(e,t)).length,o=!1;++n<i;){var a=pi(e[n]);if(!(o=null!=t&&r(t,a)))break;t=t[a]}return o||++n!=i?o:!!(i=null==t?0:t.length)&&hi(i)&&li(a,i)&&(fi(t)||si(t))},di=function(t,e){return null!=t&&e in Object(t)},yi=vi;var bi=function(t,e){return null!=t&&yi(t,e,di)},gi=Qn,_i=me,ji=bi,mi=k,wi=ei,$i=ii,Oi=ye;var Si=function(t,e){return mi(t)&&wi(e)?$i(Oi(t),e):function(r){var n=_i(r,t);return void 0===n&&n===e?ji(r,t):gi(e,n,3)}};var Mi=_e;var Di=function(t){return function(e){return Mi(e,t)}},xi=function(t){return function(e){return null==e?void 0:e[t]}},Ai=Di,ki=k,zi=ye;var Fi=function(t){return ki(t)?xi(zi(t)):Ai(t)},Pi=function(t){var e=ai(t);return 1==e.length&&e[0][2]?ui(e[0][0],e[0][1]):function(r){return r===t||oi(r,t,e)}},Ti=Si,Ni=$r,Yi=o,Ci=Fi;var Ei=function(t){return"function"==typeof t?t:null==t?Ni:"object"==typeof t?Yi(t)?Ti(t[0],t[1]):Pi(t):Ci(t)},Hi=Ei,Ii=vr,Li=gr;var Ui=function(t){return function(e,r,n){var i=Object(e);if(!Ii(e)){var o=Hi(r);e=Li(e),r=function(t){return o(i[t],t,i)}}var a=t(e,r,n);return a>-1?i[o?e[a]:a]:void 0}};var Wi=/\s/;var Bi=function(t){for(var e=t.length;e--&&Wi.test(t.charAt(e)););return e},Vi=/^\s+/;var qi=function(t){return t?t.slice(0,Bi(t)+1).replace(Vi,""):t},Ji=z,Ri=S,Zi=/^[-+]0x[0-9a-f]+$/i,Gi=/^0b[01]+$/i,Qi=/^0o[0-7]+$/i,Ki=parseInt;var Xi=function(t){if("number"==typeof t)return t;if(Ri(t))return NaN;if(Ji(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Ji(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=qi(t);var r=Gi.test(t);return r||Qi.test(t)?Ki(t.slice(2),r?2:8):Zi.test(t)?NaN:+t},to=Xi,eo=1/0;var ro=function(t){return t?(t=to(t))===eo||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0},no=ro;var io=function(t){var e=no(t),r=e%1;return e==e?r?e-r:e:0},oo=function(t,e,r,n){for(var i=t.length,o=r+(n?1:-1);n?o--:++o<i;)if(e(t[o],o,t))return o;return-1},ao=Ei,uo=io,co=Math.max;var so=Ui((function(t,e,r){var n=null==t?0:t.length;if(!n)return-1;var i=null==r?0:uo(r);return i<0&&(i=co(n+i,0)),oo(t,ao(e),i)}));function fo(t){return"[object String]"===Object.prototype.toString.call(t)}function lo(t){return!(!fo(t)||""===t)}function ho(t){return t!=t}function po(t){let e=!1;if(lo(t))e=!isNaN(Number(t));else if(function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)){if(ho(t))return!1;e=!0}return e}function vo(t){return"[object Array]"===Object.prototype.toString.call(t)}function yo(t){return"[object Object]"===Object.prototype.toString.call(t)}function bo(t){return!!function(t){return"[object Undefined]"===Object.prototype.toString.call(t)}(t)||(!!function(t){return"[object Null]"===Object.prototype.toString.call(t)}(t)||(!!function(t){if(yo(t)){for(let e in t)return!1;return!0}return!1}(t)||(!!function(t){return!(!fo(t)||""!==t)}(t)||(!!function(t){return!!vo(t)&&0===t.length}(t)||!!ho(t)))))}function go(t){return!!vo(t)&&(0!==t.length&&(1!==t.length||!bo(t[0])))}function _o(t){if(yo(t)){for(let e in t)return!0;return!1}return!1}function jo(t){if(!po(t))return 0;return ro(t)}var mo={};!function(t,e){t.exports=function(){var t=1e3,e=6e4,r=36e5,n="millisecond",i="second",o="minute",a="hour",u="day",c="week",s="month",f="quarter",l="year",h="date",p="Invalid Date",v=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,d=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,y={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(t){var e=["th","st","nd","rd"],r=t%100;return"["+t+(e[(r-20)%10]||e[r]||e[0])+"]"}},b=function(t,e,r){var n=String(t);return!n||n.length>=e?t:""+Array(e+1-n.length).join(r)+t},g={s:b,z:function(t){var e=-t.utcOffset(),r=Math.abs(e),n=Math.floor(r/60),i=r%60;return(e<=0?"+":"-")+b(n,2,"0")+":"+b(i,2,"0")},m:function t(e,r){if(e.date()<r.date())return-t(r,e);var n=12*(r.year()-e.year())+(r.month()-e.month()),i=e.clone().add(n,s),o=r-i<0,a=e.clone().add(n+(o?-1:1),s);return+(-(n+(r-i)/(o?i-a:a-i))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:s,y:l,w:c,d:u,D:h,h:a,m:o,s:i,ms:n,Q:f}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},_="en",j={};j[_]=y;var m=function(t){return t instanceof S},w=function t(e,r,n){var i;if(!e)return _;if("string"==typeof e){var o=e.toLowerCase();j[o]&&(i=o),r&&(j[o]=r,i=o);var a=e.split("-");if(!i&&a.length>1)return t(a[0])}else{var u=e.name;j[u]=e,i=u}return!n&&i&&(_=i),i||!n&&_},$=function(t,e){if(m(t))return t.clone();var r="object"==typeof e?e:{};return r.date=t,r.args=arguments,new S(r)},O=g;O.l=w,O.i=m,O.w=function(t,e){return $(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var S=function(){function y(t){this.$L=w(t.locale,null,!0),this.parse(t)}var b=y.prototype;return b.parse=function(t){this.$d=function(t){var e=t.date,r=t.utc;if(null===e)return new Date(NaN);if(O.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var n=e.match(v);if(n){var i=n[2]-1||0,o=(n[7]||"0").substring(0,3);return r?new Date(Date.UTC(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)):new Date(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},b.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},b.$utils=function(){return O},b.isValid=function(){return!(this.$d.toString()===p)},b.isSame=function(t,e){var r=$(t);return this.startOf(e)<=r&&r<=this.endOf(e)},b.isAfter=function(t,e){return $(t)<this.startOf(e)},b.isBefore=function(t,e){return this.endOf(e)<$(t)},b.$g=function(t,e,r){return O.u(t)?this[e]:this.set(r,t)},b.unix=function(){return Math.floor(this.valueOf()/1e3)},b.valueOf=function(){return this.$d.getTime()},b.startOf=function(t,e){var r=this,n=!!O.u(e)||e,f=O.p(t),p=function(t,e){var i=O.w(r.$u?Date.UTC(r.$y,e,t):new Date(r.$y,e,t),r);return n?i:i.endOf(u)},v=function(t,e){return O.w(r.toDate()[t].apply(r.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(e)),r)},d=this.$W,y=this.$M,b=this.$D,g="set"+(this.$u?"UTC":"");switch(f){case l:return n?p(1,0):p(31,11);case s:return n?p(1,y):p(0,y+1);case c:var _=this.$locale().weekStart||0,j=(d<_?d+7:d)-_;return p(n?b-j:b+(6-j),y);case u:case h:return v(g+"Hours",0);case a:return v(g+"Minutes",1);case o:return v(g+"Seconds",2);case i:return v(g+"Milliseconds",3);default:return this.clone()}},b.endOf=function(t){return this.startOf(t,!1)},b.$set=function(t,e){var r,c=O.p(t),f="set"+(this.$u?"UTC":""),p=(r={},r[u]=f+"Date",r[h]=f+"Date",r[s]=f+"Month",r[l]=f+"FullYear",r[a]=f+"Hours",r[o]=f+"Minutes",r[i]=f+"Seconds",r[n]=f+"Milliseconds",r)[c],v=c===u?this.$D+(e-this.$W):e;if(c===s||c===l){var d=this.clone().set(h,1);d.$d[p](v),d.init(),this.$d=d.set(h,Math.min(this.$D,d.daysInMonth())).$d}else p&&this.$d[p](v);return this.init(),this},b.set=function(t,e){return this.clone().$set(t,e)},b.get=function(t){return this[O.p(t)]()},b.add=function(n,f){var h,p=this;n=Number(n);var v=O.p(f),d=function(t){var e=$(p);return O.w(e.date(e.date()+Math.round(t*n)),p)};if(v===s)return this.set(s,this.$M+n);if(v===l)return this.set(l,this.$y+n);if(v===u)return d(1);if(v===c)return d(7);var y=(h={},h[o]=e,h[a]=r,h[i]=t,h)[v]||1,b=this.$d.getTime()+n*y;return O.w(b,this)},b.subtract=function(t,e){return this.add(-1*t,e)},b.format=function(t){var e=this,r=this.$locale();if(!this.isValid())return r.invalidDate||p;var n=t||"YYYY-MM-DDTHH:mm:ssZ",i=O.z(this),o=this.$H,a=this.$m,u=this.$M,c=r.weekdays,s=r.months,f=r.meridiem,l=function(t,r,i,o){return t&&(t[r]||t(e,n))||i[r].slice(0,o)},h=function(t){return O.s(o%12||12,t,"0")},v=f||function(t,e,r){var n=t<12?"AM":"PM";return r?n.toLowerCase():n};return n.replace(d,(function(t,n){return n||function(t){switch(t){case"YY":return String(e.$y).slice(-2);case"YYYY":return O.s(e.$y,4,"0");case"M":return u+1;case"MM":return O.s(u+1,2,"0");case"MMM":return l(r.monthsShort,u,s,3);case"MMMM":return l(s,u);case"D":return e.$D;case"DD":return O.s(e.$D,2,"0");case"d":return String(e.$W);case"dd":return l(r.weekdaysMin,e.$W,c,2);case"ddd":return l(r.weekdaysShort,e.$W,c,3);case"dddd":return c[e.$W];case"H":return String(o);case"HH":return O.s(o,2,"0");case"h":return h(1);case"hh":return h(2);case"a":return v(o,a,!0);case"A":return v(o,a,!1);case"m":return String(a);case"mm":return O.s(a,2,"0");case"s":return String(e.$s);case"ss":return O.s(e.$s,2,"0");case"SSS":return O.s(e.$ms,3,"0");case"Z":return i}return null}(t)||i.replace(":","")}))},b.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},b.diff=function(n,h,p){var v,d=this,y=O.p(h),b=$(n),g=(b.utcOffset()-this.utcOffset())*e,_=this-b,j=function(){return O.m(d,b)};switch(y){case l:v=j()/12;break;case s:v=j();break;case f:v=j()/3;break;case c:v=(_-g)/6048e5;break;case u:v=(_-g)/864e5;break;case a:v=_/r;break;case o:v=_/e;break;case i:v=_/t;break;default:v=_}return p?v:O.a(v)},b.daysInMonth=function(){return this.endOf(s).$D},b.$locale=function(){return j[this.$L]},b.locale=function(t,e){if(!t)return this.$L;var r=this.clone(),n=w(t,e,!0);return n&&(r.$L=n),r},b.clone=function(){return O.w(this.$d,this)},b.toDate=function(){return new Date(this.valueOf())},b.toJSON=function(){return this.isValid()?this.toISOString():null},b.toISOString=function(){return this.$d.toISOString()},b.toString=function(){return this.$d.toUTCString()},y}(),M=S.prototype;return $.prototype=M,[["$ms",n],["$s",i],["$m",o],["$H",a],["$W",u],["$M",s],["$y",l],["$D",h]].forEach((function(t){M[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),$.extend=function(t,e){return t.$i||(t(e,S,$),t.$i=!0),$},$.locale=w,$.isDayjs=m,$.unix=function(t){return $(1e3*t)},$.en=j[_],$.Ls=j,$.p={},$}()}({get exports(){return mo},set exports(t){mo=t}});var wo=mo;function $o(){return wo().format("YYYYMMDDHHmmss")}var Oo=io;var So=function(t){return"number"==typeof t&&t==Oo(t)};var Mo=io,Do=Xi,xo=se,Ao=s.isFinite,ko=Math.min;var zo=function(t){var e=Math[t];return function(t,r){if(t=Do(t),(r=null==r?0:ko(Mo(r),292))&&Ao(t)){var n=(xo(t)+"e").split("e"),i=e(n[0]+"e"+(+n[1]+r));return+((n=(xo(i)+"e").split("e"))[0]+"e"+(+n[1]-r))}return e(t)}}("round");function Fo(t){if(!po(t))return 0;t=jo(t);let e=zo(t);return"0"===String(e)?0:e}function Po(t){if(!function(t){return!!po(t)&&(t=jo(t),So(t))}(t))return!1;return Fo(t)>0}let To="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),No=To.length;function Yo(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,e=[];t=Po(t)?Fo(t):32;for(let r=0;r<t;r++)e[r]=To[0|Math.random()*No];return e.join("")}function Co(e){return!!t.existsSync(e)&&(!t.lstatSync(e).isDirectory()&&!t.lstatSync(e).isSymbolicLink())}let Eo=t.readFileSync("./node_modules/highcharts/highcharts.js","utf8"),Ho=t.readFileSync("./node_modules/highcharts/modules/stock.js","utf8"),Io=t.readFileSync("./node_modules/highcharts/modules/heatmap.js","utf8"),Lo=t.readFileSync("./node_modules/highcharts/modules/annotations.js","utf8"),Uo=t.readFileSync("./node_modules/highcharts/modules/boost.js","utf8"),Wo=t.readFileSync("./node_modules/highcharts/modules/boost-canvas.js","utf8"),Bo=process.cwd();return async function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:700,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:400,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(!po(n))return Promise.reject("width is not a number");if(n=jo(n),n<=0)return Promise.reject("width <= 0");if(!po(i))return Promise.reject("height is not a number");if(i=jo(i),i<=0)return Promise.reject("height <= 0");if(!po(o))return Promise.reject("scale is not a number");if(o=jo(o),o<=0)return Promise.reject("scale <= 0");if(!_o(a)&&!lo(a))return Promise.reject("opt is not an effective object or string");let c=me(u,"addScripts");go(c)||(c=[]);let s=me(u,"addCode");go(s)||(s="");let f=me(u,"executablePath",""),l=me(u,"executableFolder","");if(lo(l)&&!lo(f)){let r=function(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=1;return function r(o){let a=[],u=t.readdirSync(o);return kr(u,(function(u){let c=e.resolve(o,u),s=null;try{s=t.statSync(c)}catch(t){}s&&s.isDirectory()?(a.push({isFolder:!0,level:i,path:c,name:e.basename(c)}),i+=1,(i<=n||null===n)&&(a=a.concat(r(c))),i-=1):a.push({isFolder:!1,level:i,path:c,name:e.basename(c)})})),a}(r)}(l,null),n=so(r,(t=>"chrome.exe"===t.name));if(!_o(n))throw new Error(`can not find chrome.exe in executableFolder[${l}]`);f=n.path}let h="";if(lo(a))h=a;else{h=`let opt=${JSON.stringify(a)};`}let p=`./whpic-${$o()}-${Yo()}.png`,v=e.resolve(Bo,p),d=`./whweb-${$o()}-${Yo()}.html`,y=e.resolve(Bo,d),b="";kr(c,(t=>{b+=`<script src="${t}"><\/script>`}));let g="\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"UTF-8\">\n  <title>highcharts to png</title>\n\n  <script src=\"https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js\"><\/script>\n\n  <script>{code_highcharts}<\/script>\n  <script>{code_stock}<\/script>\n  <script>{code_heatmap}<\/script>\n  <script>{code_annotations}<\/script>\n  <script>{code_boost}<\/script>\n  <script>{code_boost_canvas}<\/script>\n\n  {add_scripts}\n\n  <script>{add_code}<\/script>\n\n</head>\n<body style=\"padding:0; margin:0;\">\n\n    <div id=\"hc\" style=\"width:{width}px; height:{height}px;\"></div>\n\n    <script>\n\n        {cOpt}\n\n        if(_.isObject(opt)){\n\n            //強制關閉動畫避免過慢顯示無法截到數據圖\n            _.set(opt, 'chart.animation', false)\n            _.set(opt, 'plotOptions.series.animation', false)\n            // console.log('opt', opt)\n        \n            //plot\n            Highcharts.chart('hc', opt)\n\n        }\n        else{\n            console.log('invalid opt')\n        }\n\n    <\/script>\n\n</body>\n</html>\n";g=g.replace("{width}",n),g=g.replace("{height}",i),g=g.replace("{cOpt}",h),g=g.replace("{code_highcharts}",Eo),g=g.replace("{code_stock}",Ho),g=g.replace("{code_heatmap}",Io),g=g.replace("{code_annotations}",Lo),g=g.replace("{code_boost}",Uo),g=g.replace("{code_boost_canvas}",Wo),g=g.replace("{add_scripts}",b),g=g.replace("{add_code}",s),t.writeFileSync(y,g,"utf8");let _="";return await(async()=>{let e={headless:"new",slowMo:20};lo(f)&&(e.executablePath=f);let a=await r.launch(e),u=await a.newPage(),c={x:0,y:0,width:Number(n),height:Number(i),deviceScaleFactor:Number(o)};await u.goto(y),await u.setViewport(c),await u.screenshot({path:v}),await a.close(),_=t.readFileSync(v,{encoding:"base64"})})().catch((t=>{console.log(t)})),Co(y)&&t.unlinkSync(y),Co(v)&&t.unlinkSync(v),_}}));
//# sourceMappingURL=w-hc-2-png.umd.js.map
