/*!
 * w-hc-2-png v1.0.15
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("fs"),require("path"),require("puppeteer")):"function"==typeof define&&define.amd?define(["fs","path","puppeteer"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-hc-2-png"]=e(t.fs,t.path,t.puppeteer)}(this,(function(t,e,r){"use strict";var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function o(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var i=Array.isArray,a="object"==typeof n&&n&&n.Object===Object&&n,u=a,c="object"==typeof self&&self&&self.Object===Object&&self,s=u||c||Function("return this")(),f=s.Symbol,l=f,h=Object.prototype,p=h.hasOwnProperty,d=h.toString,v=l?l.toStringTag:void 0;var y=function(t){var e=p.call(t,v),r=t[v];try{t[v]=void 0;var n=!0}catch(t){}var o=d.call(t);return n&&(e?t[v]=r:delete t[v]),o},b=Object.prototype.toString;var g=y,_=function(t){return b.call(t)},m=f?f.toStringTag:void 0;var $=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":m&&m in Object(t)?g(t):_(t)};var j=function(t){return null!=t&&"object"==typeof t},O=$,w=j;var S=function(t){return"symbol"==typeof t||w(t)&&"[object Symbol]"==O(t)},M=i,D=S,x=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,A=/^\w*$/;var T=function(t,e){if(M(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!D(t))||(A.test(t)||!x.test(t)||null!=e&&t in Object(e))};var k=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},F=$,P=k;var N,Y=function(t){if(!P(t))return!1;var e=F(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},z=s["__core-js_shared__"],C=(N=/[^.]+$/.exec(z&&z.keys&&z.keys.IE_PROTO||""))?"Symbol(src)_1."+N:"";var H=function(t){return!!C&&C in t},I=Function.prototype.toString;var L=Y,U=H,E=k,W=function(t){if(null!=t){try{return I.call(t)}catch(t){}try{return t+""}catch(t){}}return""},q=/^\[object .+?Constructor\]$/,B=Function.prototype,J=Object.prototype,V=B.toString,Z=J.hasOwnProperty,R=RegExp("^"+V.call(Z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var G=function(t){return!(!E(t)||U(t))&&(L(t)?R:q).test(W(t))},Q=function(t,e){return null==t?void 0:t[e]};var K=function(t,e){var r=Q(t,e);return G(r)?r:void 0},X=K(Object,"create"),tt=X;var et=function(){this.__data__=tt?tt(null):{},this.size=0};var rt=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},nt=X,ot=Object.prototype.hasOwnProperty;var it=function(t){var e=this.__data__;if(nt){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return ot.call(e,t)?e[t]:void 0},at=X,ut=Object.prototype.hasOwnProperty;var ct=X;var st=et,ft=rt,lt=it,ht=function(t){var e=this.__data__;return at?void 0!==e[t]:ut.call(e,t)},pt=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=ct&&void 0===e?"__lodash_hash_undefined__":e,this};function dt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}dt.prototype.clear=st,dt.prototype.delete=ft,dt.prototype.get=lt,dt.prototype.has=ht,dt.prototype.set=pt;var vt=dt;var yt=function(){this.__data__=[],this.size=0};var bt=function(t,e){return t===e||t!=t&&e!=e};var gt=function(t,e){for(var r=t.length;r--;)if(bt(t[r][0],e))return r;return-1},_t=gt,mt=Array.prototype.splice;var $t=gt;var jt=gt;var Ot=gt;var wt=yt,St=function(t){var e=this.__data__,r=_t(e,t);return!(r<0)&&(r==e.length-1?e.pop():mt.call(e,r,1),--this.size,!0)},Mt=function(t){var e=this.__data__,r=$t(e,t);return r<0?void 0:e[r][1]},Dt=function(t){return jt(this.__data__,t)>-1},xt=function(t,e){var r=this.__data__,n=Ot(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};function At(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}At.prototype.clear=wt,At.prototype.delete=St,At.prototype.get=Mt,At.prototype.has=Dt,At.prototype.set=xt;var Tt=At,kt=K(s,"Map"),Ft=vt,Pt=Tt,Nt=kt;var Yt=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var zt=function(t,e){var r=t.__data__;return Yt(e)?r["string"==typeof e?"string":"hash"]:r.map},Ct=zt;var Ht=zt;var It=zt;var Lt=zt;var Ut=function(){this.size=0,this.__data__={hash:new Ft,map:new(Nt||Pt),string:new Ft}},Et=function(t){var e=Ct(this,t).delete(t);return this.size-=e?1:0,e},Wt=function(t){return Ht(this,t).get(t)},qt=function(t){return It(this,t).has(t)},Bt=function(t,e){var r=Lt(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};function Jt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Jt.prototype.clear=Ut,Jt.prototype.delete=Et,Jt.prototype.get=Wt,Jt.prototype.has=qt,Jt.prototype.set=Bt;var Vt=Jt;function Zt(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=t.apply(this,n);return r.cache=i.set(o,a)||i,a};return r.cache=new(Zt.Cache||Vt),r}Zt.Cache=Vt;var Rt=Zt;var Gt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Qt=/\\(\\)?/g,Kt=function(t){var e=Rt(t,(function(t){return 500===r.size&&r.clear(),t})),r=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Gt,(function(t,r,n,o){e.push(n?o.replace(Qt,"$1"):r||t)})),e}));var Xt=function(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o},te=i,ee=S,re=f?f.prototype:void 0,ne=re?re.toString:void 0;var oe=function t(e){if("string"==typeof e)return e;if(te(e))return Xt(e,t)+"";if(ee(e))return ne?ne.call(e):"";var r=e+"";return"0"==r&&1/e==-Infinity?"-0":r},ie=oe;var ae=function(t){return null==t?"":ie(t)},ue=i,ce=T,se=Kt,fe=ae;var le=S;var he=function(t,e){return ue(t)?t:ce(t,e)?[t]:se(fe(t))},pe=function(t){if("string"==typeof t||le(t))return t;var e=t+"";return"0"==e&&1/t==-Infinity?"-0":e};var de=function(t,e){for(var r=0,n=(e=he(e,t)).length;null!=t&&r<n;)t=t[pe(e[r++])];return r&&r==n?t:void 0},ve=de;var ye=function(t,e,r){var n=null==t?void 0:ve(t,e);return void 0===n?r:n},be={},ge={get exports(){return be},set exports(t){be=t}};var _e=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t};var me=function(t){return function(e,r,n){for(var o=-1,i=Object(e),a=n(e),u=a.length;u--;){var c=a[t?u:++o];if(!1===r(i[c],c,i))break}return e}}();var $e=function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n},je=$,Oe=j;var we=function(t){return Oe(t)&&"[object Arguments]"==je(t)},Se=j,Me=Object.prototype,De=Me.hasOwnProperty,xe=Me.propertyIsEnumerable,Ae=we(function(){return arguments}())?we:function(t){return Se(t)&&De.call(t,"callee")&&!xe.call(t,"callee")},Te=Ae,ke={};var Fe=function(){return!1};!function(t,e){var r=s,n=Fe,o=e&&!e.nodeType&&e,i=o&&t&&!t.nodeType&&t,a=i&&i.exports===o?r.Buffer:void 0,u=(a?a.isBuffer:void 0)||n;t.exports=u}({get exports(){return ke},set exports(t){ke=t}},ke);var Pe=/^(?:0|[1-9]\d*)$/;var Ne=function(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&Pe.test(t))&&t>-1&&t%1==0&&t<e};var Ye=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},ze=$,Ce=Ye,He=j,Ie={};Ie["[object Float32Array]"]=Ie["[object Float64Array]"]=Ie["[object Int8Array]"]=Ie["[object Int16Array]"]=Ie["[object Int32Array]"]=Ie["[object Uint8Array]"]=Ie["[object Uint8ClampedArray]"]=Ie["[object Uint16Array]"]=Ie["[object Uint32Array]"]=!0,Ie["[object Arguments]"]=Ie["[object Array]"]=Ie["[object ArrayBuffer]"]=Ie["[object Boolean]"]=Ie["[object DataView]"]=Ie["[object Date]"]=Ie["[object Error]"]=Ie["[object Function]"]=Ie["[object Map]"]=Ie["[object Number]"]=Ie["[object Object]"]=Ie["[object RegExp]"]=Ie["[object Set]"]=Ie["[object String]"]=Ie["[object WeakMap]"]=!1;var Le=function(t){return He(t)&&Ce(t.length)&&!!Ie[ze(t)]};var Ue=function(t){return function(e){return t(e)}},Ee={};!function(t,e){var r=a,n=e&&!e.nodeType&&e,o=n&&t&&!t.nodeType&&t,i=o&&o.exports===n&&r.process,u=function(){try{var t=o&&o.require&&o.require("util").types;return t||i&&i.binding&&i.binding("util")}catch(t){}}();t.exports=u}({get exports(){return Ee},set exports(t){Ee=t}},Ee);var We=Le,qe=Ue,Be=Ee&&Ee.isTypedArray,Je=Be?qe(Be):We,Ve=$e,Ze=Te,Re=i,Ge=ke,Qe=Ne,Ke=Je,Xe=Object.prototype.hasOwnProperty;var tr=function(t,e){var r=Re(t),n=!r&&Ze(t),o=!r&&!n&&Ge(t),i=!r&&!n&&!o&&Ke(t),a=r||n||o||i,u=a?Ve(t.length,String):[],c=u.length;for(var s in t)!e&&!Xe.call(t,s)||a&&("length"==s||o&&("offset"==s||"parent"==s)||i&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||Qe(s,c))||u.push(s);return u},er=Object.prototype;var rr=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||er)};var nr=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object),or=rr,ir=nr,ar=Object.prototype.hasOwnProperty;var ur=Y,cr=Ye;var sr=function(t){return null!=t&&cr(t.length)&&!ur(t)},fr=tr,lr=function(t){if(!or(t))return ir(t);var e=[];for(var r in Object(t))ar.call(t,r)&&"constructor"!=r&&e.push(r);return e},hr=sr;var pr=me,dr=function(t){return hr(t)?fr(t):lr(t)};var vr=sr;var yr=function(t,e){return function(r,n){if(null==r)return r;if(!vr(r))return t(r,n);for(var o=r.length,i=e?o:-1,a=Object(r);(e?i--:++i<o)&&!1!==n(a[i],i,a););return r}}((function(t,e){return t&&pr(t,e,dr)}));var br=function(t){return t};var gr=_e,_r=yr,mr=function(t){return"function"==typeof t?t:br},$r=i;var jr=function(t,e){return($r(t)?gr:_r)(t,mr(e))};!function(t){t.exports=jr}(ge);var Or=o(be);function wr(t){return"[object String]"===Object.prototype.toString.call(t)}function Sr(t){return!(!wr(t)||""===t)}function Mr(t){let e=!1;return Sr(t)?e=!isNaN(Number(t)):function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)&&(e=!0),e}function Dr(t){return"[object Array]"===Object.prototype.toString.call(t)}function xr(t){return"[object Object]"===Object.prototype.toString.call(t)}function Ar(t){return!!function(t){return"[object Undefined]"===Object.prototype.toString.call(t)}(t)||(!!function(t){return"[object Null]"===Object.prototype.toString.call(t)}(t)||(!!function(t){if(xr(t)){for(let e in t)return!1;return!0}return!1}(t)||(!!function(t){return!(!wr(t)||""!==t)}(t)||!!function(t){return!!Dr(t)&&0===t.length}(t))))}function Tr(t){return!!Dr(t)&&(0!==t.length&&(1!==t.length||!Ar(t[0])))}function kr(t){if(xr(t)){for(let e in t)return!0;return!1}return!1}var Fr=$,Pr=j;var Nr=function(t){return!0===t||!1===t||Pr(t)&&"[object Boolean]"==Fr(t)};var Yr=/\s/;var zr=function(t){for(var e=t.length;e--&&Yr.test(t.charAt(e)););return e},Cr=/^\s+/;var Hr=function(t){return t?t.slice(0,zr(t)+1).replace(Cr,""):t},Ir=k,Lr=S,Ur=/^[-+]0x[0-9a-f]+$/i,Er=/^0b[01]+$/i,Wr=/^0o[0-7]+$/i,qr=parseInt;var Br=function(t){if("number"==typeof t)return t;if(Lr(t))return NaN;if(Ir(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Ir(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Hr(t);var r=Er.test(t);return r||Wr.test(t)?qr(t.slice(2),r?2:8):Ur.test(t)?NaN:+t},Jr=Br,Vr=1/0;var Zr=function(t){return t?(t=Jr(t))===Vr||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0};function Rr(t){if(!Mr(t))return 0;return Zr(t)}var Gr={};!function(t,e){t.exports=function(){var t=1e3,e=6e4,r=36e5,n="millisecond",o="second",i="minute",a="hour",u="day",c="week",s="month",f="quarter",l="year",h="date",p="Invalid Date",d=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,v=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,y={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(t){var e=["th","st","nd","rd"],r=t%100;return"["+t+(e[(r-20)%10]||e[r]||e[0])+"]"}},b=function(t,e,r){var n=String(t);return!n||n.length>=e?t:""+Array(e+1-n.length).join(r)+t},g={s:b,z:function(t){var e=-t.utcOffset(),r=Math.abs(e),n=Math.floor(r/60),o=r%60;return(e<=0?"+":"-")+b(n,2,"0")+":"+b(o,2,"0")},m:function t(e,r){if(e.date()<r.date())return-t(r,e);var n=12*(r.year()-e.year())+(r.month()-e.month()),o=e.clone().add(n,s),i=r-o<0,a=e.clone().add(n+(i?-1:1),s);return+(-(n+(r-o)/(i?o-a:a-o))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:s,y:l,w:c,d:u,D:h,h:a,m:i,s:o,ms:n,Q:f}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},_="en",m={};m[_]=y;var $=function(t){return t instanceof S},j=function t(e,r,n){var o;if(!e)return _;if("string"==typeof e){var i=e.toLowerCase();m[i]&&(o=i),r&&(m[i]=r,o=i);var a=e.split("-");if(!o&&a.length>1)return t(a[0])}else{var u=e.name;m[u]=e,o=u}return!n&&o&&(_=o),o||!n&&_},O=function(t,e){if($(t))return t.clone();var r="object"==typeof e?e:{};return r.date=t,r.args=arguments,new S(r)},w=g;w.l=j,w.i=$,w.w=function(t,e){return O(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var S=function(){function y(t){this.$L=j(t.locale,null,!0),this.parse(t)}var b=y.prototype;return b.parse=function(t){this.$d=function(t){var e=t.date,r=t.utc;if(null===e)return new Date(NaN);if(w.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var n=e.match(d);if(n){var o=n[2]-1||0,i=(n[7]||"0").substring(0,3);return r?new Date(Date.UTC(n[1],o,n[3]||1,n[4]||0,n[5]||0,n[6]||0,i)):new Date(n[1],o,n[3]||1,n[4]||0,n[5]||0,n[6]||0,i)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},b.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},b.$utils=function(){return w},b.isValid=function(){return!(this.$d.toString()===p)},b.isSame=function(t,e){var r=O(t);return this.startOf(e)<=r&&r<=this.endOf(e)},b.isAfter=function(t,e){return O(t)<this.startOf(e)},b.isBefore=function(t,e){return this.endOf(e)<O(t)},b.$g=function(t,e,r){return w.u(t)?this[e]:this.set(r,t)},b.unix=function(){return Math.floor(this.valueOf()/1e3)},b.valueOf=function(){return this.$d.getTime()},b.startOf=function(t,e){var r=this,n=!!w.u(e)||e,f=w.p(t),p=function(t,e){var o=w.w(r.$u?Date.UTC(r.$y,e,t):new Date(r.$y,e,t),r);return n?o:o.endOf(u)},d=function(t,e){return w.w(r.toDate()[t].apply(r.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(e)),r)},v=this.$W,y=this.$M,b=this.$D,g="set"+(this.$u?"UTC":"");switch(f){case l:return n?p(1,0):p(31,11);case s:return n?p(1,y):p(0,y+1);case c:var _=this.$locale().weekStart||0,m=(v<_?v+7:v)-_;return p(n?b-m:b+(6-m),y);case u:case h:return d(g+"Hours",0);case a:return d(g+"Minutes",1);case i:return d(g+"Seconds",2);case o:return d(g+"Milliseconds",3);default:return this.clone()}},b.endOf=function(t){return this.startOf(t,!1)},b.$set=function(t,e){var r,c=w.p(t),f="set"+(this.$u?"UTC":""),p=(r={},r[u]=f+"Date",r[h]=f+"Date",r[s]=f+"Month",r[l]=f+"FullYear",r[a]=f+"Hours",r[i]=f+"Minutes",r[o]=f+"Seconds",r[n]=f+"Milliseconds",r)[c],d=c===u?this.$D+(e-this.$W):e;if(c===s||c===l){var v=this.clone().set(h,1);v.$d[p](d),v.init(),this.$d=v.set(h,Math.min(this.$D,v.daysInMonth())).$d}else p&&this.$d[p](d);return this.init(),this},b.set=function(t,e){return this.clone().$set(t,e)},b.get=function(t){return this[w.p(t)]()},b.add=function(n,f){var h,p=this;n=Number(n);var d=w.p(f),v=function(t){var e=O(p);return w.w(e.date(e.date()+Math.round(t*n)),p)};if(d===s)return this.set(s,this.$M+n);if(d===l)return this.set(l,this.$y+n);if(d===u)return v(1);if(d===c)return v(7);var y=(h={},h[i]=e,h[a]=r,h[o]=t,h)[d]||1,b=this.$d.getTime()+n*y;return w.w(b,this)},b.subtract=function(t,e){return this.add(-1*t,e)},b.format=function(t){var e=this,r=this.$locale();if(!this.isValid())return r.invalidDate||p;var n=t||"YYYY-MM-DDTHH:mm:ssZ",o=w.z(this),i=this.$H,a=this.$m,u=this.$M,c=r.weekdays,s=r.months,f=r.meridiem,l=function(t,r,o,i){return t&&(t[r]||t(e,n))||o[r].slice(0,i)},h=function(t){return w.s(i%12||12,t,"0")},d=f||function(t,e,r){var n=t<12?"AM":"PM";return r?n.toLowerCase():n};return n.replace(v,(function(t,n){return n||function(t){switch(t){case"YY":return String(e.$y).slice(-2);case"YYYY":return w.s(e.$y,4,"0");case"M":return u+1;case"MM":return w.s(u+1,2,"0");case"MMM":return l(r.monthsShort,u,s,3);case"MMMM":return l(s,u);case"D":return e.$D;case"DD":return w.s(e.$D,2,"0");case"d":return String(e.$W);case"dd":return l(r.weekdaysMin,e.$W,c,2);case"ddd":return l(r.weekdaysShort,e.$W,c,3);case"dddd":return c[e.$W];case"H":return String(i);case"HH":return w.s(i,2,"0");case"h":return h(1);case"hh":return h(2);case"a":return d(i,a,!0);case"A":return d(i,a,!1);case"m":return String(a);case"mm":return w.s(a,2,"0");case"s":return String(e.$s);case"ss":return w.s(e.$s,2,"0");case"SSS":return w.s(e.$ms,3,"0");case"Z":return o}return null}(t)||o.replace(":","")}))},b.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},b.diff=function(n,h,p){var d,v=this,y=w.p(h),b=O(n),g=(b.utcOffset()-this.utcOffset())*e,_=this-b,m=function(){return w.m(v,b)};switch(y){case l:d=m()/12;break;case s:d=m();break;case f:d=m()/3;break;case c:d=(_-g)/6048e5;break;case u:d=(_-g)/864e5;break;case a:d=_/r;break;case i:d=_/e;break;case o:d=_/t;break;default:d=_}return p?d:w.a(d)},b.daysInMonth=function(){return this.endOf(s).$D},b.$locale=function(){return m[this.$L]},b.locale=function(t,e){if(!t)return this.$L;var r=this.clone(),n=j(t,e,!0);return n&&(r.$L=n),r},b.clone=function(){return w.w(this.$d,this)},b.toDate=function(){return new Date(this.valueOf())},b.toJSON=function(){return this.isValid()?this.toISOString():null},b.toISOString=function(){return this.$d.toISOString()},b.toString=function(){return this.$d.toUTCString()},y}(),M=S.prototype;return O.prototype=M,[["$ms",n],["$s",o],["$m",i],["$H",a],["$W",u],["$M",s],["$y",l],["$D",h]].forEach((function(t){M[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),O.extend=function(t,e){return t.$i||(t(e,S,O),t.$i=!0),O},O.locale=j,O.isDayjs=$,O.unix=function(t){return O(1e3*t)},O.en=m[_],O.Ls=m,O.p={},O}()}({get exports(){return Gr},set exports(t){Gr=t}});var Qr=Gr;function Kr(){return Qr().format("YYYYMMDDHHmmss")}var Xr=Zr;var tn=function(t){var e=Xr(t),r=e%1;return e==e?r?e-r:e:0},en=tn;var rn=function(t){return"number"==typeof t&&t==en(t)};var nn=tn,on=Br,an=ae,un=s.isFinite,cn=Math.min;var sn=function(t){var e=Math[t];return function(t,r){if(t=on(t),(r=null==r?0:cn(nn(r),292))&&un(t)){var n=(an(t)+"e").split("e"),o=e(n[0]+"e"+(+n[1]+r));return+((n=(an(o)+"e").split("e"))[0]+"e"+(+n[1]-r))}return e(t)}}("round");function fn(t){if(!Mr(t))return 0;t=Rr(t);let e=sn(t);return"0"===String(e)?0:e}function ln(t){if(!function(t){return!!Mr(t)&&(t=Rr(t),rn(t))}(t))return!1;return fn(t)>0}let hn="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),pn=hn.length;function dn(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,e=[];t=ln(t)?fn(t):32;for(let r=0;r<t;r++)e[r]=hn[0|Math.random()*pn];return e.join("")}let vn=t.readFileSync("./node_modules/highcharts/highcharts.js","utf8"),yn=t.readFileSync("./node_modules/highcharts/modules/stock.js","utf8"),bn=t.readFileSync("./node_modules/highcharts/modules/heatmap.js","utf8"),gn=t.readFileSync("./node_modules/highcharts/modules/annotations.js","utf8"),_n=t.readFileSync("./node_modules/highcharts/modules/boost.js","utf8"),mn=t.readFileSync("./node_modules/highcharts/modules/boost-canvas.js","utf8"),$n=process.cwd();return async function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:700,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:400,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(!Mr(n))return Promise.reject("width is not a number");if(n=Rr(n),n<=0)return Promise.reject("width <= 0");if(!Mr(o))return Promise.reject("height is not a number");if(o=Rr(o),o<=0)return Promise.reject("height <= 0");if(!Mr(i))return Promise.reject("scale is not a number");if(i=Rr(i),i<=0)return Promise.reject("scale <= 0");if(!kr(a)&&!Sr(a))return Promise.reject("opt is not an effective object or string");let c=ye(u,"addScripts");Tr(c)||(c=[]);let s=ye(u,"addCode");Tr(s)||(s="");let f=ye(u,"useWindowOpt");Nr(f)||(f=!1);let l="let _opt=",h="";f&&(l="",h="let _opt=window.opt;");let p=a;kr(a)&&(p=JSON.stringify(a));let d=`./whpic-${Kr()}-${dn()}.png`,v=e.resolve($n,d),y=`./whweb-${Kr()}-${dn()}.html`,b=e.resolve($n,y),g="";Or(c,(t=>{g+=`<script src="${t}"><\/script>`}));let _='\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="UTF-8">\n  <title>highcharts to png</title>\n\n  <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"><\/script>\n\n  <script>{code_highcharts}<\/script>\n  <script>{code_stock}<\/script>\n  <script>{code_heatmap}<\/script>\n  <script>{code_annotations}<\/script>\n  <script>{code_boost}<\/script>\n  <script>{code_boost_canvas}<\/script>\n\n  {add_scripts}\n\n  <script>{add_code}<\/script>\n\n</head>\n<body style="padding:0; margin:0;">\n\n    <div id="hc" style="width:{width}px; height:{height}px;"></div>\n\n    <script>\n\n        {cLetOptStart}{cOpt}\n        {cLetOptEnd}\n\n        //opt若為物件時, 強制關閉動畫避免過慢顯示無法截到數據圖\n        _.set(_opt, \'chart.animation\', false)\n        _.set(_opt, \'plotOptions.series.animation\', false)\n        // console.log(\'_opt\', _opt)\n    \n        Highcharts.chart(\'hc\', _opt)\n\n    <\/script>\n\n</body>\n</html>\n';_=_.replace("{width}",n),_=_.replace("{height}",o),_=_.replace("{cLetOptStart}",l),_=_.replace("{cLetOptEnd}",h),_=_.replace("{cOpt}",p),_=_.replace("{code_highcharts}",vn),_=_.replace("{code_stock}",yn),_=_.replace("{code_heatmap}",bn),_=_.replace("{code_annotations}",gn),_=_.replace("{code_boost}",_n),_=_.replace("{code_boost_canvas}",mn),_=_.replace("{add_scripts}",g),_=_.replace("{add_code}",s),t.writeFileSync(b,_,"utf8");let m=await r.launch({headless:!0,slowMo:20}),$=await m.newPage(),j={x:0,y:0,width:Number(n),height:Number(o),deviceScaleFactor:Number(i)};await $.goto(b),await $.setViewport(j),await $.screenshot({path:v}),await m.close(),t.unlinkSync(b);let O=t.readFileSync(v,{encoding:"base64"});return t.unlinkSync(v),O}}));
//# sourceMappingURL=w-hc-2-png.umd.js.map
