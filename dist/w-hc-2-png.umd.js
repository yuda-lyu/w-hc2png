/*!
 * w-hc-2-png v1.0.37
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("fs"),require("path"),require("puppeteer"),require("child_process")):"function"==typeof define&&define.amd?define(["fs","path","puppeteer","child_process"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-hc-2-png"]=e(t.fs,t.path,t.puppeteer,t.require$$0)}(this,(function(t,e,r,n){"use strict";var i=Array.isArray,o="object"==typeof global&&global&&global.Object===Object&&global,u="object"==typeof self&&self&&self.Object===Object&&self,a=o||u||Function("return this")(),c=a.Symbol,s=Object.prototype,f=s.hasOwnProperty,l=s.toString,h=c?c.toStringTag:void 0;var p=Object.prototype.toString;var d=c?c.toStringTag:void 0;function y(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":d&&d in Object(t)?function(t){var e=f.call(t,h),r=t[h];try{t[h]=void 0;var n=!0}catch(t){}var i=l.call(t);return n&&(e?t[h]=r:delete t[h]),i}(t):function(t){return p.call(t)}(t)}function v(t){return null!=t&&"object"==typeof t}function b(t){return"symbol"==typeof t||v(t)&&"[object Symbol]"==y(t)}var g=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,m=/^\w*$/;function _(t,e){if(i(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!b(t))||(m.test(t)||!g.test(t)||null!=e&&t in Object(e))}function j(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function w(t){if(!j(t))return!1;var e=y(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}var $,S=a["__core-js_shared__"],O=($=/[^.]+$/.exec(S&&S.keys&&S.keys.IE_PROTO||""))?"Symbol(src)_1."+$:"";var x=Function.prototype.toString;function M(t){if(null!=t){try{return x.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var D=/^\[object .+?Constructor\]$/,P=Function.prototype,F=Object.prototype,k=P.toString,A=F.hasOwnProperty,z=RegExp("^"+k.call(A).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function E(t){return!(!j(t)||(e=t,O&&O in e))&&(w(t)?z:D).test(M(t));var e}function H(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return E(r)?r:void 0}var T=H(Object,"create");var N=Object.prototype.hasOwnProperty;var I=Object.prototype.hasOwnProperty;function Y(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function L(t,e){return t===e||t!=t&&e!=e}function C(t,e){for(var r=t.length;r--;)if(L(t[r][0],e))return r;return-1}Y.prototype.clear=function(){this.__data__=T?T(null):{},this.size=0},Y.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Y.prototype.get=function(t){var e=this.__data__;if(T){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return N.call(e,t)?e[t]:void 0},Y.prototype.has=function(t){var e=this.__data__;return T?void 0!==e[t]:I.call(e,t)},Y.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=T&&void 0===e?"__lodash_hash_undefined__":e,this};var J=Array.prototype.splice;function U(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}U.prototype.clear=function(){this.__data__=[],this.size=0},U.prototype.delete=function(t){var e=this.__data__,r=C(e,t);return!(r<0)&&(r==e.length-1?e.pop():J.call(e,r,1),--this.size,!0)},U.prototype.get=function(t){var e=this.__data__,r=C(e,t);return r<0?void 0:e[r][1]},U.prototype.has=function(t){return C(this.__data__,t)>-1},U.prototype.set=function(t,e){var r=this.__data__,n=C(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};var W=H(a,"Map");function B(t,e){var r,n,i=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof e?"string":"hash"]:i.map}function V(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}V.prototype.clear=function(){this.size=0,this.__data__={hash:new Y,map:new(W||U),string:new Y}},V.prototype.delete=function(t){var e=B(this,t).delete(t);return this.size-=e?1:0,e},V.prototype.get=function(t){return B(this,t).get(t)},V.prototype.has=function(t){return B(this,t).has(t)},V.prototype.set=function(t,e){var r=B(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};function q(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var u=t.apply(this,n);return r.cache=o.set(i,u)||o,u};return r.cache=new(q.Cache||V),r}q.Cache=V;var R,Z,G,K=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Q=/\\(\\)?/g,X=(R=function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(K,(function(t,r,n,i){e.push(n?i.replace(Q,"$1"):r||t)})),e},Z=q(R,(function(t){return 500===G.size&&G.clear(),t})),G=Z.cache,Z),tt=X;var et=c?c.prototype:void 0,rt=et?et.toString:void 0;function nt(t){if("string"==typeof t)return t;if(i(t))return function(t,e){for(var r=-1,n=null==t?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}(t,nt)+"";if(b(t))return rt?rt.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function it(t){return null==t?"":nt(t)}function ot(t,e){return i(t)?t:_(t,e)?[t]:tt(it(t))}function ut(t){if("string"==typeof t||b(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function at(t,e){for(var r=0,n=(e=ot(e,t)).length;null!=t&&r<n;)t=t[ut(e[r++])];return r&&r==n?t:void 0}function ct(t,e,r){var n=null==t?void 0:at(t,e);return void 0===n?r:n}function st(t){return"[object String]"===Object.prototype.toString.call(t)}function ft(t){return!(!st(t)||""===t)}function lt(t){return t!=t}function ht(t){let e=!1;if(ft(t))e=!isNaN(Number(t));else if(function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)){if(lt(t))return!1;e=!0}return e}function pt(t){return"[object Object]"===Object.prototype.toString.call(t)}function dt(t){if(pt(t)){for(let e in t)return!0;return!1}return!1}var yt=/\s/;var vt=/^\s+/;function bt(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&yt.test(t.charAt(e)););return e}(t)+1).replace(vt,""):t}var gt=/^[-+]0x[0-9a-f]+$/i,mt=/^0b[01]+$/i,_t=/^0o[0-7]+$/i,jt=parseInt;function wt(t){if("number"==typeof t)return t;if(b(t))return NaN;if(j(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=j(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=bt(t);var r=mt.test(t);return r||_t.test(t)?jt(t.slice(2),r?2:8):gt.test(t)?NaN:+t}var $t=1/0;function St(t){return t?(t=wt(t))===$t||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function Ot(t){if(!ht(t))return 0;return St(t)}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function xt(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Mt=n,Dt=Mt.spawn,Pt=Mt.exec;function Ft(t,e,r){var n={};try{Object.keys(t).forEach((function(r){t[r].forEach((function(t){n[t]||(kt(t,e),n[t]=1)})),n[r]||(kt(r,e),n[r]=1)}))}catch(t){if(r)return r(t);throw t}if(r)return r()}function kt(t,e){try{process.kill(parseInt(t,10),e)}catch(t){if("ESRCH"!==t.code)throw t}}function At(t,e,r,n,i){var o=n(t),u="";o.stdout.on("data",(function(t){t=t.toString("ascii");u+=t}));o.on("close",(function(o){delete r[t],0==o?u.match(/\d+/g).forEach((function(o){o=parseInt(o,10),e[t].push(o),e[o]=[],r[o]=1,At(o,e,r,n,i)})):0==Object.keys(r).length&&i()}))}var zt=xt((function(t,e,r){if("function"==typeof e&&void 0===r&&(r=e,e=void 0),t=parseInt(t),Number.isNaN(t)){if(r)return r(new Error("pid must be a number"));throw new Error("pid must be a number")}var n={},i={};switch(n[t]=[],i[t]=1,process.platform){case"win32":Pt("taskkill /pid "+t+" /T /F",r);break;case"darwin":At(t,n,i,(function(t){return Dt("pgrep",["-P",t])}),(function(){Ft(n,e,r)}));break;default:At(t,n,i,(function(t){return Dt("ps",["-o","pid","--no-headers","--ppid",t])}),(function(){Ft(n,e,r)}))}}));function Et(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t}var Ht,Tt=function(t,e,r){for(var n=-1,i=Object(t),o=r(t),u=o.length;u--;){var a=o[Ht?u:++n];if(!1===e(i[a],a,i))break}return t};function Nt(t){return v(t)&&"[object Arguments]"==y(t)}var It=Object.prototype,Yt=It.hasOwnProperty,Lt=It.propertyIsEnumerable,Ct=Nt(function(){return arguments}())?Nt:function(t){return v(t)&&Yt.call(t,"callee")&&!Lt.call(t,"callee")},Jt=Ct;var Ut="object"==typeof exports&&exports&&!exports.nodeType&&exports,Wt=Ut&&"object"==typeof module&&module&&!module.nodeType&&module,Bt=Wt&&Wt.exports===Ut?a.Buffer:void 0,Vt=(Bt?Bt.isBuffer:void 0)||function(){return!1},qt=/^(?:0|[1-9]\d*)$/;function Rt(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&qt.test(t))&&t>-1&&t%1==0&&t<e}function Zt(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}var Gt={};Gt["[object Float32Array]"]=Gt["[object Float64Array]"]=Gt["[object Int8Array]"]=Gt["[object Int16Array]"]=Gt["[object Int32Array]"]=Gt["[object Uint8Array]"]=Gt["[object Uint8ClampedArray]"]=Gt["[object Uint16Array]"]=Gt["[object Uint32Array]"]=!0,Gt["[object Arguments]"]=Gt["[object Array]"]=Gt["[object ArrayBuffer]"]=Gt["[object Boolean]"]=Gt["[object DataView]"]=Gt["[object Date]"]=Gt["[object Error]"]=Gt["[object Function]"]=Gt["[object Map]"]=Gt["[object Number]"]=Gt["[object Object]"]=Gt["[object RegExp]"]=Gt["[object Set]"]=Gt["[object String]"]=Gt["[object WeakMap]"]=!1;var Kt="object"==typeof exports&&exports&&!exports.nodeType&&exports,Qt=Kt&&"object"==typeof module&&module&&!module.nodeType&&module,Xt=Qt&&Qt.exports===Kt&&o.process,te=function(){try{var t=Qt&&Qt.require&&Qt.require("util").types;return t||Xt&&Xt.binding&&Xt.binding("util")}catch(t){}}(),ee=te&&te.isTypedArray,re=ee?function(t){return function(e){return t(e)}}(ee):function(t){return v(t)&&Zt(t.length)&&!!Gt[y(t)]},ne=re,ie=Object.prototype.hasOwnProperty;function oe(t,e){var r=i(t),n=!r&&Jt(t),o=!r&&!n&&Vt(t),u=!r&&!n&&!o&&ne(t),a=r||n||o||u,c=a?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],s=c.length;for(var f in t)!e&&!ie.call(t,f)||a&&("length"==f||o&&("offset"==f||"parent"==f)||u&&("buffer"==f||"byteLength"==f||"byteOffset"==f)||Rt(f,s))||c.push(f);return c}var ue=Object.prototype;var ae=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object),ce=ae,se=Object.prototype.hasOwnProperty;function fe(t){if(r=(e=t)&&e.constructor,e!==("function"==typeof r&&r.prototype||ue))return ce(t);var e,r,n=[];for(var i in Object(t))se.call(t,i)&&"constructor"!=i&&n.push(i);return n}function le(t){return null!=t&&Zt(t.length)&&!w(t)}function he(t){return le(t)?oe(t):fe(t)}var pe=function(t,e){return function(r,n){if(null==r)return r;if(!le(r))return t(r,n);for(var i=r.length,o=e?i:-1,u=Object(r);(e?o--:++o<i)&&!1!==n(u[o],o,u););return r}}((function(t,e){return t&&Tt(t,e,he)})),de=pe;function ye(t){return t}function ve(t,e){var r;return(i(t)?Et:de)(t,"function"==typeof(r=e)?r:ye)}function be(t){var e=this.__data__=new U(t);this.size=e.size}be.prototype.clear=function(){this.__data__=new U,this.size=0},be.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},be.prototype.get=function(t){return this.__data__.get(t)},be.prototype.has=function(t){return this.__data__.has(t)},be.prototype.set=function(t,e){var r=this.__data__;if(r instanceof U){var n=r.__data__;if(!W||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new V(n)}return r.set(t,e),this.size=r.size,this};function ge(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new V;++e<r;)this.add(t[e])}function me(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function _e(t,e){return t.has(e)}ge.prototype.add=ge.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},ge.prototype.has=function(t){return this.__data__.has(t)};function je(t,e,r,n,i,o){var u=1&r,a=t.length,c=e.length;if(a!=c&&!(u&&c>a))return!1;var s=o.get(t),f=o.get(e);if(s&&f)return s==e&&f==t;var l=-1,h=!0,p=2&r?new ge:void 0;for(o.set(t,e),o.set(e,t);++l<a;){var d=t[l],y=e[l];if(n)var v=u?n(y,d,l,e,t,o):n(d,y,l,t,e,o);if(void 0!==v){if(v)continue;h=!1;break}if(p){if(!me(e,(function(t,e){if(!_e(p,e)&&(d===t||i(d,t,r,n,o)))return p.push(e)}))){h=!1;break}}else if(d!==y&&!i(d,y,r,n,o)){h=!1;break}}return o.delete(t),o.delete(e),h}var we=a.Uint8Array;function $e(t){var e=-1,r=Array(t.size);return t.forEach((function(t,n){r[++e]=[n,t]})),r}function Se(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r}var Oe=c?c.prototype:void 0,xe=Oe?Oe.valueOf:void 0;var Me=Object.prototype.propertyIsEnumerable,De=Object.getOwnPropertySymbols,Pe=De?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var r=-1,n=null==t?0:t.length,i=0,o=[];++r<n;){var u=t[r];e(u,r,t)&&(o[i++]=u)}return o}(De(t),(function(e){return Me.call(t,e)})))}:function(){return[]},Fe=Pe;function ke(t){return function(t,e,r){var n=e(t);return i(t)?n:function(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}(n,r(t))}(t,he,Fe)}var Ae=Object.prototype.hasOwnProperty;var ze=H(a,"DataView"),Ee=H(a,"Promise"),He=H(a,"Set"),Te=H(a,"WeakMap"),Ne="[object Map]",Ie="[object Promise]",Ye="[object Set]",Le="[object WeakMap]",Ce="[object DataView]",Je=M(ze),Ue=M(W),We=M(Ee),Be=M(He),Ve=M(Te),qe=y;(ze&&qe(new ze(new ArrayBuffer(1)))!=Ce||W&&qe(new W)!=Ne||Ee&&qe(Ee.resolve())!=Ie||He&&qe(new He)!=Ye||Te&&qe(new Te)!=Le)&&(qe=function(t){var e=y(t),r="[object Object]"==e?t.constructor:void 0,n=r?M(r):"";if(n)switch(n){case Je:return Ce;case Ue:return Ne;case We:return Ie;case Be:return Ye;case Ve:return Le}return e});var Re=qe,Ze="[object Arguments]",Ge="[object Array]",Ke="[object Object]",Qe=Object.prototype.hasOwnProperty;function Xe(t,e,r,n,o,u){var a=i(t),c=i(e),s=a?Ge:Re(t),f=c?Ge:Re(e),l=(s=s==Ze?Ke:s)==Ke,h=(f=f==Ze?Ke:f)==Ke,p=s==f;if(p&&Vt(t)){if(!Vt(e))return!1;a=!0,l=!1}if(p&&!l)return u||(u=new be),a||ne(t)?je(t,e,r,n,o,u):function(t,e,r,n,i,o,u){switch(r){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!o(new we(t),new we(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return L(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var a=$e;case"[object Set]":var c=1&n;if(a||(a=Se),t.size!=e.size&&!c)return!1;var s=u.get(t);if(s)return s==e;n|=2,u.set(t,e);var f=je(a(t),a(e),n,i,o,u);return u.delete(t),f;case"[object Symbol]":if(xe)return xe.call(t)==xe.call(e)}return!1}(t,e,s,r,n,o,u);if(!(1&r)){var d=l&&Qe.call(t,"__wrapped__"),y=h&&Qe.call(e,"__wrapped__");if(d||y){var v=d?t.value():t,b=y?e.value():e;return u||(u=new be),o(v,b,r,n,u)}}return!!p&&(u||(u=new be),function(t,e,r,n,i,o){var u=1&r,a=ke(t),c=a.length;if(c!=ke(e).length&&!u)return!1;for(var s=c;s--;){var f=a[s];if(!(u?f in e:Ae.call(e,f)))return!1}var l=o.get(t),h=o.get(e);if(l&&h)return l==e&&h==t;var p=!0;o.set(t,e),o.set(e,t);for(var d=u;++s<c;){var y=t[f=a[s]],v=e[f];if(n)var b=u?n(v,y,f,e,t,o):n(y,v,f,t,e,o);if(!(void 0===b?y===v||i(y,v,r,n,o):b)){p=!1;break}d||(d="constructor"==f)}if(p&&!d){var g=t.constructor,m=e.constructor;g==m||!("constructor"in t)||!("constructor"in e)||"function"==typeof g&&g instanceof g&&"function"==typeof m&&m instanceof m||(p=!1)}return o.delete(t),o.delete(e),p}(t,e,r,n,o,u))}function tr(t,e,r,n,i){return t===e||(null==t||null==e||!v(t)&&!v(e)?t!=t&&e!=e:Xe(t,e,r,n,tr,i))}function er(t){return t==t&&!j(t)}function rr(t,e){return function(r){return null!=r&&(r[t]===e&&(void 0!==e||t in Object(r)))}}function nr(t){var e=function(t){for(var e=he(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,er(i)]}return e}(t);return 1==e.length&&e[0][2]?rr(e[0][0],e[0][1]):function(r){return r===t||function(t,e,r,n){var i=r.length,o=i,u=!n;if(null==t)return!o;for(t=Object(t);i--;){var a=r[i];if(u&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++i<o;){var c=(a=r[i])[0],s=t[c],f=a[1];if(u&&a[2]){if(void 0===s&&!(c in t))return!1}else{var l=new be;if(n)var h=n(s,f,c,t,e,l);if(!(void 0===h?tr(f,s,3,n,l):h))return!1}}return!0}(r,t,e)}}function ir(t,e){return null!=t&&e in Object(t)}function or(t,e){return null!=t&&function(t,e,r){for(var n=-1,o=(e=ot(e,t)).length,u=!1;++n<o;){var a=ut(e[n]);if(!(u=null!=t&&r(t,a)))break;t=t[a]}return u||++n!=o?u:!!(o=null==t?0:t.length)&&Zt(o)&&Rt(a,o)&&(i(t)||Jt(t))}(t,e,ir)}function ur(t){return function(e){return null==e?void 0:e[t]}}function ar(t){return _(t)?ur(ut(t)):function(t){return function(e){return at(e,t)}}(t)}function cr(t){return"function"==typeof t?t:null==t?ye:"object"==typeof t?i(t)?function(t,e){return _(t)&&er(e)?rr(ut(t),e):function(r){var n=ct(r,t);return void 0===n&&n===e?or(r,t):tr(e,n,3)}}(t[0],t[1]):nr(t):ar(t)}function sr(t){var e=St(t),r=e%1;return e==e?r?e-r:e:0}var fr=Math.max;var lr,hr=(lr=function(t,e,r){var n=null==t?0:t.length;if(!n)return-1;var i=null==r?0:sr(r);return i<0&&(i=fr(n+i,0)),function(t,e,r,n){for(var i=t.length,o=r+(n?1:-1);n?o--:++o<i;)if(e(t[o],o,t))return o;return-1}(t,cr(e),i)},function(t,e,r){var n=Object(t);if(!le(t)){var i=cr(e);t=he(t),e=function(t){return i(n[t],t,n)}}var o=lr(t,e,r);return o>-1?n[i?t[o]:o]:void 0}),pr=hr;var dr=ur("length"),yr=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var vr="\\ud800-\\udfff",br="["+vr+"]",gr="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",mr="\\ud83c[\\udffb-\\udfff]",_r="[^"+vr+"]",jr="(?:\\ud83c[\\udde6-\\uddff]){2}",wr="[\\ud800-\\udbff][\\udc00-\\udfff]",$r="(?:"+gr+"|"+mr+")"+"?",Sr="[\\ufe0e\\ufe0f]?",Or=Sr+$r+("(?:\\u200d(?:"+[_r,jr,wr].join("|")+")"+Sr+$r+")*"),xr="(?:"+[_r+gr+"?",gr,jr,wr,br].join("|")+")",Mr=RegExp(mr+"(?="+mr+")|"+xr+Or,"g");function Dr(t){return function(t){return yr.test(t)}(t)?function(t){for(var e=Mr.lastIndex=0;Mr.test(t);)++e;return e}(t):dr(t)}function Pr(t){if(null==t)return 0;if(le(t))return"string"==typeof(e=t)||!i(e)&&v(e)&&"[object String]"==y(e)?Dr(t):t.length;var e,r=Re(t);return"[object Map]"==r||"[object Set]"==r?t.size:fe(t).length}function Fr(t){return"[object Array]"===Object.prototype.toString.call(t)}function kr(t){return!!function(t){return"[object Undefined]"===Object.prototype.toString.call(t)}(t)||(!!function(t){return"[object Null]"===Object.prototype.toString.call(t)}(t)||(!!function(t){if(pt(t)){for(let e in t)return!1;return!0}return!1}(t)||(!!function(t){return!(!st(t)||""!==t)}(t)||(!!function(t){return!!Fr(t)&&0===t.length}(t)||!!lt(t)))))}function Ar(t){return!!Fr(t)&&(0!==t.length&&(1!==t.length||!kr(t[0])))}function zr(t){return!!ht(t)&&(t=Ot(t),"number"==typeof(e=t)&&e==sr(e));var e}var Er=a.isFinite,Hr=Math.min;var Tr=function(t){var e=Math[t];return function(t,r){if(t=wt(t),(r=null==r?0:Hr(sr(r),292))&&Er(t)){var n=(it(t)+"e").split("e");return+((n=(it(e(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return e(t)}}("round"),Nr=Tr;function Ir(t){if(!ht(t))return 0;t=Ot(t);let e=Nr(t);return"0"===String(e)?0:e}function Yr(t){let e,r=Object.prototype.toString.call(t);if(e="[object Promise]"===r,e)return!0;if("[object Function]"!==r)return!1;try{e="function"!=typeof t.subscribe&&"function"==typeof t.then}catch(t){}return e}var Lr={exports:{}};!function(t){t.exports=function(){var t=1e3,e=6e4,r=36e5,n="millisecond",i="second",o="minute",u="hour",a="day",c="week",s="month",f="quarter",l="year",h="date",p="Invalid Date",d=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,v={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(t){var e=["th","st","nd","rd"],r=t%100;return"["+t+(e[(r-20)%10]||e[r]||e[0])+"]"}},b=function(t,e,r){var n=String(t);return!n||n.length>=e?t:""+Array(e+1-n.length).join(r)+t},g={s:b,z:function(t){var e=-t.utcOffset(),r=Math.abs(e),n=Math.floor(r/60),i=r%60;return(e<=0?"+":"-")+b(n,2,"0")+":"+b(i,2,"0")},m:function t(e,r){if(e.date()<r.date())return-t(r,e);var n=12*(r.year()-e.year())+(r.month()-e.month()),i=e.clone().add(n,s),o=r-i<0,u=e.clone().add(n+(o?-1:1),s);return+(-(n+(r-i)/(o?i-u:u-i))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:s,y:l,w:c,d:a,D:h,h:u,m:o,s:i,ms:n,Q:f}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},m="en",_={};_[m]=v;var j="$isDayjsObject",w=function(t){return t instanceof x||!(!t||!t[j])},$=function t(e,r,n){var i;if(!e)return m;if("string"==typeof e){var o=e.toLowerCase();_[o]&&(i=o),r&&(_[o]=r,i=o);var u=e.split("-");if(!i&&u.length>1)return t(u[0])}else{var a=e.name;_[a]=e,i=a}return!n&&i&&(m=i),i||!n&&m},S=function(t,e){if(w(t))return t.clone();var r="object"==typeof e?e:{};return r.date=t,r.args=arguments,new x(r)},O=g;O.l=$,O.i=w,O.w=function(t,e){return S(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var x=function(){function v(t){this.$L=$(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[j]=!0}var b=v.prototype;return b.parse=function(t){this.$d=function(t){var e=t.date,r=t.utc;if(null===e)return new Date(NaN);if(O.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var n=e.match(d);if(n){var i=n[2]-1||0,o=(n[7]||"0").substring(0,3);return r?new Date(Date.UTC(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)):new Date(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)}}return new Date(e)}(t),this.init()},b.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},b.$utils=function(){return O},b.isValid=function(){return!(this.$d.toString()===p)},b.isSame=function(t,e){var r=S(t);return this.startOf(e)<=r&&r<=this.endOf(e)},b.isAfter=function(t,e){return S(t)<this.startOf(e)},b.isBefore=function(t,e){return this.endOf(e)<S(t)},b.$g=function(t,e,r){return O.u(t)?this[e]:this.set(r,t)},b.unix=function(){return Math.floor(this.valueOf()/1e3)},b.valueOf=function(){return this.$d.getTime()},b.startOf=function(t,e){var r=this,n=!!O.u(e)||e,f=O.p(t),p=function(t,e){var i=O.w(r.$u?Date.UTC(r.$y,e,t):new Date(r.$y,e,t),r);return n?i:i.endOf(a)},d=function(t,e){return O.w(r.toDate()[t].apply(r.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(e)),r)},y=this.$W,v=this.$M,b=this.$D,g="set"+(this.$u?"UTC":"");switch(f){case l:return n?p(1,0):p(31,11);case s:return n?p(1,v):p(0,v+1);case c:var m=this.$locale().weekStart||0,_=(y<m?y+7:y)-m;return p(n?b-_:b+(6-_),v);case a:case h:return d(g+"Hours",0);case u:return d(g+"Minutes",1);case o:return d(g+"Seconds",2);case i:return d(g+"Milliseconds",3);default:return this.clone()}},b.endOf=function(t){return this.startOf(t,!1)},b.$set=function(t,e){var r,c=O.p(t),f="set"+(this.$u?"UTC":""),p=(r={},r[a]=f+"Date",r[h]=f+"Date",r[s]=f+"Month",r[l]=f+"FullYear",r[u]=f+"Hours",r[o]=f+"Minutes",r[i]=f+"Seconds",r[n]=f+"Milliseconds",r)[c],d=c===a?this.$D+(e-this.$W):e;if(c===s||c===l){var y=this.clone().set(h,1);y.$d[p](d),y.init(),this.$d=y.set(h,Math.min(this.$D,y.daysInMonth())).$d}else p&&this.$d[p](d);return this.init(),this},b.set=function(t,e){return this.clone().$set(t,e)},b.get=function(t){return this[O.p(t)]()},b.add=function(n,f){var h,p=this;n=Number(n);var d=O.p(f),y=function(t){var e=S(p);return O.w(e.date(e.date()+Math.round(t*n)),p)};if(d===s)return this.set(s,this.$M+n);if(d===l)return this.set(l,this.$y+n);if(d===a)return y(1);if(d===c)return y(7);var v=(h={},h[o]=e,h[u]=r,h[i]=t,h)[d]||1,b=this.$d.getTime()+n*v;return O.w(b,this)},b.subtract=function(t,e){return this.add(-1*t,e)},b.format=function(t){var e=this,r=this.$locale();if(!this.isValid())return r.invalidDate||p;var n=t||"YYYY-MM-DDTHH:mm:ssZ",i=O.z(this),o=this.$H,u=this.$m,a=this.$M,c=r.weekdays,s=r.months,f=r.meridiem,l=function(t,r,i,o){return t&&(t[r]||t(e,n))||i[r].slice(0,o)},h=function(t){return O.s(o%12||12,t,"0")},d=f||function(t,e,r){var n=t<12?"AM":"PM";return r?n.toLowerCase():n};return n.replace(y,(function(t,n){return n||function(t){switch(t){case"YY":return String(e.$y).slice(-2);case"YYYY":return O.s(e.$y,4,"0");case"M":return a+1;case"MM":return O.s(a+1,2,"0");case"MMM":return l(r.monthsShort,a,s,3);case"MMMM":return l(s,a);case"D":return e.$D;case"DD":return O.s(e.$D,2,"0");case"d":return String(e.$W);case"dd":return l(r.weekdaysMin,e.$W,c,2);case"ddd":return l(r.weekdaysShort,e.$W,c,3);case"dddd":return c[e.$W];case"H":return String(o);case"HH":return O.s(o,2,"0");case"h":return h(1);case"hh":return h(2);case"a":return d(o,u,!0);case"A":return d(o,u,!1);case"m":return String(u);case"mm":return O.s(u,2,"0");case"s":return String(e.$s);case"ss":return O.s(e.$s,2,"0");case"SSS":return O.s(e.$ms,3,"0");case"Z":return i}return null}(t)||i.replace(":","")}))},b.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},b.diff=function(n,h,p){var d,y=this,v=O.p(h),b=S(n),g=(b.utcOffset()-this.utcOffset())*e,m=this-b,_=function(){return O.m(y,b)};switch(v){case l:d=_()/12;break;case s:d=_();break;case f:d=_()/3;break;case c:d=(m-g)/6048e5;break;case a:d=(m-g)/864e5;break;case u:d=m/r;break;case o:d=m/e;break;case i:d=m/t;break;default:d=m}return p?d:O.a(d)},b.daysInMonth=function(){return this.endOf(s).$D},b.$locale=function(){return _[this.$L]},b.locale=function(t,e){if(!t)return this.$L;var r=this.clone(),n=$(t,e,!0);return n&&(r.$L=n),r},b.clone=function(){return O.w(this.$d,this)},b.toDate=function(){return new Date(this.valueOf())},b.toJSON=function(){return this.isValid()?this.toISOString():null},b.toISOString=function(){return this.$d.toISOString()},b.toString=function(){return this.$d.toUTCString()},v}(),M=x.prototype;return S.prototype=M,[["$ms",n],["$s",i],["$m",o],["$H",u],["$W",a],["$M",s],["$y",l],["$D",h]].forEach((function(t){M[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),S.extend=function(t,e){return t.$i||(t(e,x,S),t.$i=!0),S},S.locale=$,S.isDayjs=w,S.unix=function(t){return S(1e3*t)},S.en=_[m],S.Ls=_,S.p={},S}()}(Lr);var Cr=xt(Lr.exports);function Jr(){if(!function(t){let e=Object.prototype.toString.call(t);return"[object Function]"===e||"[object AsyncFunction]"===e}(Cr))throw new Error("invalid dayjs");return Cr().format("YYYYMMDDHHmmss")}function Ur(t){if(!zr(t))return!1;return Ir(t)>0}let Wr="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),Br=Wr.length;function Vr(t,e={}){let r=ct(e,"fs");if(!r.existsSync(t))return!1;let n=r.lstatSync(t);return!n.isFile()&&!n.isSymbolicLink()}function qr(r,n=1){return function(t,e=1,r={}){let n=1,i=ct(r,"path"),o=ct(r,"fs");if(!Vr(t,{fs:o}))throw new Error(`fd[${t}] is not a folder`);return function t(r){let u=[];return Vr(r,{fs:o})?(ve(o.readdirSync(r),(function(a){let c=i.resolve(r,a),s=null;try{s=o.statSync(c)}catch(t){}s&&s.isDirectory()?(u.push({isFolder:!0,level:n,path:c,name:i.basename(c)}),n+=1,(n<=e||null===e)&&(u=u.concat(t(c))),n-=1):u.push({isFolder:!1,level:n,path:c,name:i.basename(c)})})),u):u}(t)}(r,n,{path:e,fs:t})}function Rr(e){return function(t,e={}){let r=ct(e,"fs");return!!r.existsSync(t)&&!r.lstatSync(t).isDirectory()&&!r.lstatSync(t).isSymbolicLink()}(e,{fs:t})}function Zr(t=10){ht(t)||(t=10);let e=function(){let t,e,r=new Promise((function(){t=arguments[0],e=arguments[1]}));return r.resolve=t,r.reject=e,r}();return setTimeout((function(){e.resolve()}),t),e}async function Gr(e,r={}){return await async function(t,e={}){let r=ct(e,"numRetry");Ur(r)||(r=5),r=Ir(r);let n=ct(e,"fs",null);if(!n.existsSync(t))return"folder does not exist: "+t;if(!Vr(t,{fs:n}))return Promise.reject("input path is not a folder: "+t);for(let e=0;e<r;e++)try{n.rmSync(t,{recursive:!0,force:!0});break}catch(t){if("EBUSY"!==t.code)return Promise.reject(t);await Zr(300)}return"done: "+t}(e,{fs:t,...r})}let Kr=process.cwd();async function Qr(n=700,i=400,o=3,u="",a={}){if(!ht(n))return Promise.reject("width is not a number");if((n=Ot(n))<=0)return Promise.reject("width <= 0");if(!ht(i))return Promise.reject("height is not a number");if((i=Ot(i))<=0)return Promise.reject("height <= 0");if(!ht(o))return Promise.reject("scale is not a number");if((o=Ot(o))<=0)return Promise.reject("scale <= 0");if(!ft(u))return Promise.reject("html is not an effective string");let c=u,s=ct(a,"modeHeadless");!0!==s&&!1!==s&&"new"!==s&&"shell"!==s&&(s="new");let f=ct(a,"scriptsHead");Ar(f)||(f=[]);let l="";ve(f,(t=>{l+=`<script src="${t}"><\/script>\n`}));let h=ct(a,"execJsHead");ft(h)&&(h=[h]),Ar(h)||(h=[]);let p="";ve(h,(t=>{p+=`<script>${t}<\/script>\n\n`}));let d=ct(a,"execJsPost");ft(d)&&(d=[d]),Ar(d)||(d=[]);let y="";ve(d,(t=>{y+=`<script>${t}<\/script>\n\n`}));let v=ct(a,"executablePath",""),b=ct(a,"executableFolder","");if(ft(b)&&!ft(v)){let t=qr(b,null),e=pr(t,(t=>"chrome.exe"===t.name));if(!dt(e))throw new Error(`can not find chrome.exe in executableFolder[${b}]`);v=e.path}let g=`${Jr()}-${function(t=32){let e=[];t=Ur(t)?Ir(t):32;for(let r=0;r<t;r++)e[r]=Wr[0|Math.random()*Br];return e.join("")}()}`,m=async t=>{let e=[],n=`./_puppeteer_profile_${g}`,i={headless:s,slowMo:20,protocolTimeout:6e4,dumpio:!0,userDataDir:n,args:["--no-sandbox","--incognito","--disable-gpu","--disable-software-rasterizer","--disable-setuid-sandbox","--disable-dev-shm-usage","--disable-sync","--disable-extensions","--disable-default-apps","--disable-features=VizDisplayCompositor","--metrics-recording-only","--mute-audio","--no-first-run","--safebrowsing-disable-auto-update"]};ft(v)&&(i.executablePath=v);let o=null,u=null,a=null;try{o=await r.launch(i),u=o.process(),a=ct(u,"pid","")}catch(t){e.push({anchor:"puppeteer.launch(puppeteerOpt)",err:t})}if(null!==o)try{let e=t(o);Yr(e)&&(e=await e)}catch(t){e.push({anchor:"fun(browser)",err:t})}if(null!==o)try{await o.close()}catch(t){e.push({anchor:"browser.close()",err:t})}if(zr(c=a)&&Ir(c)>=0)try{zt(a,"SIGKILL")}catch(t){}var c;try{await Gr(n)}catch(t){e.push({anchor:"fsDeleteFolderSafe(fd)",err:t})}return Pr(e)>0?{state:"error",msg:e}:{state:"success",msg:""}};return await(async()=>{let r=[],u=[],a="",s=null,f=null,h=null;if(s=await(async r=>{let n=[],i=`./whpic-${g}.png`,o=e.resolve(Kr,i),u=`./whweb-${g}.html`,a=e.resolve(Kr,u),s='\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="UTF-8">\n  <title>highcharts to png</title>\n\n  <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"><\/script>\n\n  <script src="https://cdn.jsdelivr.net/npm/wsemi/dist/wsemi.umd.js"><\/script>\n  <script>\n      let w = wsemi\n  <\/script>\n\n  {cScriptsHead}\n\n  {cExecJsHead}\n\n</head>\n<body style="padding:0; margin:0;">\n\n    <div id="pl">\n        {cHtml}\n    </div>\n\n    {cExecJsPost}\n\n</body>\n</html>\n';s=s.replace("{cHtml}",c),s=s.replace("{cScriptsHead}",l),s=s.replace("{cExecJsHead}",p),s=s.replace("{cExecJsPost}",y);try{t.writeFileSync(a,s,"utf8")}catch(t){n.push({anchor:"fs.writeFileSync(fpHtml, g, 'utf8')",err:t})}if(0===Pr(n))try{let t=r(a,o);Yr(t)&&(t=await t)}catch(t){n.push({anchor:"fun(fpHtml, fpOut)",err:t})}if(Rr(a))try{t.unlinkSync(a)}catch(t){}if(Rr(o))try{t.unlinkSync(o)}catch(t){}return Pr(n)>0?{state:"error",msg:n}:{state:"success",msg:""}})((async(e,r)=>{if(f=await m((async u=>{h=await(async(t,e)=>{let r=[],n=null;try{n=await t.newPage(),n.setDefaultNavigationTimeout(6e4)}catch(t){r.push({anchor:"browser.newPage()",err:t})}if(null!==n)try{let t=e(n);Yr(t)&&(t=await t)}catch(t){r.push({anchor:"fun(page)",err:t})}if(null!==n)try{await n.close()}catch(t){r.push({anchor:"page.close()",err:t})}return Pr(r)>0?{state:"error",msg:r}:{state:"success",msg:""}})(u,(async t=>{let u={x:0,y:0,width:Number(n),height:Number(i),deviceScaleFactor:Number(o)};await t.goto(e,{waitUntil:["domcontentloaded","networkidle2"],timeout:6e4}),await t.setViewport(u),await t.screenshot({path:r,timeout:6e4})})).catch((e=>{t.writeFileSync(`./_err_${g}_supplyPage.json`,e.message,"utf8")}))})).catch((e=>{t.writeFileSync(`./_err_${g}_supplyBrowser.json`,e.message,"utf8")})),"error"!==ct(f,"state","")){if(Rr(r)){try{a=t.readFileSync(r,{encoding:"base64"})}catch(t){return void u.push({anchor:"fs.readFileSync(fpOut, { encoding: 'base64' })",err:t})}return null}u.push({anchor:"fsIsFile(fpOut)",err:new Error(`no file[${r}]`)})}})).catch((e=>{t.writeFileSync(`./_err_${g}_supplyHtml.json`,e.message,"utf8")})),"error"===ct(s,"state","")&&(r=[...r,...s.msg]),"error"===ct(f,"state","")&&(r=[...r,...f.msg]),"error"===ct(h,"state","")&&(r=[...r,...h.msg]),Pr(u)>0&&(r=[...r,...u]),Pr(r)>0){{let e="";ve(r,(t=>{let r=ct(t,"err.message","");e+=r+"\n"})),t.writeFileSync(`./_err_${g}_earrs.json`,e,"utf8")}let e=r[0],n=`${e.err.message} in ${e.anchor}`;return Promise.reject(n)}return ft(a)?a:Promise.reject("b64 is not an effective string")})().finally((()=>{let e=`./whweb-${g}.html`;Rr(e)&&t.writeFileSync(`./_err_${g}_fsIsFile_fnHtml.json`,`html檔[${e}]未正常刪除`,"utf8");let r=`./_puppeteer_profile_${g}`;Vr(r,{fs:t})&&t.writeFileSync(`./_err_${g}_fsIsFolder_profile.json`,`profile資料夾[${r}]未正常刪除`,"utf8");let n=`./whpic-${g}.png`;Rr(n)&&t.writeFileSync(`./_err_${g}_fsIsFile_fnPng.json`,`png檔[${n}]未正常刪除`,"utf8")}))}let Xr=t.readFileSync("./node_modules/highcharts/highcharts.js","utf8"),tn=t.readFileSync("./node_modules/highcharts/highcharts-more.js","utf8"),en=t.readFileSync("./node_modules/highcharts/modules/stock.js","utf8"),rn=t.readFileSync("./node_modules/highcharts/modules/annotations.js","utf8"),nn=t.readFileSync("./node_modules/highcharts/modules/heatmap.js","utf8"),on=t.readFileSync("./node_modules/highcharts/modules/boost.js","utf8"),un=t.readFileSync("./node_modules/highcharts/modules/boost-canvas.js","utf8");return async function(t=700,e=400,r=3,n={},i={}){if(!ht(t))return Promise.reject("width is not a number");if((t=Ot(t))<=0)return Promise.reject("width <= 0");if(!ht(e))return Promise.reject("height is not a number");if((e=Ot(e))<=0)return Promise.reject("height <= 0");if(!ht(r))return Promise.reject("scale is not a number");if((r=Ot(r))<=0)return Promise.reject("scale <= 0");if(!dt(n)&&!ft(n))return Promise.reject("opt is not an effective object or string");let o=[Xr,tn,en,rn,nn,on,un],u="";if(ft(n))u=n;else{u=`let opt=${JSON.stringify(n)};`}let a=`\n\n        ${u}\n\n        if(_.isObject(opt)){\n\n            //強制關閉動畫避免過慢顯示無法截到數據圖\n            _.set(opt, 'chart.animation', false)\n            _.set(opt, 'plotOptions.series.animation', false)\n            // console.log('opt', opt)\n        \n            //plot\n            Highcharts.chart('hc', opt)\n\n        }\n        else{\n            console.log('invalid opt')\n        }\n\n    `;a=[a];let c=`\n\n        <div id="hc" style="width:${t}px; height:${e}px;"></div>\n\n    `,s=ct(i,"execJsHead","");ft(s)&&(s=[s]),s=[...s,...o],i.execJsHead=s;let f=ct(i,"execJsPost","");return ft(f)&&(f=[f]),f=[...f,...a],i.execJsPost=f,await Qr(t,e,r,c,i)}}));
//# sourceMappingURL=w-hc-2-png.umd.js.map
