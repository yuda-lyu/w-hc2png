/*!
 * w-hc-2-png v1.0.40
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("fs"),require("path"),require("puppeteer"),require("tree-kill"),require("stream"),require("archiver"),require("archiver-zip-encrypted"),require("unzipper")):"function"==typeof define&&define.amd?define(["fs","path","puppeteer","tree-kill","stream","archiver","archiver-zip-encrypted","unzipper"],t):(e="undefined"!=typeof globalThis?globalThis:e||self)["w-hc-2-png"]=t(e.fs,e.path,e.puppeteer,e["tree-kill"],e.stream,e.archiver,e["archiver-zip-encrypted"],e.unzipper)}(this,function(e,t,r,n,i,o,s,u){"use strict";var c=Array.isArray,a="object"==typeof global&&global&&global.Object===Object&&global,f="object"==typeof self&&self&&self.Object===Object&&self,l=a||f||Function("return this")(),h=l.Symbol,p=Object.prototype,d=p.hasOwnProperty,y=p.toString,v=h?h.toStringTag:void 0;var m=Object.prototype.toString;var b=h?h.toStringTag:void 0;function g(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":b&&b in Object(e)?function(e){var t=d.call(e,v),r=e[v];try{e[v]=void 0;var n=!0}catch(e){}var i=y.call(e);return n&&(t?e[v]=r:delete e[v]),i}(e):function(e){return m.call(e)}(e)}function j(e){return null!=e&&"object"==typeof e}function w(e){return"symbol"==typeof e||j(e)&&"[object Symbol]"==g(e)}var _=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,$=/^\w*$/;function S(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function x(e){if(!S(e))return!1;var t=g(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}var O,P=l["__core-js_shared__"],M=(O=/[^.]+$/.exec(P&&P.keys&&P.keys.IE_PROTO||""))?"Symbol(src)_1."+O:"";var D=Function.prototype.toString;function k(e){if(null!=e){try{return D.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var F=/^\[object .+?Constructor\]$/,z=Function.prototype,A=Object.prototype,T=z.toString,H=A.hasOwnProperty,E=RegExp("^"+T.call(H).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function N(e){return!(!S(e)||(t=e,M&&M in t))&&(x(e)?E:F).test(k(e));var t}function C(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return N(r)?r:void 0}var I=C(Object,"create");var L=Object.prototype.hasOwnProperty;var R=Object.prototype.hasOwnProperty;function Y(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function W(e,t){return e===t||e!=e&&t!=t}function J(e,t){for(var r=e.length;r--;)if(W(e[r][0],t))return r;return-1}Y.prototype.clear=function(){this.__data__=I?I(null):{},this.size=0},Y.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Y.prototype.get=function(e){var t=this.__data__;if(I){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return L.call(t,e)?t[e]:void 0},Y.prototype.has=function(e){var t=this.__data__;return I?void 0!==t[e]:R.call(t,e)},Y.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=I&&void 0===t?"__lodash_hash_undefined__":t,this};var U=Array.prototype.splice;function q(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}q.prototype.clear=function(){this.__data__=[],this.size=0},q.prototype.delete=function(e){var t=this.__data__,r=J(t,e);return!(r<0)&&(r==t.length-1?t.pop():U.call(t,r,1),--this.size,!0)},q.prototype.get=function(e){var t=this.__data__,r=J(t,e);return r<0?void 0:t[r][1]},q.prototype.has=function(e){return J(this.__data__,e)>-1},q.prototype.set=function(e,t){var r=this.__data__,n=J(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};var B=C(l,"Map");function V(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function Z(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Z.prototype.clear=function(){this.size=0,this.__data__={hash:new Y,map:new(B||q),string:new Y}},Z.prototype.delete=function(e){var t=V(this,e).delete(e);return this.size-=t?1:0,t},Z.prototype.get=function(e){return V(this,e).get(e)},Z.prototype.has=function(e){return V(this,e).has(e)},Z.prototype.set=function(e,t){var r=V(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function G(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var s=e.apply(this,n);return r.cache=o.set(i,s)||o,s};return r.cache=new(G.Cache||Z),r}G.Cache=Z;var K,Q,X,ee=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,te=/\\(\\)?/g,re=(K=function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(ee,function(e,r,n,i){t.push(n?i.replace(te,"$1"):r||e)}),t},Q=G(K,function(e){return 500===X.size&&X.clear(),e}),X=Q.cache,Q),ne=re;function ie(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}var oe=h?h.prototype:void 0,se=oe?oe.toString:void 0;function ue(e){if("string"==typeof e)return e;if(c(e))return ie(e,ue)+"";if(w(e))return se?se.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function ce(e){return null==e?"":ue(e)}function ae(e,t){return c(e)?e:function(e,t){if(c(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!w(e))||$.test(e)||!_.test(e)||null!=t&&e in Object(t)}(e,t)?[e]:ne(ce(e))}function fe(e){if("string"==typeof e||w(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function le(e,t,r){var n=null==e?void 0:function(e,t){for(var r=0,n=(t=ae(t,e)).length;null!=e&&r<n;)e=e[fe(t[r++])];return r&&r==n?e:void 0}(e,t);return void 0===n?r:n}function he(e){return"[object String]"===Object.prototype.toString.call(e)}function pe(e){return!(!he(e)||""===e)}function de(e){return e!=e}function ye(e){let t=!1;if(pe(e))t=!isNaN(Number(e));else if(function(e){return"[object Number]"===Object.prototype.toString.call(e)}(e)){if(de(e))return!1;t=!0}return t}function ve(e){return"[object Object]"===Object.prototype.toString.call(e)}var me=/\s/;var be=/^\s+/;function ge(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&me.test(e.charAt(t)););return t}(e)+1).replace(be,""):e}var je=/^[-+]0x[0-9a-f]+$/i,we=/^0b[01]+$/i,_e=/^0o[0-7]+$/i,$e=parseInt;function Se(e){if("number"==typeof e)return e;if(w(e))return NaN;if(S(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=S(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=ge(e);var r=we.test(e);return r||_e.test(e)?$e(e.slice(2),r?2:8):je.test(e)?NaN:+e}var xe=1/0;function Oe(e){return e?(e=Se(e))===xe||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function Pe(e){if(!ye(e))return 0;return Oe(e)}function Me(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}var De,ke=function(e,t,r){for(var n=-1,i=Object(e),o=r(e),s=o.length;s--;){var u=o[De?s:++n];if(!1===t(i[u],u,i))break}return e},Fe=ke;function ze(e){return j(e)&&"[object Arguments]"==g(e)}var Ae=Object.prototype,Te=Ae.hasOwnProperty,He=Ae.propertyIsEnumerable,Ee=ze(function(){return arguments}())?ze:function(e){return j(e)&&Te.call(e,"callee")&&!He.call(e,"callee")},Ne=Ee;var Ce="object"==typeof exports&&exports&&!exports.nodeType&&exports,Ie=Ce&&"object"==typeof module&&module&&!module.nodeType&&module,Le=Ie&&Ie.exports===Ce?l.Buffer:void 0,Re=(Le?Le.isBuffer:void 0)||function(){return!1},Ye=/^(?:0|[1-9]\d*)$/;function We(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&Ye.test(e))&&e>-1&&e%1==0&&e<t}function Je(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}var Ue={};Ue["[object Float32Array]"]=Ue["[object Float64Array]"]=Ue["[object Int8Array]"]=Ue["[object Int16Array]"]=Ue["[object Int32Array]"]=Ue["[object Uint8Array]"]=Ue["[object Uint8ClampedArray]"]=Ue["[object Uint16Array]"]=Ue["[object Uint32Array]"]=!0,Ue["[object Arguments]"]=Ue["[object Array]"]=Ue["[object ArrayBuffer]"]=Ue["[object Boolean]"]=Ue["[object DataView]"]=Ue["[object Date]"]=Ue["[object Error]"]=Ue["[object Function]"]=Ue["[object Map]"]=Ue["[object Number]"]=Ue["[object Object]"]=Ue["[object RegExp]"]=Ue["[object Set]"]=Ue["[object String]"]=Ue["[object WeakMap]"]=!1;var qe="object"==typeof exports&&exports&&!exports.nodeType&&exports,Be=qe&&"object"==typeof module&&module&&!module.nodeType&&module,Ve=Be&&Be.exports===qe&&a.process,Ze=function(){try{var e=Be&&Be.require&&Be.require("util").types;return e||Ve&&Ve.binding&&Ve.binding("util")}catch(e){}}(),Ge=Ze&&Ze.isTypedArray,Ke=Ge?function(e){return function(t){return e(t)}}(Ge):function(e){return j(e)&&Je(e.length)&&!!Ue[g(e)]},Qe=Ke,Xe=Object.prototype.hasOwnProperty;function et(e,t){var r=c(e),n=!r&&Ne(e),i=!r&&!n&&Re(e),o=!r&&!n&&!i&&Qe(e),s=r||n||i||o,u=s?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],a=u.length;for(var f in e)!t&&!Xe.call(e,f)||s&&("length"==f||i&&("offset"==f||"parent"==f)||o&&("buffer"==f||"byteLength"==f||"byteOffset"==f)||We(f,a))||u.push(f);return u}var tt=Object.prototype;var rt=function(e,t){return function(r){return e(t(r))}}(Object.keys,Object),nt=rt,it=Object.prototype.hasOwnProperty;function ot(e){if(r=(t=e)&&t.constructor,t!==("function"==typeof r&&r.prototype||tt))return nt(e);var t,r,n=[];for(var i in Object(e))it.call(e,i)&&"constructor"!=i&&n.push(i);return n}function st(e){return null!=e&&Je(e.length)&&!x(e)}function ut(e){return st(e)?et(e):ot(e)}var ct=function(e,t){return function(r,n){if(null==r)return r;if(!st(r))return e(r,n);for(var i=r.length,o=t?i:-1,s=Object(r);(t?o--:++o<i)&&!1!==n(s[o],o,s););return r}}(function(e,t){return e&&Fe(e,t,ut)}),at=ct;function ft(e){return e}function lt(e,t){var r;return(c(e)?Me:at)(e,"function"==typeof(r=t)?r:ft)}var ht=C(l,"DataView"),pt=C(l,"Promise"),dt=C(l,"Set"),yt=C(l,"WeakMap"),vt="[object Map]",mt="[object Promise]",bt="[object Set]",gt="[object WeakMap]",jt="[object DataView]",wt=k(ht),_t=k(B),$t=k(pt),St=k(dt),xt=k(yt),Ot=g;(ht&&Ot(new ht(new ArrayBuffer(1)))!=jt||B&&Ot(new B)!=vt||pt&&Ot(pt.resolve())!=mt||dt&&Ot(new dt)!=bt||yt&&Ot(new yt)!=gt)&&(Ot=function(e){var t=g(e),r="[object Object]"==t?e.constructor:void 0,n=r?k(r):"";if(n)switch(n){case wt:return jt;case _t:return vt;case $t:return mt;case St:return bt;case xt:return gt}return t});var Pt=Ot;var Mt,Dt=(Mt="length",function(e){return null==e?void 0:e[Mt]}),kt=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var Ft="\\ud800-\\udfff",zt="["+Ft+"]",At="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Tt="\\ud83c[\\udffb-\\udfff]",Ht="[^"+Ft+"]",Et="(?:\\ud83c[\\udde6-\\uddff]){2}",Nt="[\\ud800-\\udbff][\\udc00-\\udfff]",Ct="(?:"+At+"|"+Tt+")"+"?",It="[\\ufe0e\\ufe0f]?",Lt=It+Ct+("(?:\\u200d(?:"+[Ht,Et,Nt].join("|")+")"+It+Ct+")*"),Rt="(?:"+[Ht+At+"?",At,Et,Nt,zt].join("|")+")",Yt=RegExp(Tt+"(?="+Tt+")|"+Rt+Lt,"g");function Wt(e){return function(e){return kt.test(e)}(e)?function(e){for(var t=Yt.lastIndex=0;Yt.test(e);)++t;return t}(e):Dt(e)}function Jt(e){if(null==e)return 0;if(st(e))return"string"==typeof(t=e)||!c(t)&&j(t)&&"[object String]"==g(t)?Wt(e):e.length;var t,r=Pt(e);return"[object Map]"==r||"[object Set]"==r?e.size:ot(e).length}function Ut(e){return"[object Array]"===Object.prototype.toString.call(e)}function qt(e){return!!function(e){return"[object Undefined]"===Object.prototype.toString.call(e)}(e)||(!!function(e){return"[object Null]"===Object.prototype.toString.call(e)}(e)||(!!function(e){if(ve(e)){for(let t in e)return!1;return!0}return!1}(e)||(!!function(e){return!(!he(e)||""!==e)}(e)||(!!function(e){return!!Ut(e)&&0===e.length}(e)||!!de(e)))))}function Bt(e){return!!Ut(e)&&(0!==e.length&&(1!==e.length||!qt(e[0])))}function Vt(e){var t=Oe(e),r=t%1;return t==t?r?t-r:t:0}function Zt(e){return!!ye(e)&&(e=Pe(e),"number"==typeof(t=e)&&t==Vt(t));var t}var Gt=l.isFinite,Kt=Math.min;var Qt=function(e){var t=Math[e];return function(e,r){if(e=Se(e),(r=null==r?0:Kt(Vt(r),292))&&Gt(e)){var n=(ce(e)+"e").split("e");return+((n=(ce(t(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return t(e)}}("round"),Xt=Qt;function er(e){if(!ye(e))return 0;e=Pe(e);let t=Xt(e);return"0"===String(t)?0:t}function tr(e){if(!Zt(e))return!1;return er(e)>=0}function rr(e){let t,r=Object.prototype.toString.call(e);if(t="[object Promise]"===r,t)return!0;if("[object Function]"!==r)return!1;try{t="function"!=typeof e.subscribe&&"function"==typeof e.then}catch(e){}return t}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function nr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ir={exports:{}};!function(e){e.exports=function(){var e=1e3,t=6e4,r=36e5,n="millisecond",i="second",o="minute",s="hour",u="day",c="week",a="month",f="quarter",l="year",h="date",p="Invalid Date",d=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,v={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],r=e%100;return"["+e+(t[(r-20)%10]||t[r]||t[0])+"]"}},m=function(e,t,r){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(r)+e},b={s:m,z:function(e){var t=-e.utcOffset(),r=Math.abs(t),n=Math.floor(r/60),i=r%60;return(t<=0?"+":"-")+m(n,2,"0")+":"+m(i,2,"0")},m:function e(t,r){if(t.date()<r.date())return-e(r,t);var n=12*(r.year()-t.year())+(r.month()-t.month()),i=t.clone().add(n,a),o=r-i<0,s=t.clone().add(n+(o?-1:1),a);return+(-(n+(r-i)/(o?i-s:s-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:a,y:l,w:c,d:u,D:h,h:s,m:o,s:i,ms:n,Q:f}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},g="en",j={};j[g]=v;var w="$isDayjsObject",_=function(e){return e instanceof O||!(!e||!e[w])},$=function e(t,r,n){var i;if(!t)return g;if("string"==typeof t){var o=t.toLowerCase();j[o]&&(i=o),r&&(j[o]=r,i=o);var s=t.split("-");if(!i&&s.length>1)return e(s[0])}else{var u=t.name;j[u]=t,i=u}return!n&&i&&(g=i),i||!n&&g},S=function(e,t){if(_(e))return e.clone();var r="object"==typeof t?t:{};return r.date=e,r.args=arguments,new O(r)},x=b;x.l=$,x.i=_,x.w=function(e,t){return S(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var O=function(){function v(e){this.$L=$(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[w]=!0}var m=v.prototype;return m.parse=function(e){this.$d=function(e){var t=e.date,r=e.utc;if(null===t)return new Date(NaN);if(x.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var n=t.match(d);if(n){var i=n[2]-1||0,o=(n[7]||"0").substring(0,3);return r?new Date(Date.UTC(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)):new Date(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)}}return new Date(t)}(e),this.init()},m.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},m.$utils=function(){return x},m.isValid=function(){return!(this.$d.toString()===p)},m.isSame=function(e,t){var r=S(e);return this.startOf(t)<=r&&r<=this.endOf(t)},m.isAfter=function(e,t){return S(e)<this.startOf(t)},m.isBefore=function(e,t){return this.endOf(t)<S(e)},m.$g=function(e,t,r){return x.u(e)?this[t]:this.set(r,e)},m.unix=function(){return Math.floor(this.valueOf()/1e3)},m.valueOf=function(){return this.$d.getTime()},m.startOf=function(e,t){var r=this,n=!!x.u(t)||t,f=x.p(e),p=function(e,t){var i=x.w(r.$u?Date.UTC(r.$y,t,e):new Date(r.$y,t,e),r);return n?i:i.endOf(u)},d=function(e,t){return x.w(r.toDate()[e].apply(r.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(t)),r)},y=this.$W,v=this.$M,m=this.$D,b="set"+(this.$u?"UTC":"");switch(f){case l:return n?p(1,0):p(31,11);case a:return n?p(1,v):p(0,v+1);case c:var g=this.$locale().weekStart||0,j=(y<g?y+7:y)-g;return p(n?m-j:m+(6-j),v);case u:case h:return d(b+"Hours",0);case s:return d(b+"Minutes",1);case o:return d(b+"Seconds",2);case i:return d(b+"Milliseconds",3);default:return this.clone()}},m.endOf=function(e){return this.startOf(e,!1)},m.$set=function(e,t){var r,c=x.p(e),f="set"+(this.$u?"UTC":""),p=(r={},r[u]=f+"Date",r[h]=f+"Date",r[a]=f+"Month",r[l]=f+"FullYear",r[s]=f+"Hours",r[o]=f+"Minutes",r[i]=f+"Seconds",r[n]=f+"Milliseconds",r)[c],d=c===u?this.$D+(t-this.$W):t;if(c===a||c===l){var y=this.clone().set(h,1);y.$d[p](d),y.init(),this.$d=y.set(h,Math.min(this.$D,y.daysInMonth())).$d}else p&&this.$d[p](d);return this.init(),this},m.set=function(e,t){return this.clone().$set(e,t)},m.get=function(e){return this[x.p(e)]()},m.add=function(n,f){var h,p=this;n=Number(n);var d=x.p(f),y=function(e){var t=S(p);return x.w(t.date(t.date()+Math.round(e*n)),p)};if(d===a)return this.set(a,this.$M+n);if(d===l)return this.set(l,this.$y+n);if(d===u)return y(1);if(d===c)return y(7);var v=(h={},h[o]=t,h[s]=r,h[i]=e,h)[d]||1,m=this.$d.getTime()+n*v;return x.w(m,this)},m.subtract=function(e,t){return this.add(-1*e,t)},m.format=function(e){var t=this,r=this.$locale();if(!this.isValid())return r.invalidDate||p;var n=e||"YYYY-MM-DDTHH:mm:ssZ",i=x.z(this),o=this.$H,s=this.$m,u=this.$M,c=r.weekdays,a=r.months,f=r.meridiem,l=function(e,r,i,o){return e&&(e[r]||e(t,n))||i[r].slice(0,o)},h=function(e){return x.s(o%12||12,e,"0")},d=f||function(e,t,r){var n=e<12?"AM":"PM";return r?n.toLowerCase():n};return n.replace(y,function(e,n){return n||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return x.s(t.$y,4,"0");case"M":return u+1;case"MM":return x.s(u+1,2,"0");case"MMM":return l(r.monthsShort,u,a,3);case"MMMM":return l(a,u);case"D":return t.$D;case"DD":return x.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return l(r.weekdaysMin,t.$W,c,2);case"ddd":return l(r.weekdaysShort,t.$W,c,3);case"dddd":return c[t.$W];case"H":return String(o);case"HH":return x.s(o,2,"0");case"h":return h(1);case"hh":return h(2);case"a":return d(o,s,!0);case"A":return d(o,s,!1);case"m":return String(s);case"mm":return x.s(s,2,"0");case"s":return String(t.$s);case"ss":return x.s(t.$s,2,"0");case"SSS":return x.s(t.$ms,3,"0");case"Z":return i}return null}(e)||i.replace(":","")})},m.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},m.diff=function(n,h,p){var d,y=this,v=x.p(h),m=S(n),b=(m.utcOffset()-this.utcOffset())*t,g=this-m,j=function(){return x.m(y,m)};switch(v){case l:d=j()/12;break;case a:d=j();break;case f:d=j()/3;break;case c:d=(g-b)/6048e5;break;case u:d=(g-b)/864e5;break;case s:d=g/r;break;case o:d=g/t;break;case i:d=g/e;break;default:d=g}return p?d:x.a(d)},m.daysInMonth=function(){return this.endOf(a).$D},m.$locale=function(){return j[this.$L]},m.locale=function(e,t){if(!e)return this.$L;var r=this.clone(),n=$(e,t,!0);return n&&(r.$L=n),r},m.clone=function(){return x.w(this.$d,this)},m.toDate=function(){return new Date(this.valueOf())},m.toJSON=function(){return this.isValid()?this.toISOString():null},m.toISOString=function(){return this.$d.toISOString()},m.toString=function(){return this.$d.toUTCString()},v}(),P=O.prototype;return S.prototype=P,[["$ms",n],["$s",i],["$m",o],["$H",s],["$W",u],["$M",a],["$y",l],["$D",h]].forEach(function(e){P[e[1]]=function(t){return this.$g(t,e[0],e[1])}}),S.extend=function(e,t){return e.$i||(e(t,O,S),e.$i=!0),S},S.locale=$,S.isDayjs=_,S.unix=function(e){return S(1e3*e)},S.en=j[g],S.Ls=j,S.p={},S}()}(ir);var or=nr(ir.exports);function sr(e){let t=Object.prototype.toString.call(e);return"[object Function]"===t||"[object AsyncFunction]"===t}function ur(e){if(!Zt(e))return!1;return er(e)>0}let cr="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),ar=cr.length;function fr(e,t={}){let r=le(t,"fs");return!!r.existsSync(e)&&(!r.lstatSync(e).isDirectory()&&!r.lstatSync(e).isSymbolicLink())}function lr(t){return fr(t,{fs:e})}function hr(e,t={}){let r=le(t,"fs");if(!r.existsSync(e))return!1;let n=r.lstatSync(e);return!n.isFile()&&!n.isSymbolicLink()}function pr(t){return hr(t,{fs:e})}function dr(){let e,t,r=new Promise(function(){e=arguments[0],t=arguments[1]});return r.resolve=e,r.reject=t,r}function yr(e=10){ye(e)||(e=10);let t=dr();return setTimeout(function(){t.resolve()},e),t}async function vr(t,r={}){return await async function(e,t={}){let r=le(t,"numRetry");ur(r)||(r=5),r=er(r);let n=le(t,"fs",null);if(!n.existsSync(e))return"folder does not exist: "+e;if(!hr(e,{fs:n}))return Promise.reject("input path is not a folder: "+e);for(let t=0;t<r;t++)try{n.rmSync(e,{recursive:!0,force:!0});break}catch(e){if("EBUSY"!==e.code)return Promise.reject(e);await yr(300)}return"done: "+e}(t,{fs:e,...r})}var mr=Math.ceil,br=Math.max;var gr=function(e){return function(t,r,n){return n&&"number"!=typeof n&&function(e,t,r){if(!S(r))return!1;var n=typeof t;return!!("number"==n?st(r)&&We(t,r.length):"string"==n&&t in r)&&W(r[t],e)}(t,r,n)&&(r=n=void 0),t=Oe(t),void 0===r?(r=t,t=0):r=Oe(r),function(e,t,r,n){for(var i=-1,o=br(mr((t-e)/(r||1)),0),s=Array(o);o--;)s[n?o:++i]=e,e+=r;return s}(t,r,n=void 0===n?t<r?1:-1:Oe(n),e)}}(),jr=gr;function wr(e,t,r){var n=null==e?0:e.length;return n?function(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var o=Array(i);++n<i;)o[n]=e[n+t];return o}(e,(t=r||void 0===t?1:Vt(t))<0?0:t,n):[]}function _r(e,t){if(!pe(e))return"";if(!tr(t))return"";if(0===(t=er(t)))return"";let r=e.length-t;return r<0&&(r=0),e.substring(r,r+t)}function $r(e,t){return pe(e)&&tr(t)?0===(t=er(t))?e:function(e,t){return pe(e)&&tr(t)?0===(t=er(t))?"":e.substring(0,t):""}(e,e.length-t):""}function Sr(e){if(!pe(e))return{path:"",isRoot:!1};for(;e.indexOf("\\\\")>=0;)e=e.replace("\\\\","\\");for(;e.indexOf("//")>=0;)e=e.replace("//","/");if(":"===_r(e,1))return{path:`${e}\\`,isRoot:!0};if("\\"===_r(e,1)){let t=$r(e,1);return":"===_r(t,1)?{path:e,isRoot:!0}:{path:t,isRoot:!1}}if("/"===_r(e,1)){let t=$r(e,1);return 0===t.length?{path:e,isRoot:!0}:{path:t,isRoot:!1}}return{path:e,isRoot:!1}}function xr(e){if(!pe(e))return"";let t=Sr(e);if(t.isRoot)return t.path;let r=t.path;try{r=r.split("\\").pop().split("/").pop()}catch(e){}return r}function Or(e){if(!pe(e))return"";let t=Sr(e);if(t.isRoot)return t.path;let r=xr(e=t.path);if(!pe(r))return e;let n=Sr(e=$r(e,r.length));return n.isRoot,n.path}function Pr(e,t={}){let r=le(t,"fs");if(hr(e,{fs:r}))return{success:"input folder is already exists: "+e};if(r.existsSync(e))return{error:"input path already exists: "+e};try{r.mkdirSync(e,{recursive:!0})}catch(e){return{error:e}}return{success:"done: "+e}}async function Mr(t,r){return async function(e,t,r={}){let n="",i=le(r,"fs"),o=le(r,"Readable");if(!pe(e))throw new Error("urlIn in not an effective string");let s=Or(t),u=le(r,"fnOut","");pe(u)||(u=xr(t)),hr(s,{fs:i})||Pr(s,{fs:i});let c=dr();try{let r=await fetch(e);if(!r.ok)return c.reject(r.statusText),c;let s=i.createWriteStream(t);o.fromWeb(r.body).pipe(s),s.on("finish",()=>{c.resolve(t)}),s.on("error",e=>{n=e.message,c.reject(n)})}catch(e){n=e.message,c.reject(n)}return c}(t,r,{fs:e,Readable:i.Readable})}function Dr(e,t={}){let r=le(t,"fs");if(!r.existsSync(e))return{success:"file does not exist: "+e};if(!fr(e,{fs:r}))return{error:"input path is not a file: "+e};try{r.unlinkSync(e)}catch(e){return{error:e}}return{success:"done: "+e}}async function kr(t,r,n={}){return async function(e,t,r={}){let n="",i=le(r,"fs");if(!Bt(e))throw new Error("fpsIn in not an effective array");let o=Or(t),s=le(r,"fnOut","");pe(s)||(s=xr(t)),hr(o,{fs:i})||Pr(o,{fs:i});let u=dr();try{let r=i.createWriteStream(t);for(let t=0;t<e.length;t++){let o=e[t];if(!fr(o,{fs:i}))throw new Error(`fpIn[${o}] is not a file`);let s=()=>{let e=dr(),t=i.createReadStream(o);return t.on("error",t=>{n=t.message,e.reject(t)}),t.on("end",()=>{Dr(o,{fs:i}),e.resolve()}),t.pipe(r,{end:!1}),e};await s()}r.end(),r.on("error",e=>{n=e.message,u.reject(n)}),r.on("finish",()=>{let e={filename:s,path:t};u.resolve(e)})}catch(e){n=e.message,u.reject(n)}return u}(t,r,{fs:e,...n})}function Fr(t,r){return function(e,t,r={}){let n=le(r,"fs");if(!hr(e,{fs:n}))return{error:`pahOld[${e}] is not a folder`};if(n.existsSync(t))return{error:`pahNew[${t}] already exists`};let i=Or(t);hr(i,{fs:n})||Pr(i,{fs:n});try{n.renameSync(e,t)}catch(e){return{error:e}}return{success:"done: "+t}}(t,r,{fs:e})}function zr(t){return function(e,t={}){let r=le(t,"fs");if(!r.existsSync(e))return{success:"folder does not exist: "+e};if(!hr(e,{fs:r}))return{error:"input path is not a folder: "+e};try{r.rmSync(e,{recursive:!0,force:!0})}catch(e){return{error:e}}return{success:"done: "+e}}(t,{fs:e})}function Ar(e){return null==e?[]:function(e,t){return ie(t,function(t){return e[t]})}(e,ut(e))}var Tr={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,n,o,s){if("function"!=typeof n)throw new TypeError("The listener must be a function");var u=new i(n,o||e,s),c=r?r+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],u]:e._events[c].push(u):(e._events[c]=u,e._eventsCount++),e}function s(e,t){0===--e._eventsCount?e._events=new n:delete e._events[t]}function u(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),u.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},u.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,s=new Array(o);i<o;i++)s[i]=n[i].fn;return s},u.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},u.prototype.emit=function(e,t,n,i,o,s){var u=r?r+e:e;if(!this._events[u])return!1;var c,a,f=this._events[u],l=arguments.length;if(f.fn){switch(f.once&&this.removeListener(e,f.fn,void 0,!0),l){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,t),!0;case 3:return f.fn.call(f.context,t,n),!0;case 4:return f.fn.call(f.context,t,n,i),!0;case 5:return f.fn.call(f.context,t,n,i,o),!0;case 6:return f.fn.call(f.context,t,n,i,o,s),!0}for(a=1,c=new Array(l-1);a<l;a++)c[a-1]=arguments[a];f.fn.apply(f.context,c)}else{var h,p=f.length;for(a=0;a<p;a++)switch(f[a].once&&this.removeListener(e,f[a].fn,void 0,!0),l){case 1:f[a].fn.call(f[a].context);break;case 2:f[a].fn.call(f[a].context,t);break;case 3:f[a].fn.call(f[a].context,t,n);break;case 4:f[a].fn.call(f[a].context,t,n,i);break;default:if(!c)for(h=1,c=new Array(l-1);h<l;h++)c[h-1]=arguments[h];f[a].fn.apply(f[a].context,c)}}return!0},u.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},u.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},u.prototype.removeListener=function(e,t,n,i){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return s(this,o),this;var u=this._events[o];if(u.fn)u.fn!==t||i&&!u.once||n&&u.context!==n||s(this,o);else{for(var c=0,a=[],f=u.length;c<f;c++)(u[c].fn!==t||i&&!u[c].once||n&&u[c].context!==n)&&a.push(u[c]);a.length?this._events[o]=1===a.length?a[0]:a:s(this,o)}return this},u.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&s(this,t)):(this._events=new n,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=r,u.EventEmitter=u,e.exports=u}(Tr);var Hr=nr(Tr.exports);function Er(e=0){let t=0,r=[];var n;Zt(n=e)&&er(n)<0&&(e=0),e=er(e);let i=new Hr;return i.get=function(){if(r.length>0){return t+=1,r.splice(0,1)[0]}return null},i.cb=function(){t-=1,t<0&&(t=0),r.length>0&&i.emit("message",r)},i.push=function(n){r.push(n),(e<=0||t<e)&&i.emit("message",r)},i.clear=function(){t=0,r=[]},i}async function Nr(t){try{lr(t)?e.unlinkSync(t):pr(t)&&zr(t),e.writeFileSync(t,"test","utf8"),e.unlinkSync(t)}catch(e){return!1}return!0}o.registerFormat("zip-encrypted",s);var Cr={zipFile:async function(r,n,i={}){if(!e.existsSync(r))return Promise.reject("invalid path of source file");if(!e.lstatSync(r).isFile())return Promise.reject("path of source is not file");if(!Nr(n))return Promise.reject("invalid fpSrc");let s=le(i,"level",9),u=le(i,"pw","");try{let i=dr();e.existsSync(t.dirname(n))||e.mkdirSync(t.dirname(n),{recursive:!0});let c,a=e.createWriteStream(n);return c=""===u?o("zip",{zlib:{level:s}}):o("zip-encrypted",{zlib:{level:s},encryptionMethod:"zip20",password:u}),a.on("close",function(){i.resolve("done: "+n)}),c.on("warning",function(e){}),c.on("error",function(e){Promise.reject(e)}),c.pipe(a),c.file(r,{name:t.basename(r)}),c.finalize(),i}catch(e){return Promise.reject(e)}},zipFolder:async function(r,n,i={}){if(!e.existsSync(r))return Promise.reject("invalid path of source file");if(!e.lstatSync(r).isDirectory())return Promise.reject("path of source is not folder");if(!Nr(n))return Promise.reject("invalid fpSrc");let s=le(i,"level",9),u=le(i,"pw","");try{let i=dr();e.existsSync(t.dirname(n))||e.mkdirSync(t.dirname(n),{recursive:!0});let c,a=e.createWriteStream(n);return c=""===u?o("zip",{zlib:{level:s}}):o("zip-encrypted",{zlib:{level:s},encryptionMethod:"zip20",password:u}),a.on("close",function(){i.resolve("done: "+n)}),c.on("warning",function(e){}),c.on("error",function(e){Promise.reject(e)}),c.pipe(a),c.directory(r,t.basename(r)),c.finalize(),i}catch(e){return Promise.reject(e)}},unzip:async function(r,n,i={}){if(!e.existsSync(r))return Promise.reject("invalid path of source file");if(!e.lstatSync(r).isFile())return Promise.reject("path of source is not file");if(!Nr(n))return Promise.reject("invalid fpSrc");let o=le(i,"pw","");try{return await async function(r,n,i){return function(e,t,r=0){let n={},i=!1,o=dr();if(!Ut(e)&&!ve(e))return o.reject("rs is not an array or object"),o;let s=!1;if(ve(e)){s=!0;let t=[];lt(e,(e,r)=>{t.push({k:r,v:e})}),e=t}let u=Er(r);return u.on("message",function(r){if(i)return;let c,a=u.get();if(sr(t)){let e=a.key,r=a.value;s&&(e=a.value.k,r=a.value.v),c=t(r,e)}else c=a.value;c.then(e=>{n[a.key]=e}).catch(e=>{i=!0,u.clear(),o.reject(e)}).finally(()=>{u.cb(),Jt(n)===Jt(e)&&o.resolve(Ar(n))})}),lt(e,(e,t)=>{u.push({key:t,value:e})}),o}((await u.Open.file(r)).files,async r=>{let o=t.join(n,r.path);return"File"===r.type?async function(r,n,i=""){try{e.existsSync(t.dirname(n))||e.mkdirSync(t.dirname(n),{recursive:!0});let o=await r.buffer(i);e.writeFileSync(n,o)}catch(e){return Promise.reject(e)}return"done"}(r,o,i):async function(t){try{e.existsSync(t)||e.mkdirSync(t,{recursive:!0})}catch(e){return Promise.reject(e)}return"done"}(o)})}(r,n,o),Promise.resolve("done: "+xr(n))}catch(e){return Promise.reject(e)}}};async function Ir(t){let r=`${t}portable.zip`,n=[],i=[];lt(jr(1,9),e=>{let r=`portable.zip.00${e}`,o=`${t}${r}`;n.push(r),i.push(o)}),await function(e,t){let r=dr();if(!Ut(e)&&!ve(e))return r.reject("rs is not an array or object"),r;let n=!1;if(ve(e)){n=!0;let t=[];lt(e,(e,r)=>{t.push({k:r,v:e})}),e=t}sr(t)||(t=function(e){return e});let i=-1,o=[];return e.reduce(function(e,r){return e.then(function(e){o.push(e),i+=1;let s=i,u=r;return n&&(s=r.k,u=r.v),sr(t)?t(u,s):u})},Promise.resolve()).then(function(e){o.push(e),o=wr(o),r.resolve(o)}).catch(function(e){r.reject(e)}),r}(n,async(e,t)=>{let r=i[t],n=`https://github.com/yuda-lyu/w-html2png/raw/refs/heads/master/chrome/${e}`;console.log(`downloading url[${n}]...`,`to fp[${r}]`),await Mr(n,r)}),await kr(i,r);let o=`${t}temp`;await Cr.unzip(r,o);Fr(`${t}temp/portable`,`${t}portable`);zr(o),Dr(r,{fs:e})}let Lr=t.resolve();async function Rr(i=700,o=400,s=3,u="",c={}){if("win32"!==process.platform)return Promise.reject("operating system is not windows");if(!ye(i))return Promise.reject("width is not a number");if((i=Pe(i))<=0)return Promise.reject("width <= 0");if(!ye(o))return Promise.reject("height is not a number");if((o=Pe(o))<=0)return Promise.reject("height <= 0");if(!ye(s))return Promise.reject("scale is not a number");if((s=Pe(s))<=0)return Promise.reject("scale <= 0");if(!pe(u))return Promise.reject("html is not an effective string");let a=u,f=le(c,"modeHeadless");!0!==f&&!1!==f&&"new"!==f&&"shell"!==f&&(f="new");let l=le(c,"scriptsHead");Bt(l)||(l=[]);let h="";lt(l,e=>{h+=`<script src="${e}"><\/script>\n`});let p=le(c,"execJsHead");pe(p)&&(p=[p]),Bt(p)||(p=[]);let d="";lt(p,e=>{d+=`<script>${e}<\/script>\n\n`});let y=le(c,"execJsPost");pe(y)&&(y=[y]),Bt(y)||(y=[]);let v="";lt(y,e=>{v+=`<script>${e}<\/script>\n\n`});let m=`${Lr}/node_modules/w-html2png/chrome/`,b=`${Lr}/chrome/`;pr(m)&&(b=m);let g=`${`${b}portable/App/Chrome-bin/138.0.7204.97/`}chrome.exe`;lr(g)||await Ir(b);let j=le(c,"executablePath","");pe(j)||(j=g);let w=process.cwd(),_=`${function(){if(!sr(or))throw new Error("invalid dayjs");return or().format("YYYYMMDDHHmmss")}()}-${function(e=32){let t=[];e=ur(e)?er(e):32;for(let r=0;r<e;r++)t[r]=cr[0|Math.random()*ar];return t.join("")}()}`;return await(async()=>{let u=[],c=[],l="",p=null,y=null,m=null;if(p=await(async r=>{let n=[],i=`./whpic-${_}.png`,o=t.resolve(w,i),s=`./whweb-${_}.html`,u=t.resolve(w,s),c='\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="UTF-8">\n  <title>highcharts to png</title>\n\n  <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"><\/script>\n\n  <script src="https://cdn.jsdelivr.net/npm/wsemi/dist/wsemi.umd.js"><\/script>\n  <script>\n      let w = wsemi\n  <\/script>\n\n  {cScriptsHead}\n\n  {cExecJsHead}\n\n</head>\n<body style="padding:0; margin:0;">\n\n    <div id="pl">\n        {cHtml}\n    </div>\n\n    {cExecJsPost}\n\n</body>\n</html>\n';c=c.replace("{cHtml}",a),c=c.replace("{cScriptsHead}",h),c=c.replace("{cExecJsHead}",d),c=c.replace("{cExecJsPost}",v);try{e.writeFileSync(u,c,"utf8")}catch(e){n.push({anchor:"fs.writeFileSync(fpHtml, g, 'utf8')",err:e})}if(0===Jt(n))try{let e=r(u,o);rr(e)&&(e=await e)}catch(e){n.push({anchor:"fun(fpHtml, fpOut)",err:e})}if(lr(u))try{e.unlinkSync(u)}catch(e){}if(lr(o))try{e.unlinkSync(o)}catch(e){}return Jt(n)>0?{state:"error",msg:n}:{state:"success",msg:""}})(async(t,u)=>{if(y=await(async e=>{let t=[],i=`./_puppeteer_profile_${_}`,o={headless:f,slowMo:20,protocolTimeout:6e4,userDataDir:i,args:["--no-sandbox","--incognito","--disable-gpu","--disable-software-rasterizer","--disable-setuid-sandbox","--disable-dev-shm-usage","--disable-sync","--disable-extensions","--disable-default-apps","--disable-features=VizDisplayCompositor","--metrics-recording-only","--mute-audio","--no-first-run","--safebrowsing-disable-auto-update"]};pe(j)&&(o.executablePath=j);let s=null,u=null,c=null;try{s=await r.launch(o),u=s.process(),c=le(u,"pid","")}catch(e){t.push({anchor:"puppeteer.launch(puppeteerOpt)",err:e})}if(null!==s)try{let t=e(s);rr(t)&&(t=await t)}catch(e){t.push({anchor:"fun(browser)",err:e})}if(null!==s)try{await s.close()}catch(e){t.push({anchor:"browser.close()",err:e})}if(tr(c))try{n(c,"SIGKILL")}catch(e){}try{await vr(i)}catch(e){t.push({anchor:"fsDeleteFolderSafe(fd)",err:e})}return Jt(t)>0?{state:"error",msg:t}:{state:"success",msg:""}})(async r=>{m=await(async(e,t)=>{let r=[],n=null;try{n=await e.newPage(),n.setDefaultNavigationTimeout(6e4)}catch(e){r.push({anchor:"browser.newPage()",err:e})}if(null!==n)try{let e=t(n);rr(e)&&(e=await e)}catch(e){r.push({anchor:"fun(page)",err:e})}if(null!==n)try{await n.close()}catch(e){r.push({anchor:"page.close()",err:e})}return Jt(r)>0?{state:"error",msg:r}:{state:"success",msg:""}})(r,async e=>{let r={x:0,y:0,width:Number(i),height:Number(o),deviceScaleFactor:Number(s)};await e.goto(t,{waitUntil:["domcontentloaded","networkidle2"],timeout:6e4}),await e.setViewport(r),await e.screenshot({path:u,timeout:6e4})}).catch(t=>{e.writeFileSync(`./_err_${_}_supplyPage.json`,t.message,"utf8")})}).catch(t=>{e.writeFileSync(`./_err_${_}_supplyBrowser.json`,t.message,"utf8")}),"error"!==le(y,"state","")){if(lr(u)){try{l=e.readFileSync(u,{encoding:"base64"})}catch(e){return void c.push({anchor:"fs.readFileSync(fpOut, { encoding: 'base64' })",err:e})}return null}c.push({anchor:"fsIsFile(fpOut)",err:new Error(`no file[${u}]`)})}}).catch(t=>{e.writeFileSync(`./_err_${_}_supplyHtml.json`,t.message,"utf8")}),"error"===le(p,"state","")&&(u=[...u,...p.msg]),"error"===le(y,"state","")&&(u=[...u,...y.msg]),"error"===le(m,"state","")&&(u=[...u,...m.msg]),Jt(c)>0&&(u=[...u,...c]),Jt(u)>0){{let t="";lt(u,e=>{let r=le(e,"err.message","");t+=r+"\n"}),e.writeFileSync(`./_err_${_}_earrs.json`,t,"utf8")}let t=u[0],r=`${t.err.message} in ${t.anchor}`;return Promise.reject(r)}return pe(l)?l:Promise.reject("b64 is not an effective string")})().finally(()=>{let t=`./whweb-${_}.html`;lr(t)&&e.writeFileSync(`./_err_${_}_fsIsFile_fnHtml.json`,`html檔[${t}]未正常刪除`,"utf8");let r=`./_puppeteer_profile_${_}`;pr(r)&&e.writeFileSync(`./_err_${_}_fsIsFolder_profile.json`,`profile資料夾[${r}]未正常刪除`,"utf8");let n=`./whpic-${_}.png`;lr(n)&&e.writeFileSync(`./_err_${_}_fsIsFile_fnPng.json`,`png檔[${n}]未正常刪除`,"utf8")})}let Yr=e.readFileSync("./node_modules/highcharts/highcharts.js","utf8"),Wr=e.readFileSync("./node_modules/highcharts/highcharts-more.js","utf8"),Jr=e.readFileSync("./node_modules/highcharts/modules/stock.js","utf8"),Ur=e.readFileSync("./node_modules/highcharts/modules/annotations.js","utf8"),qr=e.readFileSync("./node_modules/highcharts/modules/heatmap.js","utf8"),Br=e.readFileSync("./node_modules/highcharts/modules/boost.js","utf8"),Vr=e.readFileSync("./node_modules/highcharts/modules/boost-canvas.js","utf8");return async function(e=700,t=400,r=3,n={},i={}){if(!ye(e))return Promise.reject("width is not a number");if((e=Pe(e))<=0)return Promise.reject("width <= 0");if(!ye(t))return Promise.reject("height is not a number");if((t=Pe(t))<=0)return Promise.reject("height <= 0");if(!ye(r))return Promise.reject("scale is not a number");if((r=Pe(r))<=0)return Promise.reject("scale <= 0");if(!function(e){if(ve(e)){for(let t in e)return!0;return!1}return!1}(n)&&!pe(n))return Promise.reject("opt is not an effective object or string");let o=[Yr,Wr,Jr,Ur,qr,Br,Vr],s="";if(pe(n))s=n;else{s=`let opt=${JSON.stringify(n)};`}let u=`\n\n        ${s}\n\n        if(_.isObject(opt)){\n\n            //強制關閉動畫避免過慢顯示無法截到數據圖\n            _.set(opt, 'chart.animation', false)\n            _.set(opt, 'plotOptions.series.animation', false)\n            // console.log('opt', opt)\n        \n            //plot\n            Highcharts.chart('hc', opt)\n\n        }\n        else{\n            console.log('invalid opt')\n        }\n\n    `;u=[u];let c=`\n\n        <div id="hc" style="width:${e}px; height:${t}px;"></div>\n\n    `,a=le(i,"execJsHead","");pe(a)&&(a=[a]),a=[...a,...o],i.execJsHead=a;let f=le(i,"execJsPost","");return pe(f)&&(f=[f]),f=[...f,...u],i.execJsPost=f,await Rr(e,t,r,c,i)}});
//# sourceMappingURL=w-hc-2-png.umd.js.map
