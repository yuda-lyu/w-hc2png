/*!
 * w-hc-2-png v1.0.18
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("fs"),require("path"),require("puppeteer")):"function"==typeof define&&define.amd?define(["fs","path","puppeteer"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-hc-2-png"]=e(t.fs,t.path,t.puppeteer)}(this,(function(t,e,r){"use strict";var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function i(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var o=Array.isArray,a="object"==typeof n&&n&&n.Object===Object&&n,u=a,c="object"==typeof self&&self&&self.Object===Object&&self,s=u||c||Function("return this")(),f=s.Symbol,l=f,h=Object.prototype,p=h.hasOwnProperty,d=h.toString,v=l?l.toStringTag:void 0;var y=function(t){var e=p.call(t,v),r=t[v];try{t[v]=void 0;var n=!0}catch(t){}var i=d.call(t);return n&&(e?t[v]=r:delete t[v]),i},b=Object.prototype.toString;var g=y,_=function(t){return b.call(t)},m=f?f.toStringTag:void 0;var $=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":m&&m in Object(t)?g(t):_(t)};var j=function(t){return null!=t&&"object"==typeof t},O=$,w=j;var S=function(t){return"symbol"==typeof t||w(t)&&"[object Symbol]"==O(t)},M=o,D=S,x=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,A=/^\w*$/;var T=function(t,e){if(M(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!D(t))||(A.test(t)||!x.test(t)||null!=e&&t in Object(e))};var k=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},F=$,P=k;var N,Y=function(t){if(!P(t))return!1;var e=F(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},z=s["__core-js_shared__"],C=(N=/[^.]+$/.exec(z&&z.keys&&z.keys.IE_PROTO||""))?"Symbol(src)_1."+N:"";var H=function(t){return!!C&&C in t},L=Function.prototype.toString;var I=Y,U=H,E=k,W=function(t){if(null!=t){try{return L.call(t)}catch(t){}try{return t+""}catch(t){}}return""},q=/^\[object .+?Constructor\]$/,B=Function.prototype,J=Object.prototype,V=B.toString,Z=J.hasOwnProperty,R=RegExp("^"+V.call(Z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var G=function(t){return!(!E(t)||U(t))&&(I(t)?R:q).test(W(t))},Q=function(t,e){return null==t?void 0:t[e]};var K=function(t,e){var r=Q(t,e);return G(r)?r:void 0},X=K(Object,"create"),tt=X;var et=function(){this.__data__=tt?tt(null):{},this.size=0};var rt=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},nt=X,it=Object.prototype.hasOwnProperty;var ot=function(t){var e=this.__data__;if(nt){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return it.call(e,t)?e[t]:void 0},at=X,ut=Object.prototype.hasOwnProperty;var ct=X;var st=et,ft=rt,lt=ot,ht=function(t){var e=this.__data__;return at?void 0!==e[t]:ut.call(e,t)},pt=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=ct&&void 0===e?"__lodash_hash_undefined__":e,this};function dt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}dt.prototype.clear=st,dt.prototype.delete=ft,dt.prototype.get=lt,dt.prototype.has=ht,dt.prototype.set=pt;var vt=dt;var yt=function(){this.__data__=[],this.size=0};var bt=function(t,e){return t===e||t!=t&&e!=e};var gt=function(t,e){for(var r=t.length;r--;)if(bt(t[r][0],e))return r;return-1},_t=gt,mt=Array.prototype.splice;var $t=gt;var jt=gt;var Ot=gt;var wt=yt,St=function(t){var e=this.__data__,r=_t(e,t);return!(r<0)&&(r==e.length-1?e.pop():mt.call(e,r,1),--this.size,!0)},Mt=function(t){var e=this.__data__,r=$t(e,t);return r<0?void 0:e[r][1]},Dt=function(t){return jt(this.__data__,t)>-1},xt=function(t,e){var r=this.__data__,n=Ot(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};function At(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}At.prototype.clear=wt,At.prototype.delete=St,At.prototype.get=Mt,At.prototype.has=Dt,At.prototype.set=xt;var Tt=At,kt=K(s,"Map"),Ft=vt,Pt=Tt,Nt=kt;var Yt=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var zt=function(t,e){var r=t.__data__;return Yt(e)?r["string"==typeof e?"string":"hash"]:r.map},Ct=zt;var Ht=zt;var Lt=zt;var It=zt;var Ut=function(){this.size=0,this.__data__={hash:new Ft,map:new(Nt||Pt),string:new Ft}},Et=function(t){var e=Ct(this,t).delete(t);return this.size-=e?1:0,e},Wt=function(t){return Ht(this,t).get(t)},qt=function(t){return Lt(this,t).has(t)},Bt=function(t,e){var r=It(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};function Jt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Jt.prototype.clear=Ut,Jt.prototype.delete=Et,Jt.prototype.get=Wt,Jt.prototype.has=qt,Jt.prototype.set=Bt;var Vt=Jt;function Zt(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var a=t.apply(this,n);return r.cache=o.set(i,a)||o,a};return r.cache=new(Zt.Cache||Vt),r}Zt.Cache=Vt;var Rt=Zt;var Gt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Qt=/\\(\\)?/g,Kt=function(t){var e=Rt(t,(function(t){return 500===r.size&&r.clear(),t})),r=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Gt,(function(t,r,n,i){e.push(n?i.replace(Qt,"$1"):r||t)})),e}));var Xt=function(t,e){for(var r=-1,n=null==t?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i},te=o,ee=S,re=f?f.prototype:void 0,ne=re?re.toString:void 0;var ie=function t(e){if("string"==typeof e)return e;if(te(e))return Xt(e,t)+"";if(ee(e))return ne?ne.call(e):"";var r=e+"";return"0"==r&&1/e==-Infinity?"-0":r},oe=ie;var ae=function(t){return null==t?"":oe(t)},ue=o,ce=T,se=Kt,fe=ae;var le=S;var he=function(t,e){return ue(t)?t:ce(t,e)?[t]:se(fe(t))},pe=function(t){if("string"==typeof t||le(t))return t;var e=t+"";return"0"==e&&1/t==-Infinity?"-0":e};var de=function(t,e){for(var r=0,n=(e=he(e,t)).length;null!=t&&r<n;)t=t[pe(e[r++])];return r&&r==n?t:void 0},ve=de;var ye=function(t,e,r){var n=null==t?void 0:ve(t,e);return void 0===n?r:n},be={},ge={get exports(){return be},set exports(t){be=t}};var _e=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t};var me=function(t){return function(e,r,n){for(var i=-1,o=Object(e),a=n(e),u=a.length;u--;){var c=a[t?u:++i];if(!1===r(o[c],c,o))break}return e}}();var $e=function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n},je=$,Oe=j;var we=function(t){return Oe(t)&&"[object Arguments]"==je(t)},Se=j,Me=Object.prototype,De=Me.hasOwnProperty,xe=Me.propertyIsEnumerable,Ae=we(function(){return arguments}())?we:function(t){return Se(t)&&De.call(t,"callee")&&!xe.call(t,"callee")},Te=Ae,ke={};var Fe=function(){return!1};!function(t,e){var r=s,n=Fe,i=e&&!e.nodeType&&e,o=i&&t&&!t.nodeType&&t,a=o&&o.exports===i?r.Buffer:void 0,u=(a?a.isBuffer:void 0)||n;t.exports=u}({get exports(){return ke},set exports(t){ke=t}},ke);var Pe=/^(?:0|[1-9]\d*)$/;var Ne=function(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&Pe.test(t))&&t>-1&&t%1==0&&t<e};var Ye=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},ze=$,Ce=Ye,He=j,Le={};Le["[object Float32Array]"]=Le["[object Float64Array]"]=Le["[object Int8Array]"]=Le["[object Int16Array]"]=Le["[object Int32Array]"]=Le["[object Uint8Array]"]=Le["[object Uint8ClampedArray]"]=Le["[object Uint16Array]"]=Le["[object Uint32Array]"]=!0,Le["[object Arguments]"]=Le["[object Array]"]=Le["[object ArrayBuffer]"]=Le["[object Boolean]"]=Le["[object DataView]"]=Le["[object Date]"]=Le["[object Error]"]=Le["[object Function]"]=Le["[object Map]"]=Le["[object Number]"]=Le["[object Object]"]=Le["[object RegExp]"]=Le["[object Set]"]=Le["[object String]"]=Le["[object WeakMap]"]=!1;var Ie=function(t){return He(t)&&Ce(t.length)&&!!Le[ze(t)]};var Ue=function(t){return function(e){return t(e)}},Ee={};!function(t,e){var r=a,n=e&&!e.nodeType&&e,i=n&&t&&!t.nodeType&&t,o=i&&i.exports===n&&r.process,u=function(){try{var t=i&&i.require&&i.require("util").types;return t||o&&o.binding&&o.binding("util")}catch(t){}}();t.exports=u}({get exports(){return Ee},set exports(t){Ee=t}},Ee);var We=Ie,qe=Ue,Be=Ee&&Ee.isTypedArray,Je=Be?qe(Be):We,Ve=$e,Ze=Te,Re=o,Ge=ke,Qe=Ne,Ke=Je,Xe=Object.prototype.hasOwnProperty;var tr=function(t,e){var r=Re(t),n=!r&&Ze(t),i=!r&&!n&&Ge(t),o=!r&&!n&&!i&&Ke(t),a=r||n||i||o,u=a?Ve(t.length,String):[],c=u.length;for(var s in t)!e&&!Xe.call(t,s)||a&&("length"==s||i&&("offset"==s||"parent"==s)||o&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||Qe(s,c))||u.push(s);return u},er=Object.prototype;var rr=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||er)};var nr=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object),ir=rr,or=nr,ar=Object.prototype.hasOwnProperty;var ur=Y,cr=Ye;var sr=function(t){return null!=t&&cr(t.length)&&!ur(t)},fr=tr,lr=function(t){if(!ir(t))return or(t);var e=[];for(var r in Object(t))ar.call(t,r)&&"constructor"!=r&&e.push(r);return e},hr=sr;var pr=me,dr=function(t){return hr(t)?fr(t):lr(t)};var vr=sr;var yr=function(t,e){return function(r,n){if(null==r)return r;if(!vr(r))return t(r,n);for(var i=r.length,o=e?i:-1,a=Object(r);(e?o--:++o<i)&&!1!==n(a[o],o,a););return r}}((function(t,e){return t&&pr(t,e,dr)}));var br=function(t){return t};var gr=_e,_r=yr,mr=function(t){return"function"==typeof t?t:br},$r=o;var jr=function(t,e){return($r(t)?gr:_r)(t,mr(e))};!function(t){t.exports=jr}(ge);var Or=i(be);function wr(t){return"[object String]"===Object.prototype.toString.call(t)}function Sr(t){return!(!wr(t)||""===t)}function Mr(t){return t!=t}function Dr(t){let e=!1;if(Sr(t))e=!isNaN(Number(t));else if(function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)){if(Mr(t))return!1;e=!0}return e}function xr(t){return"[object Array]"===Object.prototype.toString.call(t)}function Ar(t){return"[object Object]"===Object.prototype.toString.call(t)}function Tr(t){return!!function(t){return"[object Undefined]"===Object.prototype.toString.call(t)}(t)||(!!function(t){return"[object Null]"===Object.prototype.toString.call(t)}(t)||(!!function(t){if(Ar(t)){for(let e in t)return!1;return!0}return!1}(t)||(!!function(t){return!(!wr(t)||""!==t)}(t)||(!!function(t){return!!xr(t)&&0===t.length}(t)||!!Mr(t)))))}function kr(t){return!!xr(t)&&(0!==t.length&&(1!==t.length||!Tr(t[0])))}function Fr(t){if(Ar(t)){for(let e in t)return!0;return!1}return!1}var Pr=$,Nr=j;var Yr=function(t){return!0===t||!1===t||Nr(t)&&"[object Boolean]"==Pr(t)};var zr=/\s/;var Cr=function(t){for(var e=t.length;e--&&zr.test(t.charAt(e)););return e},Hr=/^\s+/;var Lr=function(t){return t?t.slice(0,Cr(t)+1).replace(Hr,""):t},Ir=k,Ur=S,Er=/^[-+]0x[0-9a-f]+$/i,Wr=/^0b[01]+$/i,qr=/^0o[0-7]+$/i,Br=parseInt;var Jr=function(t){if("number"==typeof t)return t;if(Ur(t))return NaN;if(Ir(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Ir(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Lr(t);var r=Wr.test(t);return r||qr.test(t)?Br(t.slice(2),r?2:8):Er.test(t)?NaN:+t},Vr=Jr,Zr=1/0;var Rr=function(t){return t?(t=Vr(t))===Zr||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0};function Gr(t){if(!Dr(t))return 0;return Rr(t)}var Qr={};!function(t,e){t.exports=function(){var t=1e3,e=6e4,r=36e5,n="millisecond",i="second",o="minute",a="hour",u="day",c="week",s="month",f="quarter",l="year",h="date",p="Invalid Date",d=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,v=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,y={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(t){var e=["th","st","nd","rd"],r=t%100;return"["+t+(e[(r-20)%10]||e[r]||e[0])+"]"}},b=function(t,e,r){var n=String(t);return!n||n.length>=e?t:""+Array(e+1-n.length).join(r)+t},g={s:b,z:function(t){var e=-t.utcOffset(),r=Math.abs(e),n=Math.floor(r/60),i=r%60;return(e<=0?"+":"-")+b(n,2,"0")+":"+b(i,2,"0")},m:function t(e,r){if(e.date()<r.date())return-t(r,e);var n=12*(r.year()-e.year())+(r.month()-e.month()),i=e.clone().add(n,s),o=r-i<0,a=e.clone().add(n+(o?-1:1),s);return+(-(n+(r-i)/(o?i-a:a-i))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:s,y:l,w:c,d:u,D:h,h:a,m:o,s:i,ms:n,Q:f}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},_="en",m={};m[_]=y;var $=function(t){return t instanceof S},j=function t(e,r,n){var i;if(!e)return _;if("string"==typeof e){var o=e.toLowerCase();m[o]&&(i=o),r&&(m[o]=r,i=o);var a=e.split("-");if(!i&&a.length>1)return t(a[0])}else{var u=e.name;m[u]=e,i=u}return!n&&i&&(_=i),i||!n&&_},O=function(t,e){if($(t))return t.clone();var r="object"==typeof e?e:{};return r.date=t,r.args=arguments,new S(r)},w=g;w.l=j,w.i=$,w.w=function(t,e){return O(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var S=function(){function y(t){this.$L=j(t.locale,null,!0),this.parse(t)}var b=y.prototype;return b.parse=function(t){this.$d=function(t){var e=t.date,r=t.utc;if(null===e)return new Date(NaN);if(w.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var n=e.match(d);if(n){var i=n[2]-1||0,o=(n[7]||"0").substring(0,3);return r?new Date(Date.UTC(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)):new Date(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},b.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},b.$utils=function(){return w},b.isValid=function(){return!(this.$d.toString()===p)},b.isSame=function(t,e){var r=O(t);return this.startOf(e)<=r&&r<=this.endOf(e)},b.isAfter=function(t,e){return O(t)<this.startOf(e)},b.isBefore=function(t,e){return this.endOf(e)<O(t)},b.$g=function(t,e,r){return w.u(t)?this[e]:this.set(r,t)},b.unix=function(){return Math.floor(this.valueOf()/1e3)},b.valueOf=function(){return this.$d.getTime()},b.startOf=function(t,e){var r=this,n=!!w.u(e)||e,f=w.p(t),p=function(t,e){var i=w.w(r.$u?Date.UTC(r.$y,e,t):new Date(r.$y,e,t),r);return n?i:i.endOf(u)},d=function(t,e){return w.w(r.toDate()[t].apply(r.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(e)),r)},v=this.$W,y=this.$M,b=this.$D,g="set"+(this.$u?"UTC":"");switch(f){case l:return n?p(1,0):p(31,11);case s:return n?p(1,y):p(0,y+1);case c:var _=this.$locale().weekStart||0,m=(v<_?v+7:v)-_;return p(n?b-m:b+(6-m),y);case u:case h:return d(g+"Hours",0);case a:return d(g+"Minutes",1);case o:return d(g+"Seconds",2);case i:return d(g+"Milliseconds",3);default:return this.clone()}},b.endOf=function(t){return this.startOf(t,!1)},b.$set=function(t,e){var r,c=w.p(t),f="set"+(this.$u?"UTC":""),p=(r={},r[u]=f+"Date",r[h]=f+"Date",r[s]=f+"Month",r[l]=f+"FullYear",r[a]=f+"Hours",r[o]=f+"Minutes",r[i]=f+"Seconds",r[n]=f+"Milliseconds",r)[c],d=c===u?this.$D+(e-this.$W):e;if(c===s||c===l){var v=this.clone().set(h,1);v.$d[p](d),v.init(),this.$d=v.set(h,Math.min(this.$D,v.daysInMonth())).$d}else p&&this.$d[p](d);return this.init(),this},b.set=function(t,e){return this.clone().$set(t,e)},b.get=function(t){return this[w.p(t)]()},b.add=function(n,f){var h,p=this;n=Number(n);var d=w.p(f),v=function(t){var e=O(p);return w.w(e.date(e.date()+Math.round(t*n)),p)};if(d===s)return this.set(s,this.$M+n);if(d===l)return this.set(l,this.$y+n);if(d===u)return v(1);if(d===c)return v(7);var y=(h={},h[o]=e,h[a]=r,h[i]=t,h)[d]||1,b=this.$d.getTime()+n*y;return w.w(b,this)},b.subtract=function(t,e){return this.add(-1*t,e)},b.format=function(t){var e=this,r=this.$locale();if(!this.isValid())return r.invalidDate||p;var n=t||"YYYY-MM-DDTHH:mm:ssZ",i=w.z(this),o=this.$H,a=this.$m,u=this.$M,c=r.weekdays,s=r.months,f=r.meridiem,l=function(t,r,i,o){return t&&(t[r]||t(e,n))||i[r].slice(0,o)},h=function(t){return w.s(o%12||12,t,"0")},d=f||function(t,e,r){var n=t<12?"AM":"PM";return r?n.toLowerCase():n};return n.replace(v,(function(t,n){return n||function(t){switch(t){case"YY":return String(e.$y).slice(-2);case"YYYY":return w.s(e.$y,4,"0");case"M":return u+1;case"MM":return w.s(u+1,2,"0");case"MMM":return l(r.monthsShort,u,s,3);case"MMMM":return l(s,u);case"D":return e.$D;case"DD":return w.s(e.$D,2,"0");case"d":return String(e.$W);case"dd":return l(r.weekdaysMin,e.$W,c,2);case"ddd":return l(r.weekdaysShort,e.$W,c,3);case"dddd":return c[e.$W];case"H":return String(o);case"HH":return w.s(o,2,"0");case"h":return h(1);case"hh":return h(2);case"a":return d(o,a,!0);case"A":return d(o,a,!1);case"m":return String(a);case"mm":return w.s(a,2,"0");case"s":return String(e.$s);case"ss":return w.s(e.$s,2,"0");case"SSS":return w.s(e.$ms,3,"0");case"Z":return i}return null}(t)||i.replace(":","")}))},b.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},b.diff=function(n,h,p){var d,v=this,y=w.p(h),b=O(n),g=(b.utcOffset()-this.utcOffset())*e,_=this-b,m=function(){return w.m(v,b)};switch(y){case l:d=m()/12;break;case s:d=m();break;case f:d=m()/3;break;case c:d=(_-g)/6048e5;break;case u:d=(_-g)/864e5;break;case a:d=_/r;break;case o:d=_/e;break;case i:d=_/t;break;default:d=_}return p?d:w.a(d)},b.daysInMonth=function(){return this.endOf(s).$D},b.$locale=function(){return m[this.$L]},b.locale=function(t,e){if(!t)return this.$L;var r=this.clone(),n=j(t,e,!0);return n&&(r.$L=n),r},b.clone=function(){return w.w(this.$d,this)},b.toDate=function(){return new Date(this.valueOf())},b.toJSON=function(){return this.isValid()?this.toISOString():null},b.toISOString=function(){return this.$d.toISOString()},b.toString=function(){return this.$d.toUTCString()},y}(),M=S.prototype;return O.prototype=M,[["$ms",n],["$s",i],["$m",o],["$H",a],["$W",u],["$M",s],["$y",l],["$D",h]].forEach((function(t){M[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),O.extend=function(t,e){return t.$i||(t(e,S,O),t.$i=!0),O},O.locale=j,O.isDayjs=$,O.unix=function(t){return O(1e3*t)},O.en=m[_],O.Ls=m,O.p={},O}()}({get exports(){return Qr},set exports(t){Qr=t}});var Kr=Qr;function Xr(){return Kr().format("YYYYMMDDHHmmss")}var tn=Rr;var en=function(t){var e=tn(t),r=e%1;return e==e?r?e-r:e:0},rn=en;var nn=function(t){return"number"==typeof t&&t==rn(t)};var on=en,an=Jr,un=ae,cn=s.isFinite,sn=Math.min;var fn=function(t){var e=Math[t];return function(t,r){if(t=an(t),(r=null==r?0:sn(on(r),292))&&cn(t)){var n=(un(t)+"e").split("e"),i=e(n[0]+"e"+(+n[1]+r));return+((n=(un(i)+"e").split("e"))[0]+"e"+(+n[1]-r))}return e(t)}}("round");function ln(t){if(!Dr(t))return 0;t=Gr(t);let e=fn(t);return"0"===String(e)?0:e}function hn(t){if(!function(t){return!!Dr(t)&&(t=Gr(t),nn(t))}(t))return!1;return ln(t)>0}let pn="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),dn=pn.length;function vn(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,e=[];t=hn(t)?ln(t):32;for(let r=0;r<t;r++)e[r]=pn[0|Math.random()*dn];return e.join("")}function yn(e){return!!t.existsSync(e)&&(!t.lstatSync(e).isDirectory()&&!t.lstatSync(e).isSymbolicLink())}let bn=t.readFileSync("./node_modules/highcharts/highcharts.js","utf8"),gn=t.readFileSync("./node_modules/highcharts/modules/stock.js","utf8"),_n=t.readFileSync("./node_modules/highcharts/modules/heatmap.js","utf8"),mn=t.readFileSync("./node_modules/highcharts/modules/annotations.js","utf8"),$n=t.readFileSync("./node_modules/highcharts/modules/boost.js","utf8"),jn=t.readFileSync("./node_modules/highcharts/modules/boost-canvas.js","utf8"),On=process.cwd();return async function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:700,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:400,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(!Dr(n))return Promise.reject("width is not a number");if(n=Gr(n),n<=0)return Promise.reject("width <= 0");if(!Dr(i))return Promise.reject("height is not a number");if(i=Gr(i),i<=0)return Promise.reject("height <= 0");if(!Dr(o))return Promise.reject("scale is not a number");if(o=Gr(o),o<=0)return Promise.reject("scale <= 0");if(!Fr(a)&&!Sr(a))return Promise.reject("opt is not an effective object or string");let c=ye(u,"addScripts");kr(c)||(c=[]);let s=ye(u,"addCode");kr(s)||(s="");let f=ye(u,"useWindowOpt");Yr(f)||(f=!1);let l=ye(u,"executablePath",""),h="let _opt=",p="";f&&(h="",p="let _opt=window.opt;");let d=a;Fr(a)&&(d=JSON.stringify(a));let v=`./whpic-${Xr()}-${vn()}.png`,y=e.resolve(On,v),b=`./whweb-${Xr()}-${vn()}.html`,g=e.resolve(On,b),_="";Or(c,(t=>{_+=`<script src="${t}"><\/script>`}));let m='\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="UTF-8">\n  <title>highcharts to png</title>\n\n  <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"><\/script>\n\n  <script>{code_highcharts}<\/script>\n  <script>{code_stock}<\/script>\n  <script>{code_heatmap}<\/script>\n  <script>{code_annotations}<\/script>\n  <script>{code_boost}<\/script>\n  <script>{code_boost_canvas}<\/script>\n\n  {add_scripts}\n\n  <script>{add_code}<\/script>\n\n</head>\n<body style="padding:0; margin:0;">\n\n    <div id="hc" style="width:{width}px; height:{height}px;"></div>\n\n    <script>\n\n        {cLetOptStart}{cOpt}\n        {cLetOptEnd}\n\n        //opt若為物件時, 強制關閉動畫避免過慢顯示無法截到數據圖\n        _.set(_opt, \'chart.animation\', false)\n        _.set(_opt, \'plotOptions.series.animation\', false)\n        // console.log(\'_opt\', _opt)\n    \n        Highcharts.chart(\'hc\', _opt)\n\n    <\/script>\n\n</body>\n</html>\n';m=m.replace("{width}",n),m=m.replace("{height}",i),m=m.replace("{cLetOptStart}",h),m=m.replace("{cLetOptEnd}",p),m=m.replace("{cOpt}",d),m=m.replace("{code_highcharts}",bn),m=m.replace("{code_stock}",gn),m=m.replace("{code_heatmap}",_n),m=m.replace("{code_annotations}",mn),m=m.replace("{code_boost}",$n),m=m.replace("{code_boost_canvas}",jn),m=m.replace("{add_scripts}",_),m=m.replace("{add_code}",s),t.writeFileSync(g,m,"utf8");let $="";return await(async()=>{let e={headless:"new",slowMo:20};Sr(l)&&(e.executablePath=l);let a=await r.launch(e),u=await a.newPage(),c={x:0,y:0,width:Number(n),height:Number(i),deviceScaleFactor:Number(o)};await u.goto(g),await u.setViewport(c),await u.screenshot({path:y}),await a.close(),$=t.readFileSync(y,{encoding:"base64"})})().catch((t=>{console.log(t)})),yn(g)&&t.unlinkSync(g),yn(y)&&t.unlinkSync(y),$}}));
//# sourceMappingURL=w-hc-2-png.umd.js.map
