/*!
 * w-hc-2-png v1.0.24
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("fs"),require("path"),require("puppeteer")):"function"==typeof define&&define.amd?define(["fs","path","puppeteer"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-hc-2-png"]=e(t.fs,t.path,t.puppeteer)}(this,(function(t,e,r){"use strict";var n=Array.isArray,o="object"==typeof global&&global&&global.Object===Object&&global,i="object"==typeof self&&self&&self.Object===Object&&self,u=o||i||Function("return this")(),a=u.Symbol,c=Object.prototype,s=c.hasOwnProperty,f=c.toString,l=a?a.toStringTag:void 0;var h=Object.prototype.toString;var p="[object Null]",d="[object Undefined]",v=a?a.toStringTag:void 0;function y(t){return null==t?void 0===t?d:p:v&&v in Object(t)?function(t){var e=s.call(t,l),r=t[l];try{t[l]=void 0;var n=!0}catch(t){}var o=f.call(t);return n&&(e?t[l]=r:delete t[l]),o}(t):function(t){return h.call(t)}(t)}function b(t){return null!=t&&"object"==typeof t}var g="[object Symbol]";function _(t){return"symbol"==typeof t||b(t)&&y(t)==g}var j=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,m=/^\w*$/;function w(t,e){if(n(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!_(t))||(m.test(t)||!j.test(t)||null!=e&&t in Object(e))}function $(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var O="[object AsyncFunction]",S="[object Function]",M="[object GeneratorFunction]",D="[object Proxy]";function x(t){if(!$(t))return!1;var e=y(t);return e==S||e==M||e==O||e==D}var A,k=u["__core-js_shared__"],F=(A=/[^.]+$/.exec(k&&k.keys&&k.keys.IE_PROTO||""))?"Symbol(src)_1."+A:"";var z=Function.prototype.toString;function P(t){if(null!=t){try{return z.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var T=/^\[object .+?Constructor\]$/,N=Function.prototype,Y=Object.prototype,E=N.toString,L=Y.hasOwnProperty,C=RegExp("^"+E.call(L).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function H(t){return!(!$(t)||(e=t,F&&F in e))&&(x(t)?C:T).test(P(t));var e}function I(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return H(r)?r:void 0}var U=I(Object,"create");var W=Object.prototype.hasOwnProperty;var B=Object.prototype.hasOwnProperty;function V(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function q(t,e){return t===e||t!=t&&e!=e}function J(t,e){for(var r=t.length;r--;)if(q(t[r][0],e))return r;return-1}V.prototype.clear=function(){this.__data__=U?U(null):{},this.size=0},V.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},V.prototype.get=function(t){var e=this.__data__;if(U){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return W.call(e,t)?e[t]:void 0},V.prototype.has=function(t){var e=this.__data__;return U?void 0!==e[t]:B.call(e,t)},V.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=U&&void 0===e?"__lodash_hash_undefined__":e,this};var R=Array.prototype.splice;function Z(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Z.prototype.clear=function(){this.__data__=[],this.size=0},Z.prototype.delete=function(t){var e=this.__data__,r=J(e,t);return!(r<0)&&(r==e.length-1?e.pop():R.call(e,r,1),--this.size,!0)},Z.prototype.get=function(t){var e=this.__data__,r=J(e,t);return r<0?void 0:e[r][1]},Z.prototype.has=function(t){return J(this.__data__,t)>-1},Z.prototype.set=function(t,e){var r=this.__data__,n=J(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};var G=I(u,"Map");function Q(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function K(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}K.prototype.clear=function(){this.size=0,this.__data__={hash:new V,map:new(G||Z),string:new V}},K.prototype.delete=function(t){var e=Q(this,t).delete(t);return this.size-=e?1:0,e},K.prototype.get=function(t){return Q(this,t).get(t)},K.prototype.has=function(t){return Q(this,t).has(t)},K.prototype.set=function(t,e){var r=Q(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};var X="Expected a function";function tt(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(X);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var u=t.apply(this,n);return r.cache=i.set(o,u)||i,u};return r.cache=new(tt.Cache||K),r}tt.Cache=K;var et,rt,nt,ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,it=/\\(\\)?/g,ut=(et=function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(ot,(function(t,r,n,o){e.push(n?o.replace(it,"$1"):r||t)})),e},rt=tt(et,(function(t){return 500===nt.size&&nt.clear(),t})),nt=rt.cache,rt),at=ut;var ct=1/0,st=a?a.prototype:void 0,ft=st?st.toString:void 0;function lt(t){if("string"==typeof t)return t;if(n(t))return function(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}(t,lt)+"";if(_(t))return ft?ft.call(t):"";var e=t+"";return"0"==e&&1/t==-ct?"-0":e}function ht(t){return null==t?"":lt(t)}function pt(t,e){return n(t)?t:w(t,e)?[t]:at(ht(t))}var dt=1/0;function vt(t){if("string"==typeof t||_(t))return t;var e=t+"";return"0"==e&&1/t==-dt?"-0":e}function yt(t,e){for(var r=0,n=(e=pt(e,t)).length;null!=t&&r<n;)t=t[vt(e[r++])];return r&&r==n?t:void 0}function bt(t,e,r){var n=null==t?void 0:yt(t,e);return void 0===n?r:n}function gt(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t}var _t,jt=function(t,e,r){for(var n=-1,o=Object(t),i=r(t),u=i.length;u--;){var a=i[_t?u:++n];if(!1===e(o[a],a,o))break}return t};function mt(t){return b(t)&&"[object Arguments]"==y(t)}var wt=Object.prototype,$t=wt.hasOwnProperty,Ot=wt.propertyIsEnumerable,St=mt(function(){return arguments}())?mt:function(t){return b(t)&&$t.call(t,"callee")&&!Ot.call(t,"callee")},Mt=St;var Dt="object"==typeof exports&&exports&&!exports.nodeType&&exports,xt=Dt&&"object"==typeof module&&module&&!module.nodeType&&module,At=xt&&xt.exports===Dt?u.Buffer:void 0,kt=(At?At.isBuffer:void 0)||function(){return!1},Ft=9007199254740991,zt=/^(?:0|[1-9]\d*)$/;function Pt(t,e){var r=typeof t;return!!(e=null==e?Ft:e)&&("number"==r||"symbol"!=r&&zt.test(t))&&t>-1&&t%1==0&&t<e}var Tt=9007199254740991;function Nt(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Tt}var Yt={};Yt["[object Float32Array]"]=Yt["[object Float64Array]"]=Yt["[object Int8Array]"]=Yt["[object Int16Array]"]=Yt["[object Int32Array]"]=Yt["[object Uint8Array]"]=Yt["[object Uint8ClampedArray]"]=Yt["[object Uint16Array]"]=Yt["[object Uint32Array]"]=!0,Yt["[object Arguments]"]=Yt["[object Array]"]=Yt["[object ArrayBuffer]"]=Yt["[object Boolean]"]=Yt["[object DataView]"]=Yt["[object Date]"]=Yt["[object Error]"]=Yt["[object Function]"]=Yt["[object Map]"]=Yt["[object Number]"]=Yt["[object Object]"]=Yt["[object RegExp]"]=Yt["[object Set]"]=Yt["[object String]"]=Yt["[object WeakMap]"]=!1;var Et="object"==typeof exports&&exports&&!exports.nodeType&&exports,Lt=Et&&"object"==typeof module&&module&&!module.nodeType&&module,Ct=Lt&&Lt.exports===Et&&o.process,Ht=function(){try{var t=Lt&&Lt.require&&Lt.require("util").types;return t||Ct&&Ct.binding&&Ct.binding("util")}catch(t){}}(),It=Ht&&Ht.isTypedArray,Ut=It?function(t){return function(e){return t(e)}}(It):function(t){return b(t)&&Nt(t.length)&&!!Yt[y(t)]},Wt=Ut,Bt=Object.prototype.hasOwnProperty;function Vt(t,e){var r=n(t),o=!r&&Mt(t),i=!r&&!o&&kt(t),u=!r&&!o&&!i&&Wt(t),a=r||o||i||u,c=a?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],s=c.length;for(var f in t)!e&&!Bt.call(t,f)||a&&("length"==f||i&&("offset"==f||"parent"==f)||u&&("buffer"==f||"byteLength"==f||"byteOffset"==f)||Pt(f,s))||c.push(f);return c}var qt=Object.prototype;var Jt=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object),Rt=Jt,Zt=Object.prototype.hasOwnProperty;function Gt(t){if(r=(e=t)&&e.constructor,e!==("function"==typeof r&&r.prototype||qt))return Rt(t);var e,r,n=[];for(var o in Object(t))Zt.call(t,o)&&"constructor"!=o&&n.push(o);return n}function Qt(t){return null!=t&&Nt(t.length)&&!x(t)}function Kt(t){return Qt(t)?Vt(t):Gt(t)}var Xt=function(t,e){return function(r,n){if(null==r)return r;if(!Qt(r))return t(r,n);for(var o=r.length,i=e?o:-1,u=Object(r);(e?i--:++i<o)&&!1!==n(u[i],i,u););return r}}((function(t,e){return t&&jt(t,e,Kt)})),te=Xt;function ee(t){return t}function re(t,e){var r;return(n(t)?gt:te)(t,"function"==typeof(r=e)?r:ee)}function ne(t){var e=this.__data__=new Z(t);this.size=e.size}ne.prototype.clear=function(){this.__data__=new Z,this.size=0},ne.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},ne.prototype.get=function(t){return this.__data__.get(t)},ne.prototype.has=function(t){return this.__data__.has(t)},ne.prototype.set=function(t,e){var r=this.__data__;if(r instanceof Z){var n=r.__data__;if(!G||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new K(n)}return r.set(t,e),this.size=r.size,this};function oe(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new K;++e<r;)this.add(t[e])}function ie(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function ue(t,e){return t.has(e)}oe.prototype.add=oe.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},oe.prototype.has=function(t){return this.__data__.has(t)};var ae=1,ce=2;function se(t,e,r,n,o,i){var u=r&ae,a=t.length,c=e.length;if(a!=c&&!(u&&c>a))return!1;var s=i.get(t),f=i.get(e);if(s&&f)return s==e&&f==t;var l=-1,h=!0,p=r&ce?new oe:void 0;for(i.set(t,e),i.set(e,t);++l<a;){var d=t[l],v=e[l];if(n)var y=u?n(v,d,l,e,t,i):n(d,v,l,t,e,i);if(void 0!==y){if(y)continue;h=!1;break}if(p){if(!ie(e,(function(t,e){if(!ue(p,e)&&(d===t||o(d,t,r,n,i)))return p.push(e)}))){h=!1;break}}else if(d!==v&&!o(d,v,r,n,i)){h=!1;break}}return i.delete(t),i.delete(e),h}var fe=u.Uint8Array;function le(t){var e=-1,r=Array(t.size);return t.forEach((function(t,n){r[++e]=[n,t]})),r}function he(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r}var pe=1,de=2,ve="[object Boolean]",ye="[object Date]",be="[object Error]",ge="[object Map]",_e="[object Number]",je="[object RegExp]",me="[object Set]",we="[object String]",$e="[object Symbol]",Oe="[object ArrayBuffer]",Se="[object DataView]",Me=a?a.prototype:void 0,De=Me?Me.valueOf:void 0;var xe=Object.prototype.propertyIsEnumerable,Ae=Object.getOwnPropertySymbols,ke=Ae?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var r=-1,n=null==t?0:t.length,o=0,i=[];++r<n;){var u=t[r];e(u,r,t)&&(i[o++]=u)}return i}(Ae(t),(function(e){return xe.call(t,e)})))}:function(){return[]},Fe=ke;function ze(t){return function(t,e,r){var o=e(t);return n(t)?o:function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}(o,r(t))}(t,Kt,Fe)}var Pe=1,Te=Object.prototype.hasOwnProperty;var Ne=I(u,"DataView"),Ye=I(u,"Promise"),Ee=I(u,"Set"),Le=I(u,"WeakMap"),Ce="[object Map]",He="[object Promise]",Ie="[object Set]",Ue="[object WeakMap]",We="[object DataView]",Be=P(Ne),Ve=P(G),qe=P(Ye),Je=P(Ee),Re=P(Le),Ze=y;(Ne&&Ze(new Ne(new ArrayBuffer(1)))!=We||G&&Ze(new G)!=Ce||Ye&&Ze(Ye.resolve())!=He||Ee&&Ze(new Ee)!=Ie||Le&&Ze(new Le)!=Ue)&&(Ze=function(t){var e=y(t),r="[object Object]"==e?t.constructor:void 0,n=r?P(r):"";if(n)switch(n){case Be:return We;case Ve:return Ce;case qe:return He;case Je:return Ie;case Re:return Ue}return e});var Ge=Ze,Qe=1,Ke="[object Arguments]",Xe="[object Array]",tr="[object Object]",er=Object.prototype.hasOwnProperty;function rr(t,e,r,o,i,u){var a=n(t),c=n(e),s=a?Xe:Ge(t),f=c?Xe:Ge(e),l=(s=s==Ke?tr:s)==tr,h=(f=f==Ke?tr:f)==tr,p=s==f;if(p&&kt(t)){if(!kt(e))return!1;a=!0,l=!1}if(p&&!l)return u||(u=new ne),a||Wt(t)?se(t,e,r,o,i,u):function(t,e,r,n,o,i,u){switch(r){case Se:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Oe:return!(t.byteLength!=e.byteLength||!i(new fe(t),new fe(e)));case ve:case ye:case _e:return q(+t,+e);case be:return t.name==e.name&&t.message==e.message;case je:case we:return t==e+"";case ge:var a=le;case me:var c=n&pe;if(a||(a=he),t.size!=e.size&&!c)return!1;var s=u.get(t);if(s)return s==e;n|=de,u.set(t,e);var f=se(a(t),a(e),n,o,i,u);return u.delete(t),f;case $e:if(De)return De.call(t)==De.call(e)}return!1}(t,e,s,r,o,i,u);if(!(r&Qe)){var d=l&&er.call(t,"__wrapped__"),v=h&&er.call(e,"__wrapped__");if(d||v){var y=d?t.value():t,b=v?e.value():e;return u||(u=new ne),i(y,b,r,o,u)}}return!!p&&(u||(u=new ne),function(t,e,r,n,o,i){var u=r&Pe,a=ze(t),c=a.length;if(c!=ze(e).length&&!u)return!1;for(var s=c;s--;){var f=a[s];if(!(u?f in e:Te.call(e,f)))return!1}var l=i.get(t),h=i.get(e);if(l&&h)return l==e&&h==t;var p=!0;i.set(t,e),i.set(e,t);for(var d=u;++s<c;){var v=t[f=a[s]],y=e[f];if(n)var b=u?n(y,v,f,e,t,i):n(v,y,f,t,e,i);if(!(void 0===b?v===y||o(v,y,r,n,i):b)){p=!1;break}d||(d="constructor"==f)}if(p&&!d){var g=t.constructor,_=e.constructor;g==_||!("constructor"in t)||!("constructor"in e)||"function"==typeof g&&g instanceof g&&"function"==typeof _&&_ instanceof _||(p=!1)}return i.delete(t),i.delete(e),p}(t,e,r,o,i,u))}function nr(t,e,r,n,o){return t===e||(null==t||null==e||!b(t)&&!b(e)?t!=t&&e!=e:rr(t,e,r,n,nr,o))}var or=1,ir=2;function ur(t){return t==t&&!$(t)}function ar(t,e){return function(r){return null!=r&&(r[t]===e&&(void 0!==e||t in Object(r)))}}function cr(t){var e=function(t){for(var e=Kt(t),r=e.length;r--;){var n=e[r],o=t[n];e[r]=[n,o,ur(o)]}return e}(t);return 1==e.length&&e[0][2]?ar(e[0][0],e[0][1]):function(r){return r===t||function(t,e,r,n){var o=r.length,i=o,u=!n;if(null==t)return!i;for(t=Object(t);o--;){var a=r[o];if(u&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++o<i;){var c=(a=r[o])[0],s=t[c],f=a[1];if(u&&a[2]){if(void 0===s&&!(c in t))return!1}else{var l=new ne;if(n)var h=n(s,f,c,t,e,l);if(!(void 0===h?nr(f,s,or|ir,n,l):h))return!1}}return!0}(r,t,e)}}function sr(t,e){return null!=t&&e in Object(t)}function fr(t,e){return null!=t&&function(t,e,r){for(var o=-1,i=(e=pt(e,t)).length,u=!1;++o<i;){var a=vt(e[o]);if(!(u=null!=t&&r(t,a)))break;t=t[a]}return u||++o!=i?u:!!(i=null==t?0:t.length)&&Nt(i)&&Pt(a,i)&&(n(t)||Mt(t))}(t,e,sr)}var lr=1,hr=2;function pr(t){return w(t)?(e=vt(t),function(t){return null==t?void 0:t[e]}):function(t){return function(e){return yt(e,t)}}(t);var e}function dr(t){return"function"==typeof t?t:null==t?ee:"object"==typeof t?n(t)?function(t,e){return w(t)&&ur(e)?ar(vt(t),e):function(r){var n=bt(r,t);return void 0===n&&n===e?fr(r,t):nr(e,n,lr|hr)}}(t[0],t[1]):cr(t):pr(t)}var vr=/\s/;var yr=/^\s+/;function br(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&vr.test(t.charAt(e)););return e}(t)+1).replace(yr,""):t}var gr=NaN,_r=/^[-+]0x[0-9a-f]+$/i,jr=/^0b[01]+$/i,mr=/^0o[0-7]+$/i,wr=parseInt;function $r(t){if("number"==typeof t)return t;if(_(t))return gr;if($(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=$(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=br(t);var r=jr.test(t);return r||mr.test(t)?wr(t.slice(2),r?2:8):_r.test(t)?gr:+t}var Or=1/0,Sr=17976931348623157e292;function Mr(t){return t?(t=$r(t))===Or||t===-Or?(t<0?-1:1)*Sr:t==t?t:0:0===t?t:0}function Dr(t){var e=Mr(t),r=e%1;return e==e?r?e-r:e:0}var xr=Math.max;var Ar,kr=(Ar=function(t,e,r){var n=null==t?0:t.length;if(!n)return-1;var o=null==r?0:Dr(r);return o<0&&(o=xr(n+o,0)),function(t,e,r,n){for(var o=t.length,i=r+(n?1:-1);n?i--:++i<o;)if(e(t[i],i,t))return i;return-1}(t,dr(e),o)},function(t,e,r){var n=Object(t);if(!Qt(t)){var o=dr(e);t=Kt(t),e=function(t){return o(n[t],t,n)}}var i=Ar(t,e,r);return i>-1?n[o?t[i]:i]:void 0}),Fr=kr;function zr(t){return"[object String]"===Object.prototype.toString.call(t)}function Pr(t){return!(!zr(t)||""===t)}function Tr(t){return t!=t}function Nr(t){let e=!1;if(Pr(t))e=!isNaN(Number(t));else if(function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)){if(Tr(t))return!1;e=!0}return e}function Yr(t){return"[object Array]"===Object.prototype.toString.call(t)}function Er(t){return"[object Object]"===Object.prototype.toString.call(t)}function Lr(t){return!!function(t){return"[object Undefined]"===Object.prototype.toString.call(t)}(t)||(!!function(t){return"[object Null]"===Object.prototype.toString.call(t)}(t)||(!!function(t){if(Er(t)){for(let e in t)return!1;return!0}return!1}(t)||(!!function(t){return!(!zr(t)||""!==t)}(t)||(!!function(t){return!!Yr(t)&&0===t.length}(t)||!!Tr(t)))))}function Cr(t){return!!Yr(t)&&(0!==t.length&&(1!==t.length||!Lr(t[0])))}function Hr(t){if(Er(t)){for(let e in t)return!0;return!1}return!1}function Ir(t){if(!Nr(t))return 0;return Mr(t)}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var Ur={};!function(t,e){t.exports=function(){var t=1e3,e=6e4,r=36e5,n="millisecond",o="second",i="minute",u="hour",a="day",c="week",s="month",f="quarter",l="year",h="date",p="Invalid Date",d=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,v=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,y={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(t){var e=["th","st","nd","rd"],r=t%100;return"["+t+(e[(r-20)%10]||e[r]||e[0])+"]"}},b=function(t,e,r){var n=String(t);return!n||n.length>=e?t:""+Array(e+1-n.length).join(r)+t},g={s:b,z:function(t){var e=-t.utcOffset(),r=Math.abs(e),n=Math.floor(r/60),o=r%60;return(e<=0?"+":"-")+b(n,2,"0")+":"+b(o,2,"0")},m:function t(e,r){if(e.date()<r.date())return-t(r,e);var n=12*(r.year()-e.year())+(r.month()-e.month()),o=e.clone().add(n,s),i=r-o<0,u=e.clone().add(n+(i?-1:1),s);return+(-(n+(r-o)/(i?o-u:u-o))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:s,y:l,w:c,d:a,D:h,h:u,m:i,s:o,ms:n,Q:f}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},_="en",j={};j[_]=y;var m="$isDayjsObject",w=function(t){return t instanceof M||!(!t||!t[m])},$=function t(e,r,n){var o;if(!e)return _;if("string"==typeof e){var i=e.toLowerCase();j[i]&&(o=i),r&&(j[i]=r,o=i);var u=e.split("-");if(!o&&u.length>1)return t(u[0])}else{var a=e.name;j[a]=e,o=a}return!n&&o&&(_=o),o||!n&&_},O=function(t,e){if(w(t))return t.clone();var r="object"==typeof e?e:{};return r.date=t,r.args=arguments,new M(r)},S=g;S.l=$,S.i=w,S.w=function(t,e){return O(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var M=function(){function y(t){this.$L=$(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[m]=!0}var b=y.prototype;return b.parse=function(t){this.$d=function(t){var e=t.date,r=t.utc;if(null===e)return new Date(NaN);if(S.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var n=e.match(d);if(n){var o=n[2]-1||0,i=(n[7]||"0").substring(0,3);return r?new Date(Date.UTC(n[1],o,n[3]||1,n[4]||0,n[5]||0,n[6]||0,i)):new Date(n[1],o,n[3]||1,n[4]||0,n[5]||0,n[6]||0,i)}}return new Date(e)}(t),this.init()},b.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},b.$utils=function(){return S},b.isValid=function(){return!(this.$d.toString()===p)},b.isSame=function(t,e){var r=O(t);return this.startOf(e)<=r&&r<=this.endOf(e)},b.isAfter=function(t,e){return O(t)<this.startOf(e)},b.isBefore=function(t,e){return this.endOf(e)<O(t)},b.$g=function(t,e,r){return S.u(t)?this[e]:this.set(r,t)},b.unix=function(){return Math.floor(this.valueOf()/1e3)},b.valueOf=function(){return this.$d.getTime()},b.startOf=function(t,e){var r=this,n=!!S.u(e)||e,f=S.p(t),p=function(t,e){var o=S.w(r.$u?Date.UTC(r.$y,e,t):new Date(r.$y,e,t),r);return n?o:o.endOf(a)},d=function(t,e){return S.w(r.toDate()[t].apply(r.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(e)),r)},v=this.$W,y=this.$M,b=this.$D,g="set"+(this.$u?"UTC":"");switch(f){case l:return n?p(1,0):p(31,11);case s:return n?p(1,y):p(0,y+1);case c:var _=this.$locale().weekStart||0,j=(v<_?v+7:v)-_;return p(n?b-j:b+(6-j),y);case a:case h:return d(g+"Hours",0);case u:return d(g+"Minutes",1);case i:return d(g+"Seconds",2);case o:return d(g+"Milliseconds",3);default:return this.clone()}},b.endOf=function(t){return this.startOf(t,!1)},b.$set=function(t,e){var r,c=S.p(t),f="set"+(this.$u?"UTC":""),p=(r={},r[a]=f+"Date",r[h]=f+"Date",r[s]=f+"Month",r[l]=f+"FullYear",r[u]=f+"Hours",r[i]=f+"Minutes",r[o]=f+"Seconds",r[n]=f+"Milliseconds",r)[c],d=c===a?this.$D+(e-this.$W):e;if(c===s||c===l){var v=this.clone().set(h,1);v.$d[p](d),v.init(),this.$d=v.set(h,Math.min(this.$D,v.daysInMonth())).$d}else p&&this.$d[p](d);return this.init(),this},b.set=function(t,e){return this.clone().$set(t,e)},b.get=function(t){return this[S.p(t)]()},b.add=function(n,f){var h,p=this;n=Number(n);var d=S.p(f),v=function(t){var e=O(p);return S.w(e.date(e.date()+Math.round(t*n)),p)};if(d===s)return this.set(s,this.$M+n);if(d===l)return this.set(l,this.$y+n);if(d===a)return v(1);if(d===c)return v(7);var y=(h={},h[i]=e,h[u]=r,h[o]=t,h)[d]||1,b=this.$d.getTime()+n*y;return S.w(b,this)},b.subtract=function(t,e){return this.add(-1*t,e)},b.format=function(t){var e=this,r=this.$locale();if(!this.isValid())return r.invalidDate||p;var n=t||"YYYY-MM-DDTHH:mm:ssZ",o=S.z(this),i=this.$H,u=this.$m,a=this.$M,c=r.weekdays,s=r.months,f=r.meridiem,l=function(t,r,o,i){return t&&(t[r]||t(e,n))||o[r].slice(0,i)},h=function(t){return S.s(i%12||12,t,"0")},d=f||function(t,e,r){var n=t<12?"AM":"PM";return r?n.toLowerCase():n};return n.replace(v,(function(t,n){return n||function(t){switch(t){case"YY":return String(e.$y).slice(-2);case"YYYY":return S.s(e.$y,4,"0");case"M":return a+1;case"MM":return S.s(a+1,2,"0");case"MMM":return l(r.monthsShort,a,s,3);case"MMMM":return l(s,a);case"D":return e.$D;case"DD":return S.s(e.$D,2,"0");case"d":return String(e.$W);case"dd":return l(r.weekdaysMin,e.$W,c,2);case"ddd":return l(r.weekdaysShort,e.$W,c,3);case"dddd":return c[e.$W];case"H":return String(i);case"HH":return S.s(i,2,"0");case"h":return h(1);case"hh":return h(2);case"a":return d(i,u,!0);case"A":return d(i,u,!1);case"m":return String(u);case"mm":return S.s(u,2,"0");case"s":return String(e.$s);case"ss":return S.s(e.$s,2,"0");case"SSS":return S.s(e.$ms,3,"0");case"Z":return o}return null}(t)||o.replace(":","")}))},b.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},b.diff=function(n,h,p){var d,v=this,y=S.p(h),b=O(n),g=(b.utcOffset()-this.utcOffset())*e,_=this-b,j=function(){return S.m(v,b)};switch(y){case l:d=j()/12;break;case s:d=j();break;case f:d=j()/3;break;case c:d=(_-g)/6048e5;break;case a:d=(_-g)/864e5;break;case u:d=_/r;break;case i:d=_/e;break;case o:d=_/t;break;default:d=_}return p?d:S.a(d)},b.daysInMonth=function(){return this.endOf(s).$D},b.$locale=function(){return j[this.$L]},b.locale=function(t,e){if(!t)return this.$L;var r=this.clone(),n=$(t,e,!0);return n&&(r.$L=n),r},b.clone=function(){return S.w(this.$d,this)},b.toDate=function(){return new Date(this.valueOf())},b.toJSON=function(){return this.isValid()?this.toISOString():null},b.toISOString=function(){return this.$d.toISOString()},b.toString=function(){return this.$d.toUTCString()},y}(),D=M.prototype;return O.prototype=D,[["$ms",n],["$s",o],["$m",i],["$H",u],["$W",a],["$M",s],["$y",l],["$D",h]].forEach((function(t){D[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),O.extend=function(t,e){return t.$i||(t(e,M,O),t.$i=!0),O},O.locale=$,O.isDayjs=w,O.unix=function(t){return O(1e3*t)},O.en=j[_],O.Ls=j,O.p={},O}()}({get exports(){return Ur},set exports(t){Ur=t}});var Wr=Ur;function Br(){if(!function(t){let e=Object.prototype.toString.call(t);return"[object Function]"===e||"[object AsyncFunction]"===e}(Wr))throw new Error("invalid dayjs");return Wr().format("YYYYMMDDHHmmss")}function Vr(t){return!!Nr(t)&&(t=Ir(t),"number"==typeof(e=t)&&e==Dr(e));var e}var qr=u.isFinite,Jr=Math.min;var Rr=function(t){var e=Math[t];return function(t,r){if(t=$r(t),(r=null==r?0:Jr(Dr(r),292))&&qr(t)){var n=(ht(t)+"e").split("e");return+((n=(ht(e(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return e(t)}}("round"),Zr=Rr;function Gr(t){if(!Nr(t))return 0;t=Ir(t);let e=Zr(t);return"0"===String(e)?0:e}let Qr="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),Kr=Qr.length;function Xr(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,e=[];var r;t=Vr(r=t)&&Gr(r)>0?Gr(t):32;for(let r=0;r<t;r++)e[r]=Qr[0|Math.random()*Kr];return e.join("")}function tn(e){return!!t.existsSync(e)&&(!t.lstatSync(e).isFile()&&!t.lstatSync(e).isSymbolicLink())}function en(e){return!!t.existsSync(e)&&(!t.lstatSync(e).isDirectory()&&!t.lstatSync(e).isSymbolicLink())}let rn=t.readFileSync("./node_modules/highcharts/highcharts.js","utf8"),nn=t.readFileSync("./node_modules/highcharts/modules/stock.js","utf8"),on=t.readFileSync("./node_modules/highcharts/modules/heatmap.js","utf8"),un=t.readFileSync("./node_modules/highcharts/modules/annotations.js","utf8"),an=t.readFileSync("./node_modules/highcharts/modules/boost.js","utf8"),cn=t.readFileSync("./node_modules/highcharts/modules/boost-canvas.js","utf8"),sn=process.cwd();return async function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:700,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:400,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(!Nr(n))return Promise.reject("width is not a number");if(n=Ir(n),n<=0)return Promise.reject("width <= 0");if(!Nr(o))return Promise.reject("height is not a number");if(o=Ir(o),o<=0)return Promise.reject("height <= 0");if(!Nr(i))return Promise.reject("scale is not a number");if(i=Ir(i),i<=0)return Promise.reject("scale <= 0");if(!Hr(u)&&!Pr(u))return Promise.reject("opt is not an effective object or string");let c=bt(a,"addScripts");Cr(c)||(c=[]);let s=bt(a,"addCode");Cr(s)||(s="");let f=bt(a,"executablePath",""),l=bt(a,"executableFolder","");if(Pr(l)&&!Pr(f)){let r=function(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=1;if(!tn(r))throw new Error(`fd[${r}] is not a folder`);return function r(i){let u=[];return tn(i)?(re(t.readdirSync(i),(function(a){let c=e.resolve(i,a),s=null;try{s=t.statSync(c)}catch(t){}s&&s.isDirectory()?(u.push({isFolder:!0,level:o,path:c,name:e.basename(c)}),o+=1,(o<=n||null===n)&&(u=u.concat(r(c))),o-=1):u.push({isFolder:!1,level:o,path:c,name:e.basename(c)})})),u):u}(r)}(l,null),n=Fr(r,(t=>"chrome.exe"===t.name));if(!Hr(n))throw new Error(`can not find chrome.exe in executableFolder[${l}]`);f=n.path}let h="";if(Pr(u))h=u;else{h=`let opt=${JSON.stringify(u)};`}let p=`./whpic-${Br()}-${Xr()}.png`,d=e.resolve(sn,p),v=`./whweb-${Br()}-${Xr()}.html`,y=e.resolve(sn,v),b="";re(c,(t=>{b+=`<script src="${t}"><\/script>`}));let g="\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"UTF-8\">\n  <title>highcharts to png</title>\n\n  <script src=\"https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js\"><\/script>\n\n  <script>{code_highcharts}<\/script>\n  <script>{code_stock}<\/script>\n  <script>{code_heatmap}<\/script>\n  <script>{code_annotations}<\/script>\n  <script>{code_boost}<\/script>\n  <script>{code_boost_canvas}<\/script>\n\n  {add_scripts}\n\n  <script>{add_code}<\/script>\n\n</head>\n<body style=\"padding:0; margin:0;\">\n\n    <div id=\"hc\" style=\"width:{width}px; height:{height}px;\"></div>\n\n    <script>\n\n        {cOpt}\n\n        if(_.isObject(opt)){\n\n            //強制關閉動畫避免過慢顯示無法截到數據圖\n            _.set(opt, 'chart.animation', false)\n            _.set(opt, 'plotOptions.series.animation', false)\n            // console.log('opt', opt)\n        \n            //plot\n            Highcharts.chart('hc', opt)\n\n        }\n        else{\n            console.log('invalid opt')\n        }\n\n    <\/script>\n\n</body>\n</html>\n";g=g.replace("{width}",n),g=g.replace("{height}",o),g=g.replace("{cOpt}",h),g=g.replace("{code_highcharts}",rn),g=g.replace("{code_stock}",nn),g=g.replace("{code_heatmap}",on),g=g.replace("{code_annotations}",un),g=g.replace("{code_boost}",an),g=g.replace("{code_boost_canvas}",cn),g=g.replace("{add_scripts}",b),g=g.replace("{add_code}",s),t.writeFileSync(y,g,"utf8");let _="";return await(async()=>{let e={headless:"new",slowMo:20};Pr(f)&&(e.executablePath=f);let u=await r.launch(e),a=await u.newPage(),c={x:0,y:0,width:Number(n),height:Number(o),deviceScaleFactor:Number(i)};await a.goto(y),await a.setViewport(c),await a.screenshot({path:d}),await u.close(),_=t.readFileSync(d,{encoding:"base64"})})().catch((t=>{console.log(t)})),en(y)&&t.unlinkSync(y),en(d)&&t.unlinkSync(d),_}}));
//# sourceMappingURL=w-hc-2-png.umd.js.map
